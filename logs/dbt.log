

============================== 2023-07-29 03:59:06.176104 | 0b43345e-c3f4-473d-8d76-c5841a613aef ==============================
[0m03:59:06.176104 [info ] [MainThread]: Running with dbt=1.4.5
[0m03:59:06.179152 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m03:59:06.180194 [debug] [MainThread]: Tracking: tracking
[0m03:59:06.182962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cef02510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ceb06690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cedfbc10>]}
[0m03:59:26.167329 [debug] [MainThread]: Starter project path: /usr/local/lib/python3.11/site-packages/dbt/include/starter_project
[0m04:00:05.262960 [info ] [MainThread]: Profile my_dbt_project written to /usr/app/profiles.yml using target's sample configuration. Once updated, you'll be able to start developing with dbt.
[0m04:00:05.264540 [info ] [MainThread]: 
Your new dbt project "my_dbt_project" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m04:00:05.265964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cef4b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ce6c7d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cedce290>]}
[0m04:00:05.266924 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 04:10:54.242155 | e8935689-8902-4945-a400-643d75c90ea0 ==============================
[0m04:10:54.242155 [info ] [MainThread]: Running with dbt=1.4.5
[0m04:10:54.245222 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:10:54.246455 [debug] [MainThread]: Tracking: tracking
[0m04:10:54.250052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ab855510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7abf57bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ac09b310>]}
[0m04:10:54.261846 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m04:10:54.264105 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m04:10:54.265233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e8935689-8902-4945-a400-643d75c90ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7abfac710>]}
[0m04:10:55.028229 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m04:10:55.031306 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m04:10:55.069665 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_project.unique_my_first_dbt_model_id.16e066b321' (models/example/schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m04:10:55.071190 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710' (models/example/schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m04:10:55.072599 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_project.unique_my_second_dbt_model_id.57a0f8c493' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m04:10:55.074226 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_project.not_null_my_second_dbt_model_id.151b76d778' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m04:10:55.098939 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m04:10:55.106942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8935689-8902-4945-a400-643d75c90ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ab7d14d0>]}
[0m04:10:55.122825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8935689-8902-4945-a400-643d75c90ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7a9f3bbd0>]}
[0m04:10:55.124111 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:10:55.125560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8935689-8902-4945-a400-643d75c90ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7abd5a750>]}
[0m04:10:55.128357 [info ] [MainThread]: 
[0m04:10:55.130142 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:10:55.131757 [debug] [MainThread]: Command end result
[0m04:10:55.142824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7aa0b0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7aa0b0ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7aa0b2f10>]}
[0m04:10:55.143881 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 04:13:20.011506 | f6047e65-d6e3-43b3-98f6-0a107ddf4a7b ==============================
[0m04:13:20.011506 [info ] [MainThread]: Running with dbt=1.4.5
[0m04:13:20.013963 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:13:20.014824 [debug] [MainThread]: Tracking: tracking
[0m04:13:20.017407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c9e9b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c9663b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c9e04c50>]}
[0m04:13:20.033424 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m04:13:20.085671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m04:13:20.087028 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/example/my_second_dbt_model.sql
[0m04:13:20.087962 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/example/my_first_dbt_model.sql
[0m04:13:20.105820 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m04:13:20.123267 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m04:13:20.139091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6047e65-d6e3-43b3-98f6-0a107ddf4a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c9f34c90>]}
[0m04:13:20.154059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6047e65-d6e3-43b3-98f6-0a107ddf4a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c7e138d0>]}
[0m04:13:20.155395 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:13:20.156898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6047e65-d6e3-43b3-98f6-0a107ddf4a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c9e66cd0>]}
[0m04:13:20.159888 [info ] [MainThread]: 
[0m04:13:20.166054 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:13:20.169470 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m04:13:20.188115 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m04:13:20.189653 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m04:13:20.190782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:13:20.194742 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "db" (172.31.0.2), port 5430 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m04:13:20.197487 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m04:13:20.198432 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m04:13:20.199224 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m04:13:20.199848 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m04:13:20.200631 [debug] [ThreadPool]: On list_postgres: No close available on handle
[0m04:13:20.202922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:13:20.203762 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m04:13:20.204827 [info ] [MainThread]: 
[0m04:13:20.206204 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m04:13:20.207752 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "db" (172.31.0.2), port 5430 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m04:13:20.209339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c9bb2fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c7f6d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c7f6e010>]}
[0m04:13:20.210659 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 04:16:55.529428 | 6f4f9c2b-eee1-40ea-b10d-c87d70874d3f ==============================
[0m04:16:55.529428 [info ] [MainThread]: Running with dbt=1.4.5
[0m04:16:55.531945 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m04:16:55.532957 [debug] [MainThread]: Tracking: tracking
[0m04:16:55.535435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57244f6e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57241dee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5724493e50>]}
[0m04:16:55.536784 [info ] [MainThread]: Setting up your profile.
[0m04:17:05.457873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f572452d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5723d72b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f572436a290>]}
[0m04:17:05.459242 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 04:18:40.936931 | 3de0074e-02f4-44bc-91df-130e34b12c5e ==============================
[0m04:18:40.936931 [info ] [MainThread]: Running with dbt=1.4.5
[0m04:18:40.939928 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:18:40.941116 [debug] [MainThread]: Tracking: tracking
[0m04:18:40.944123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ba3e1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b87c36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ba674550>]}
[0m04:18:40.957595 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m04:18:40.967945 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m04:18:40.969477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3de0074e-02f4-44bc-91df-130e34b12c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ba70c990>]}
[0m04:18:41.665680 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m04:18:41.679556 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m04:18:41.744775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3de0074e-02f4-44bc-91df-130e34b12c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b9edf510>]}
[0m04:18:41.759161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3de0074e-02f4-44bc-91df-130e34b12c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b8815310>]}
[0m04:18:41.760161 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:18:41.761159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3de0074e-02f4-44bc-91df-130e34b12c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b8893950>]}
[0m04:18:41.763533 [info ] [MainThread]: 
[0m04:18:41.767409 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:18:41.769715 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m04:18:41.781199 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m04:18:41.782055 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m04:18:41.782660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:18:41.784938 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "db" (192.168.0.2), port 5430 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m04:18:41.787341 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m04:18:41.788168 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m04:18:41.788890 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m04:18:41.789452 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m04:18:41.790051 [debug] [ThreadPool]: On list_postgres: No close available on handle
[0m04:18:41.791527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:18:41.792081 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m04:18:41.792620 [info ] [MainThread]: 
[0m04:18:41.793483 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m04:18:41.794484 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "db" (192.168.0.2), port 5430 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m04:18:41.796232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b8886bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b8885050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ba674890>]}
[0m04:18:41.797296 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 04:19:03.706545 | a3a26913-0bfc-4ed1-9a17-e7be7382f71e ==============================
[0m04:19:03.706545 [info ] [MainThread]: Running with dbt=1.4.5
[0m04:19:03.709231 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:19:03.710348 [debug] [MainThread]: Tracking: tracking
[0m04:19:03.714086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f208161a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2081618dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f208169bdd0>]}
[0m04:19:03.731523 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m04:19:03.743779 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m04:19:03.745772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a3a26913-0bfc-4ed1-9a17-e7be7382f71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f207f72c850>]}
[0m04:19:04.447504 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m04:19:04.461002 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m04:19:04.523664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3a26913-0bfc-4ed1-9a17-e7be7382f71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20813bd050>]}
[0m04:19:04.538725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3a26913-0bfc-4ed1-9a17-e7be7382f71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f207f74cb50>]}
[0m04:19:04.540055 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:19:04.541730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3a26913-0bfc-4ed1-9a17-e7be7382f71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20813f3f50>]}
[0m04:19:04.545229 [info ] [MainThread]: 
[0m04:19:04.550207 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:19:04.553132 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m04:19:04.568479 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m04:19:04.569523 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m04:19:04.570625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:19:04.582540 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "db" (192.168.0.2), port 5432 failed: FATAL:  password authentication failed for user "postgres"

[0m04:19:04.598552 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m04:19:04.600285 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m04:19:04.602331 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m04:19:04.603299 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m04:19:04.604237 [debug] [ThreadPool]: On list_postgres: No close available on handle
[0m04:19:04.606202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:19:04.606820 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m04:19:04.607478 [info ] [MainThread]: 
[0m04:19:04.608338 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m04:19:04.609830 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "db" (192.168.0.2), port 5432 failed: FATAL:  password authentication failed for user "postgres"
  
[0m04:19:04.610936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f207ed95690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f208148d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f207f74edd0>]}
[0m04:19:04.611609 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 04:19:28.878345 | cfbefa63-b7d6-46aa-9762-166d8f788c5f ==============================
[0m04:19:28.878345 [info ] [MainThread]: Running with dbt=1.4.5
[0m04:19:28.881350 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:19:28.882581 [debug] [MainThread]: Tracking: tracking
[0m04:19:28.885370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65aab71290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65aa357390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65aabf76d0>]}
[0m04:19:28.899177 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m04:19:28.911001 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m04:19:28.912489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cfbefa63-b7d6-46aa-9762-166d8f788c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65aabc4650>]}
[0m04:19:29.607879 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m04:19:29.621936 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m04:19:29.684204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfbefa63-b7d6-46aa-9762-166d8f788c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a8c8cd90>]}
[0m04:19:29.696408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfbefa63-b7d6-46aa-9762-166d8f788c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a8c84d10>]}
[0m04:19:29.697113 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:19:29.698099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfbefa63-b7d6-46aa-9762-166d8f788c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65aabf76d0>]}
[0m04:19:29.699915 [info ] [MainThread]: 
[0m04:19:29.703014 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:19:29.705269 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m04:19:29.716682 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m04:19:29.717837 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m04:19:29.718549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:19:29.731137 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m04:19:29.733070 [debug] [ThreadPool]: On list_postgres: Close
[0m04:19:29.736337 [debug] [ThreadPool]: Acquiring new postgres connection 'create_postgres_dev'
[0m04:19:29.737555 [debug] [ThreadPool]: Acquiring new postgres connection 'create_postgres_dev'
[0m04:19:29.738280 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='postgres', schema='dev', identifier=None)"
[0m04:19:29.744237 [debug] [ThreadPool]: Using postgres connection "create_postgres_dev"
[0m04:19:29.744834 [debug] [ThreadPool]: On create_postgres_dev: BEGIN
[0m04:19:29.745370 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:19:29.756191 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m04:19:29.757937 [debug] [ThreadPool]: Using postgres connection "create_postgres_dev"
[0m04:19:29.759388 [debug] [ThreadPool]: On create_postgres_dev: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "create_postgres_dev"} */
create schema if not exists "dev"
[0m04:19:29.762079 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0 seconds
[0m04:19:29.765191 [debug] [ThreadPool]: On create_postgres_dev: COMMIT
[0m04:19:29.766469 [debug] [ThreadPool]: Using postgres connection "create_postgres_dev"
[0m04:19:29.767855 [debug] [ThreadPool]: On create_postgres_dev: COMMIT
[0m04:19:29.770439 [debug] [ThreadPool]: SQL status: COMMIT in 0 seconds
[0m04:19:29.771414 [debug] [ThreadPool]: On create_postgres_dev: Close
[0m04:19:29.774747 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dev'
[0m04:19:29.782762 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m04:19:29.783759 [debug] [ThreadPool]: On list_postgres_dev: BEGIN
[0m04:19:29.784537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:19:29.799904 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m04:19:29.801227 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m04:19:29.802399 [debug] [ThreadPool]: On list_postgres_dev: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_postgres_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m04:19:29.814840 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m04:19:29.819154 [debug] [ThreadPool]: On list_postgres_dev: ROLLBACK
[0m04:19:29.821061 [debug] [ThreadPool]: On list_postgres_dev: Close
[0m04:19:29.829849 [debug] [MainThread]: Using postgres connection "master"
[0m04:19:29.830681 [debug] [MainThread]: On master: BEGIN
[0m04:19:29.831422 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:19:29.844516 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m04:19:29.846075 [debug] [MainThread]: Using postgres connection "master"
[0m04:19:29.846884 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:19:29.859690 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m04:19:29.861785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfbefa63-b7d6-46aa-9762-166d8f788c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a8ccb690>]}
[0m04:19:29.863150 [debug] [MainThread]: On master: ROLLBACK
[0m04:19:29.864409 [debug] [MainThread]: Using postgres connection "master"
[0m04:19:29.865150 [debug] [MainThread]: On master: BEGIN
[0m04:19:29.866488 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m04:19:29.867644 [debug] [MainThread]: On master: COMMIT
[0m04:19:29.868542 [debug] [MainThread]: Using postgres connection "master"
[0m04:19:29.869249 [debug] [MainThread]: On master: COMMIT
[0m04:19:29.870115 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m04:19:29.870722 [debug] [MainThread]: On master: Close
[0m04:19:29.871794 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:19:29.872548 [info ] [MainThread]: 
[0m04:19:29.890567 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m04:19:29.891834 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m04:19:29.893287 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m04:19:29.894085 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m04:19:29.898017 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m04:19:29.902262 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-29 04:19:29.894758 => 2023-07-29 04:19:29.902105
[0m04:19:29.903031 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m04:19:29.950082 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m04:19:29.954536 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m04:19:29.955135 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m04:19:29.955686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:19:29.964788 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m04:19:29.965649 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m04:19:29.966781 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "postgres"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m04:19:29.970736 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m04:19:29.978665 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m04:19:29.979679 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "postgres"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m04:19:29.981248 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m04:19:30.002889 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m04:19:30.003867 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m04:19:30.004727 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m04:19:30.006390 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m04:19:30.011982 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m04:19:30.013192 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "postgres"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m04:19:30.014566 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m04:19:30.016435 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-29 04:19:29.903532 => 2023-07-29 04:19:30.016368
[0m04:19:30.017323 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m04:19:30.018601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfbefa63-b7d6-46aa-9762-166d8f788c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a8bbdc50>]}
[0m04:19:30.019429 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.13s]
[0m04:19:30.021779 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m04:19:30.023290 [debug] [Thread-3 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m04:19:30.023983 [info ] [Thread-3 (]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m04:19:30.025127 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m04:19:30.025734 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m04:19:30.029845 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m04:19:30.031890 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-29 04:19:30.026192 => 2023-07-29 04:19:30.031822
[0m04:19:30.032388 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m04:19:30.054836 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m04:19:30.057549 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m04:19:30.058185 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m04:19:30.058676 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:19:30.069446 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m04:19:30.071013 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m04:19:30.072023 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "postgres"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."dev"."my_first_dbt_model"
where id = 1
  );
[0m04:19:30.076271 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0 seconds
[0m04:19:30.079386 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m04:19:30.080195 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "postgres"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m04:19:30.082018 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m04:19:30.084121 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m04:19:30.084843 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m04:19:30.085320 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m04:19:30.086658 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m04:19:30.089096 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m04:19:30.089623 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "postgres"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m04:19:30.090430 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0 seconds
[0m04:19:30.091933 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-29 04:19:30.032867 => 2023-07-29 04:19:30.091876
[0m04:19:30.092561 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m04:19:30.093617 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfbefa63-b7d6-46aa-9762-166d8f788c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a8cd5550>]}
[0m04:19:30.094513 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.07s]
[0m04:19:30.095694 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m04:19:30.098935 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:19:30.099517 [debug] [MainThread]: Using postgres connection "master"
[0m04:19:30.100076 [debug] [MainThread]: On master: BEGIN
[0m04:19:30.100649 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:19:30.109546 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m04:19:30.110477 [debug] [MainThread]: On master: COMMIT
[0m04:19:30.111178 [debug] [MainThread]: Using postgres connection "master"
[0m04:19:30.111784 [debug] [MainThread]: On master: COMMIT
[0m04:19:30.112825 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m04:19:30.113684 [debug] [MainThread]: On master: Close
[0m04:19:30.114921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:19:30.115547 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m04:19:30.116151 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m04:19:30.116815 [info ] [MainThread]: 
[0m04:19:30.117696 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m04:19:30.118978 [debug] [MainThread]: Command end result
[0m04:19:30.128274 [info ] [MainThread]: 
[0m04:19:30.129189 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:19:30.130251 [info ] [MainThread]: 
[0m04:19:30.131757 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:19:30.132890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65aaba2f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a8c65050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a8cfc190>]}
[0m04:19:30.133938 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 04:27:47.250259 | d5b153c8-4026-444c-9e49-2e0d5b6f9d94 ==============================
[0m04:27:47.250259 [info ] [MainThread]: Running with dbt=1.4.5
[0m04:27:47.253618 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:27:47.254665 [debug] [MainThread]: Tracking: tracking
[0m04:27:47.257392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161b148650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161abbf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161ab93750>]}
[0m04:27:47.271595 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m04:27:47.317874 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:27:47.319040 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:27:47.327087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5b153c8-4026-444c-9e49-2e0d5b6f9d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16194943d0>]}
[0m04:27:47.341294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5b153c8-4026-444c-9e49-2e0d5b6f9d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161b149190>]}
[0m04:27:47.342126 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:27:47.343128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5b153c8-4026-444c-9e49-2e0d5b6f9d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161b3b6b90>]}
[0m04:27:47.345302 [info ] [MainThread]: 
[0m04:27:47.349103 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:27:47.351077 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m04:27:47.364126 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m04:27:47.365117 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m04:27:47.365958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:27:47.378800 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m04:27:47.380981 [debug] [ThreadPool]: On list_postgres: Close
[0m04:27:47.383307 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dev'
[0m04:27:47.390912 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m04:27:47.392278 [debug] [ThreadPool]: On list_postgres_dev: BEGIN
[0m04:27:47.393098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:27:47.402316 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m04:27:47.403609 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m04:27:47.404801 [debug] [ThreadPool]: On list_postgres_dev: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_postgres_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m04:27:47.413682 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m04:27:47.415843 [debug] [ThreadPool]: On list_postgres_dev: ROLLBACK
[0m04:27:47.416876 [debug] [ThreadPool]: On list_postgres_dev: Close
[0m04:27:47.424059 [debug] [MainThread]: Using postgres connection "master"
[0m04:27:47.424968 [debug] [MainThread]: On master: BEGIN
[0m04:27:47.425622 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:27:47.435236 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m04:27:47.436303 [debug] [MainThread]: Using postgres connection "master"
[0m04:27:47.437103 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:27:47.449811 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m04:27:47.451712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5b153c8-4026-444c-9e49-2e0d5b6f9d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161ab640d0>]}
[0m04:27:47.452803 [debug] [MainThread]: On master: ROLLBACK
[0m04:27:47.454331 [debug] [MainThread]: Using postgres connection "master"
[0m04:27:47.454981 [debug] [MainThread]: On master: BEGIN
[0m04:27:47.456011 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m04:27:47.457020 [debug] [MainThread]: On master: COMMIT
[0m04:27:47.457973 [debug] [MainThread]: Using postgres connection "master"
[0m04:27:47.458678 [debug] [MainThread]: On master: COMMIT
[0m04:27:47.459570 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m04:27:47.460168 [debug] [MainThread]: On master: Close
[0m04:27:47.461177 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:27:47.462258 [info ] [MainThread]: 
[0m04:27:47.479930 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m04:27:47.481443 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m04:27:47.483309 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m04:27:47.484129 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m04:27:47.487285 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m04:27:47.489947 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-29 04:27:47.484631 => 2023-07-29 04:27:47.489855
[0m04:27:47.490554 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m04:27:47.539450 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m04:27:47.543051 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m04:27:47.543728 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m04:27:47.544326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:27:47.554795 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m04:27:47.556066 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m04:27:47.557037 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "postgres"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m04:27:47.561075 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m04:27:47.570212 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m04:27:47.571230 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "postgres"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m04:27:47.572631 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m04:27:47.576606 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m04:27:47.577416 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "postgres"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m04:27:47.578880 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m04:27:47.612254 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m04:27:47.613465 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m04:27:47.614259 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m04:27:47.616153 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m04:27:47.622172 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m04:27:47.626581 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "postgres"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m04:27:47.633713 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m04:27:47.636012 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-29 04:27:47.491058 => 2023-07-29 04:27:47.635936
[0m04:27:47.636843 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m04:27:47.638276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5b153c8-4026-444c-9e49-2e0d5b6f9d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1619335310>]}
[0m04:27:47.639414 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.16s]
[0m04:27:47.642128 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m04:27:47.643639 [debug] [Thread-3 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m04:27:47.644362 [info ] [Thread-3 (]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m04:27:47.645639 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m04:27:47.646322 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m04:27:47.650536 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m04:27:47.652469 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-29 04:27:47.646841 => 2023-07-29 04:27:47.652384
[0m04:27:47.653060 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m04:27:47.675989 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m04:27:47.679332 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m04:27:47.680200 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m04:27:47.680801 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:27:47.691595 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m04:27:47.692870 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m04:27:47.693566 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "postgres"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."dev"."my_first_dbt_model"
where id = 1
  );
[0m04:27:47.697811 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0 seconds
[0m04:27:47.701377 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m04:27:47.702166 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "postgres"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m04:27:47.703342 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m04:27:47.705296 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m04:27:47.705892 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m04:27:47.706401 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m04:27:47.707763 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m04:27:47.710238 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m04:27:47.710781 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "postgres"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m04:27:47.711777 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0 seconds
[0m04:27:47.713291 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-29 04:27:47.653475 => 2023-07-29 04:27:47.713232
[0m04:27:47.713884 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m04:27:47.715041 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5b153c8-4026-444c-9e49-2e0d5b6f9d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16194be590>]}
[0m04:27:47.715775 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.07s]
[0m04:27:47.716922 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m04:27:47.720235 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:27:47.720935 [debug] [MainThread]: Using postgres connection "master"
[0m04:27:47.721483 [debug] [MainThread]: On master: BEGIN
[0m04:27:47.722036 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:27:47.731277 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m04:27:47.732219 [debug] [MainThread]: On master: COMMIT
[0m04:27:47.732899 [debug] [MainThread]: Using postgres connection "master"
[0m04:27:47.733337 [debug] [MainThread]: On master: COMMIT
[0m04:27:47.734096 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m04:27:47.734662 [debug] [MainThread]: On master: Close
[0m04:27:47.735680 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:27:47.736122 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m04:27:47.736475 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m04:27:47.737025 [info ] [MainThread]: 
[0m04:27:47.737832 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m04:27:47.738947 [debug] [MainThread]: Command end result
[0m04:27:47.747550 [info ] [MainThread]: 
[0m04:27:47.748542 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:27:47.749459 [info ] [MainThread]: 
[0m04:27:47.750319 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:27:47.751891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161b537a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16194bc0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16194be790>]}
[0m04:27:47.752785 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 04:36:37.246682 | 33545531-c37d-4032-beb4-6f6b2145c4e2 ==============================
[0m04:36:37.246682 [info ] [MainThread]: Running with dbt=1.4.5
[0m04:36:37.249709 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:36:37.250704 [debug] [MainThread]: Tracking: tracking
[0m04:36:37.253581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40677e0810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40677e0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4067330850>]}
[0m04:36:37.270206 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m04:36:37.318544 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:36:37.319609 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:36:37.327423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33545531-c37d-4032-beb4-6f6b2145c4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4067b59a90>]}
[0m04:36:37.339570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33545531-c37d-4032-beb4-6f6b2145c4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4065bf0c10>]}
[0m04:36:37.340247 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:36:37.341216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33545531-c37d-4032-beb4-6f6b2145c4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40677e0810>]}
[0m04:36:37.343256 [info ] [MainThread]: 
[0m04:36:37.347142 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:36:37.350048 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m04:36:37.363872 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m04:36:37.364902 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m04:36:37.365800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:36:37.379910 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m04:36:37.381931 [debug] [ThreadPool]: On list_postgres: Close
[0m04:36:37.384794 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dev'
[0m04:36:37.391322 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m04:36:37.392274 [debug] [ThreadPool]: On list_postgres_dev: BEGIN
[0m04:36:37.392897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:36:37.402740 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m04:36:37.404149 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m04:36:37.405029 [debug] [ThreadPool]: On list_postgres_dev: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_postgres_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m04:36:37.418425 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m04:36:37.420406 [debug] [ThreadPool]: On list_postgres_dev: ROLLBACK
[0m04:36:37.421404 [debug] [ThreadPool]: On list_postgres_dev: Close
[0m04:36:37.429234 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:37.430190 [debug] [MainThread]: On master: BEGIN
[0m04:36:37.430988 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:36:37.440558 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m04:36:37.441702 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:37.442535 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:36:37.491192 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m04:36:37.494436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33545531-c37d-4032-beb4-6f6b2145c4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4069b2e590>]}
[0m04:36:37.495537 [debug] [MainThread]: On master: ROLLBACK
[0m04:36:37.496695 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:37.497578 [debug] [MainThread]: On master: BEGIN
[0m04:36:37.499312 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m04:36:37.500369 [debug] [MainThread]: On master: COMMIT
[0m04:36:37.501074 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:37.501671 [debug] [MainThread]: On master: COMMIT
[0m04:36:37.502537 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m04:36:37.503098 [debug] [MainThread]: On master: Close
[0m04:36:37.504234 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:36:37.505310 [info ] [MainThread]: 
[0m04:36:37.524587 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m04:36:37.525486 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m04:36:37.526795 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m04:36:37.527537 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m04:36:37.530781 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m04:36:37.533481 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-29 04:36:37.528109 => 2023-07-29 04:36:37.533379
[0m04:36:37.534170 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m04:36:37.594702 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m04:36:37.597895 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m04:36:37.598510 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m04:36:37.598968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:36:37.609940 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m04:36:37.611114 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m04:36:37.612143 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "postgres"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m04:36:37.615731 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m04:36:37.622624 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m04:36:37.623281 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "postgres"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m04:36:37.624911 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m04:36:37.627858 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m04:36:37.628303 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "postgres"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m04:36:37.629309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m04:36:37.657861 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m04:36:37.658902 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m04:36:37.659769 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m04:36:37.661275 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m04:36:37.667485 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m04:36:37.668242 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "postgres"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m04:36:37.674150 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m04:36:37.676775 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-29 04:36:37.534858 => 2023-07-29 04:36:37.676679
[0m04:36:37.677749 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m04:36:37.679203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33545531-c37d-4032-beb4-6f6b2145c4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4067b7db10>]}
[0m04:36:37.680428 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.15s]
[0m04:36:37.683994 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m04:36:37.686916 [debug] [Thread-3 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m04:36:37.688442 [info ] [Thread-3 (]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m04:36:37.690455 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m04:36:37.691662 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m04:36:37.697903 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m04:36:37.701578 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-29 04:36:37.692766 => 2023-07-29 04:36:37.701341
[0m04:36:37.703121 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m04:36:37.744351 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m04:36:37.747615 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m04:36:37.748394 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m04:36:37.749356 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:36:37.763797 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m04:36:37.764841 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m04:36:37.766042 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "postgres"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."dev"."my_first_dbt_model"
where id = 1
  );
[0m04:36:37.772470 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0 seconds
[0m04:36:37.776491 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m04:36:37.777157 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "postgres"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m04:36:37.778605 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m04:36:37.781211 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m04:36:37.781924 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m04:36:37.782663 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m04:36:37.784265 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m04:36:37.788902 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m04:36:37.789924 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "postgres"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m04:36:37.791544 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0 seconds
[0m04:36:37.794867 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-29 04:36:37.704335 => 2023-07-29 04:36:37.794744
[0m04:36:37.795853 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m04:36:37.797745 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33545531-c37d-4032-beb4-6f6b2145c4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406788e950>]}
[0m04:36:37.799067 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.11s]
[0m04:36:37.800763 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m04:36:37.805583 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:36:37.806753 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:37.807848 [debug] [MainThread]: On master: BEGIN
[0m04:36:37.808757 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:36:37.822827 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m04:36:37.823847 [debug] [MainThread]: On master: COMMIT
[0m04:36:37.824741 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:37.825623 [debug] [MainThread]: On master: COMMIT
[0m04:36:37.826893 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m04:36:37.827833 [debug] [MainThread]: On master: Close
[0m04:36:37.829373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:36:37.830247 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m04:36:37.831193 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m04:36:37.832106 [info ] [MainThread]: 
[0m04:36:37.833130 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m04:36:37.834919 [debug] [MainThread]: Command end result
[0m04:36:37.849011 [info ] [MainThread]: 
[0m04:36:37.850443 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:36:37.851798 [info ] [MainThread]: 
[0m04:36:37.853216 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:36:37.854590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4067346890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40677e0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4065b30110>]}
[0m04:36:37.855842 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 05:02:27.836513 | b2f3192c-29d5-41fd-901b-f6a998ce0984 ==============================
[0m05:02:27.836513 [info ] [MainThread]: Running with dbt=1.4.5
[0m05:02:27.839826 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:02:27.841163 [debug] [MainThread]: Tracking: tracking
[0m05:02:27.843821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb528b4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb52858ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb52929fd0>]}
[0m05:02:27.859457 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m05:02:27.906681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:02:27.907997 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/my_first_dbt_model.sql
[0m05:02:27.923933 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m05:02:27.969808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2f3192c-29d5-41fd-901b-f6a998ce0984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb51010ad0>]}
[0m05:02:27.984915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2f3192c-29d5-41fd-901b-f6a998ce0984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb51008150>]}
[0m05:02:27.986296 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:02:27.987822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2f3192c-29d5-41fd-901b-f6a998ce0984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb5285a110>]}
[0m05:02:27.991365 [info ] [MainThread]: 
[0m05:02:27.994469 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:02:27.997632 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m05:02:28.016591 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m05:02:28.018030 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m05:02:28.019157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:02:28.032465 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m05:02:28.034340 [debug] [ThreadPool]: On list_postgres: Close
[0m05:02:28.036886 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dev'
[0m05:02:28.043686 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m05:02:28.044555 [debug] [ThreadPool]: On list_postgres_dev: BEGIN
[0m05:02:28.045277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:02:28.055850 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m05:02:28.057369 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m05:02:28.058408 [debug] [ThreadPool]: On list_postgres_dev: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_postgres_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m05:02:28.067920 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m05:02:28.070005 [debug] [ThreadPool]: On list_postgres_dev: ROLLBACK
[0m05:02:28.071066 [debug] [ThreadPool]: On list_postgres_dev: Close
[0m05:02:28.078144 [debug] [MainThread]: Using postgres connection "master"
[0m05:02:28.078910 [debug] [MainThread]: On master: BEGIN
[0m05:02:28.079487 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:02:28.088568 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:02:28.089409 [debug] [MainThread]: Using postgres connection "master"
[0m05:02:28.090046 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:02:28.104270 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m05:02:28.106345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2f3192c-29d5-41fd-901b-f6a998ce0984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb53084690>]}
[0m05:02:28.107263 [debug] [MainThread]: On master: ROLLBACK
[0m05:02:28.108163 [debug] [MainThread]: Using postgres connection "master"
[0m05:02:28.108671 [debug] [MainThread]: On master: BEGIN
[0m05:02:28.109681 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:02:28.110518 [debug] [MainThread]: On master: COMMIT
[0m05:02:28.111183 [debug] [MainThread]: Using postgres connection "master"
[0m05:02:28.111684 [debug] [MainThread]: On master: COMMIT
[0m05:02:28.112523 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:02:28.113226 [debug] [MainThread]: On master: Close
[0m05:02:28.114348 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:02:28.115468 [info ] [MainThread]: 
[0m05:02:28.135540 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m05:02:28.136460 [info ] [Thread-1 (]: 1 of 2 START sql view model dev.my_first_dbt_model ............................. [RUN]
[0m05:02:28.138334 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m05:02:28.139045 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m05:02:28.141982 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m05:02:28.145198 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-29 05:02:28.139623 => 2023-07-29 05:02:28.144985
[0m05:02:28.146094 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m05:02:28.193000 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m05:02:28.197354 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:02:28.198056 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m05:02:28.198693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:28.208877 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:02:28.210015 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:02:28.210886 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  create view "postgres"."dev"."my_first_dbt_model__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m05:02:28.214796 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m05:02:28.221595 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:02:28.222764 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "postgres"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m05:02:28.224311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:02:28.227586 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:02:28.228383 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "postgres"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m05:02:28.229943 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:02:28.252321 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m05:02:28.253510 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:02:28.254536 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m05:02:28.256729 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m05:02:28.263031 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:02:28.264176 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "postgres"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m05:02:28.269187 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m05:02:28.271160 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-29 05:02:28.146827 => 2023-07-29 05:02:28.271095
[0m05:02:28.271851 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m05:02:28.272983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f3192c-29d5-41fd-901b-f6a998ce0984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb510a1910>]}
[0m05:02:28.273914 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dev.my_first_dbt_model ........................ [[32mCREATE VIEW[0m in 0.14s]
[0m05:02:28.276897 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m05:02:28.278725 [debug] [Thread-3 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m05:02:28.279398 [info ] [Thread-3 (]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m05:02:28.280702 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m05:02:28.281325 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m05:02:28.284032 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m05:02:28.285447 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-29 05:02:28.281684 => 2023-07-29 05:02:28.285341
[0m05:02:28.285890 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m05:02:28.291854 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m05:02:28.295059 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:02:28.296601 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m05:02:28.298282 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:02:28.310762 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m05:02:28.312593 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:02:28.313600 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "postgres"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."dev"."my_first_dbt_model"
where id = 1
  );
[0m05:02:28.319047 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0 seconds
[0m05:02:28.323585 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:02:28.324473 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "postgres"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m05:02:28.326296 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:02:28.329039 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m05:02:28.330170 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:02:28.330869 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m05:02:28.332864 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m05:02:28.337463 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:02:28.338252 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "postgres"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m05:02:28.339314 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0 seconds
[0m05:02:28.341013 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-29 05:02:28.286310 => 2023-07-29 05:02:28.340956
[0m05:02:28.341722 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m05:02:28.342889 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f3192c-29d5-41fd-901b-f6a998ce0984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb510ae550>]}
[0m05:02:28.343714 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.06s]
[0m05:02:28.344744 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m05:02:28.348364 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:02:28.348889 [debug] [MainThread]: Using postgres connection "master"
[0m05:02:28.349354 [debug] [MainThread]: On master: BEGIN
[0m05:02:28.349717 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:02:28.359552 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:02:28.360664 [debug] [MainThread]: On master: COMMIT
[0m05:02:28.361618 [debug] [MainThread]: Using postgres connection "master"
[0m05:02:28.362300 [debug] [MainThread]: On master: COMMIT
[0m05:02:28.363263 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:02:28.363840 [debug] [MainThread]: On master: Close
[0m05:02:28.364817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:02:28.365521 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m05:02:28.366060 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m05:02:28.366699 [info ] [MainThread]: 
[0m05:02:28.367763 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m05:02:28.368893 [debug] [MainThread]: Command end result
[0m05:02:28.378531 [info ] [MainThread]: 
[0m05:02:28.379794 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:02:28.381008 [info ] [MainThread]: 
[0m05:02:28.382529 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:02:28.383847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb52e69490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb510afc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb510af5d0>]}
[0m05:02:28.384695 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 05:05:56.551621 | e88d3ef5-a07d-41dc-9a36-4ead4d88f71f ==============================
[0m05:05:56.551621 [info ] [MainThread]: Running with dbt=1.4.5
[0m05:05:56.554582 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:05:56.555762 [debug] [MainThread]: Tracking: tracking
[0m05:05:56.559038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fc4a4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fc684c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fc0db2d0>]}
[0m05:05:56.573903 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m05:05:56.621359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m05:05:56.622650 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/example/test.sql
[0m05:05:56.623642 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/my_first_dbt_model.sql
[0m05:05:56.640625 [debug] [MainThread]: 1699: static parser successfully parsed example/test.sql
[0m05:05:56.656992 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m05:05:56.693267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e88d3ef5-a07d-41dc-9a36-4ead4d88f71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fa93c450>]}
[0m05:05:56.709617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e88d3ef5-a07d-41dc-9a36-4ead4d88f71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fc646210>]}
[0m05:05:56.710977 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:05:56.712473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e88d3ef5-a07d-41dc-9a36-4ead4d88f71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fc10d0d0>]}
[0m05:05:56.715877 [info ] [MainThread]: 
[0m05:05:56.719704 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:05:56.722226 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m05:05:56.735625 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m05:05:56.736596 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m05:05:56.737336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:05:56.750965 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m05:05:56.752713 [debug] [ThreadPool]: On list_postgres: Close
[0m05:05:56.755242 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dev'
[0m05:05:56.763111 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m05:05:56.763767 [debug] [ThreadPool]: On list_postgres_dev: BEGIN
[0m05:05:56.764528 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:05:56.773491 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m05:05:56.775721 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m05:05:56.777198 [debug] [ThreadPool]: On list_postgres_dev: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_postgres_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m05:05:56.787731 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m05:05:56.790231 [debug] [ThreadPool]: On list_postgres_dev: ROLLBACK
[0m05:05:56.791446 [debug] [ThreadPool]: On list_postgres_dev: Close
[0m05:05:56.798342 [debug] [MainThread]: Using postgres connection "master"
[0m05:05:56.799162 [debug] [MainThread]: On master: BEGIN
[0m05:05:56.800157 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:05:56.809591 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:05:56.810658 [debug] [MainThread]: Using postgres connection "master"
[0m05:05:56.811622 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:05:56.825196 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m05:05:56.827170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e88d3ef5-a07d-41dc-9a36-4ead4d88f71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fd072990>]}
[0m05:05:56.828176 [debug] [MainThread]: On master: ROLLBACK
[0m05:05:56.829051 [debug] [MainThread]: Using postgres connection "master"
[0m05:05:56.829580 [debug] [MainThread]: On master: BEGIN
[0m05:05:56.830651 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:05:56.831965 [debug] [MainThread]: On master: COMMIT
[0m05:05:56.832887 [debug] [MainThread]: Using postgres connection "master"
[0m05:05:56.833546 [debug] [MainThread]: On master: COMMIT
[0m05:05:56.834561 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:05:56.835215 [debug] [MainThread]: On master: Close
[0m05:05:56.836322 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:05:56.837099 [info ] [MainThread]: 
[0m05:05:56.857360 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m05:05:56.857775 [debug] [Thread-2 (]: Began running node model.my_dbt_project.test
[0m05:05:56.858900 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m05:05:56.860846 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.test .......................................... [RUN]
[0m05:05:56.862616 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m05:05:56.864071 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.test'
[0m05:05:56.865314 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m05:05:56.866368 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.test
[0m05:05:56.869909 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m05:05:56.873931 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.test"
[0m05:05:56.879457 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.test (compile): 2023-07-29 05:05:56.870636 => 2023-07-29 05:05:56.879207
[0m05:05:56.880459 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-29 05:05:56.867360 => 2023-07-29 05:05:56.880359
[0m05:05:56.880932 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.test
[0m05:05:56.881712 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m05:05:56.982563 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.test"
[0m05:05:56.984951 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m05:05:56.988021 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.test"
[0m05:05:56.988648 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:05:56.989005 [debug] [Thread-2 (]: On model.my_dbt_project.test: BEGIN
[0m05:05:56.989715 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m05:05:56.990385 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m05:05:56.991042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:57.002348 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m05:05:57.002709 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:05:57.003746 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.test"
[0m05:05:57.004749 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:05:57.005984 [debug] [Thread-2 (]: On model.my_dbt_project.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.test"} */

  
    

  create  table "postgres"."dev"."test__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select * 
    from worldbank_api
    limit 10 

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m05:05:57.007046 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "postgres"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m05:05:57.012367 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m05:05:57.020380 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:05:57.020726 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0 seconds
[0m05:05:57.021458 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "postgres"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m05:05:57.024919 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.test"
[0m05:05:57.026292 [debug] [Thread-2 (]: On model.my_dbt_project.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.test"} */
alter table "postgres"."dev"."test__dbt_tmp" rename to "test"
[0m05:05:57.026589 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:05:57.030135 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:05:57.030365 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:05:57.030869 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "postgres"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m05:05:57.056327 [debug] [Thread-2 (]: On model.my_dbt_project.test: COMMIT
[0m05:05:57.056711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:05:57.057732 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.test"
[0m05:05:57.064044 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m05:05:57.065093 [debug] [Thread-2 (]: On model.my_dbt_project.test: COMMIT
[0m05:05:57.065884 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:05:57.067805 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m05:05:57.068905 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m05:05:57.069696 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m05:05:57.075571 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.test"
[0m05:05:57.079481 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:05:57.080587 [debug] [Thread-2 (]: On model.my_dbt_project.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.test"} */
drop table if exists "postgres"."dev"."test__dbt_backup" cascade
[0m05:05:57.081424 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop view if exists "postgres"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m05:05:57.083017 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m05:05:57.085317 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.test (execute): 2023-07-29 05:05:56.882315 => 2023-07-29 05:05:57.085251
[0m05:05:57.086171 [debug] [Thread-2 (]: On model.my_dbt_project.test: Close
[0m05:05:57.087508 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e88d3ef5-a07d-41dc-9a36-4ead4d88f71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46faa080d0>]}
[0m05:05:57.088148 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m05:05:57.088663 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.test ..................................... [[32mSELECT 10[0m in 0.22s]
[0m05:05:57.090442 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-29 05:05:56.907335 => 2023-07-29 05:05:57.090386
[0m05:05:57.092690 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.test
[0m05:05:57.093375 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m05:05:57.095273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e88d3ef5-a07d-41dc-9a36-4ead4d88f71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46f9ffd4d0>]}
[0m05:05:57.095997 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.23s]
[0m05:05:57.097016 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m05:05:57.098596 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m05:05:57.099656 [info ] [Thread-4 (]: 3 of 3 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m05:05:57.101304 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m05:05:57.101962 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m05:05:57.104809 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m05:05:57.106665 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-29 05:05:57.102487 => 2023-07-29 05:05:57.106594
[0m05:05:57.107296 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m05:05:57.129966 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m05:05:57.133786 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:05:57.134714 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m05:05:57.135383 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:05:57.145233 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m05:05:57.146328 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:05:57.147139 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "postgres"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."dev"."my_first_dbt_model"
where id = 1
  );
[0m05:05:57.151238 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m05:05:57.154592 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:05:57.155319 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "postgres"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m05:05:57.156818 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:05:57.158813 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m05:05:57.159481 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:05:57.160007 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m05:05:57.161349 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m05:05:57.163797 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:05:57.164884 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "postgres"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m05:05:57.166029 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m05:05:57.167751 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-29 05:05:57.107768 => 2023-07-29 05:05:57.167689
[0m05:05:57.168453 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m05:05:57.169511 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e88d3ef5-a07d-41dc-9a36-4ead4d88f71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46faabf690>]}
[0m05:05:57.170400 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.07s]
[0m05:05:57.171433 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m05:05:57.174883 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:05:57.175553 [debug] [MainThread]: Using postgres connection "master"
[0m05:05:57.176161 [debug] [MainThread]: On master: BEGIN
[0m05:05:57.176741 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:05:57.186146 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:05:57.187360 [debug] [MainThread]: On master: COMMIT
[0m05:05:57.188209 [debug] [MainThread]: Using postgres connection "master"
[0m05:05:57.189217 [debug] [MainThread]: On master: COMMIT
[0m05:05:57.190463 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:05:57.191450 [debug] [MainThread]: On master: Close
[0m05:05:57.192835 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:05:57.193681 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m05:05:57.194300 [debug] [MainThread]: Connection 'model.my_dbt_project.test' was properly closed.
[0m05:05:57.194872 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m05:05:57.195512 [info ] [MainThread]: 
[0m05:05:57.196635 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m05:05:57.198259 [debug] [MainThread]: Command end result
[0m05:05:57.210699 [info ] [MainThread]: 
[0m05:05:57.212033 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:05:57.213379 [info ] [MainThread]: 
[0m05:05:57.215074 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:05:57.217131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fc4a4850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fc14b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fc152610>]}
[0m05:05:57.218717 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 05:07:02.151436 | e657d704-5710-4176-8554-8f523fd4ae86 ==============================
[0m05:07:02.151436 [info ] [MainThread]: Running with dbt=1.4.5
[0m05:07:02.154220 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:07:02.155302 [debug] [MainThread]: Tracking: tracking
[0m05:07:02.157676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1191603290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1191603c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11916012d0>]}
[0m05:07:02.172094 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m05:07:02.233705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:07:02.235223 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/test.sql
[0m05:07:02.253884 [debug] [MainThread]: 1699: static parser successfully parsed example/test.sql
[0m05:07:02.292415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e657d704-5710-4176-8554-8f523fd4ae86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1191510c50>]}
[0m05:07:02.310557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e657d704-5710-4176-8554-8f523fd4ae86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118f7eab50>]}
[0m05:07:02.311526 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:07:02.312938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e657d704-5710-4176-8554-8f523fd4ae86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11910c3e90>]}
[0m05:07:02.315246 [info ] [MainThread]: 
[0m05:07:02.318753 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:07:02.321456 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m05:07:02.345918 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m05:07:02.346917 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m05:07:02.348294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:07:02.363799 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m05:07:02.365992 [debug] [ThreadPool]: On list_postgres: Close
[0m05:07:02.368895 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dev'
[0m05:07:02.379104 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m05:07:02.380411 [debug] [ThreadPool]: On list_postgres_dev: BEGIN
[0m05:07:02.381407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:07:02.407414 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m05:07:02.408725 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m05:07:02.409938 [debug] [ThreadPool]: On list_postgres_dev: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_postgres_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m05:07:02.428899 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m05:07:02.431051 [debug] [ThreadPool]: On list_postgres_dev: ROLLBACK
[0m05:07:02.432101 [debug] [ThreadPool]: On list_postgres_dev: Close
[0m05:07:02.440197 [debug] [MainThread]: Using postgres connection "master"
[0m05:07:02.441139 [debug] [MainThread]: On master: BEGIN
[0m05:07:02.442130 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:07:02.455341 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:07:02.457045 [debug] [MainThread]: Using postgres connection "master"
[0m05:07:02.458209 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:07:02.472492 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m05:07:02.474701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e657d704-5710-4176-8554-8f523fd4ae86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118f93f5d0>]}
[0m05:07:02.475802 [debug] [MainThread]: On master: ROLLBACK
[0m05:07:02.476977 [debug] [MainThread]: Using postgres connection "master"
[0m05:07:02.477822 [debug] [MainThread]: On master: BEGIN
[0m05:07:02.479232 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:07:02.480253 [debug] [MainThread]: On master: COMMIT
[0m05:07:02.481133 [debug] [MainThread]: Using postgres connection "master"
[0m05:07:02.482025 [debug] [MainThread]: On master: COMMIT
[0m05:07:02.483149 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:07:02.483803 [debug] [MainThread]: On master: Close
[0m05:07:02.484787 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:07:02.485890 [info ] [MainThread]: 
[0m05:07:02.510276 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m05:07:02.510812 [debug] [Thread-2 (]: Began running node model.my_dbt_project.test
[0m05:07:02.512155 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m05:07:02.513299 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.test .......................................... [RUN]
[0m05:07:02.515319 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m05:07:02.516682 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.test'
[0m05:07:02.518125 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m05:07:02.519069 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.test
[0m05:07:02.524403 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m05:07:02.528123 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.test"
[0m05:07:02.531980 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.test (compile): 2023-07-29 05:07:02.525278 => 2023-07-29 05:07:02.531853
[0m05:07:02.532484 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-29 05:07:02.519869 => 2023-07-29 05:07:02.532395
[0m05:07:02.532802 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.test
[0m05:07:02.533449 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m05:07:02.608196 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m05:07:02.611291 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.test"
[0m05:07:02.614291 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:07:02.614612 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.test"
[0m05:07:02.615169 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m05:07:02.615635 [debug] [Thread-2 (]: On model.my_dbt_project.test: BEGIN
[0m05:07:02.616338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:07:02.616770 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m05:07:02.627858 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m05:07:02.628280 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:07:02.629260 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.test"
[0m05:07:02.630124 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:07:02.630952 [debug] [Thread-2 (]: On model.my_dbt_project.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.test"} */

  
    

  create  table "postgres"."dev"."test__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select * 
    from worldbank_a
    limit 10 

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m05:07:02.631635 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "postgres"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m05:07:02.633203 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "worldbank_a" does not exist
LINE 21:     from worldbank_a
                  ^

[0m05:07:02.634350 [debug] [Thread-2 (]: On model.my_dbt_project.test: ROLLBACK
[0m05:07:02.636016 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.test (execute): 2023-07-29 05:07:02.533880 => 2023-07-29 05:07:02.635902
[0m05:07:02.637024 [debug] [Thread-2 (]: On model.my_dbt_project.test: Close
[0m05:07:02.637476 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m05:07:02.649615 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:07:02.650962 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "postgres"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m05:07:02.654203 [debug] [Thread-2 (]: Database Error in model test (models/example/test.sql)
  relation "worldbank_a" does not exist
  LINE 21:     from worldbank_a
                    ^
  compiled Code at target/run/my_dbt_project/models/example/test.sql
[0m05:07:02.654552 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:07:02.655574 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e657d704-5710-4176-8554-8f523fd4ae86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118f8e5810>]}
[0m05:07:02.659333 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:07:02.660539 [error] [Thread-2 (]: 2 of 3 ERROR creating sql table model dev.test ................................. [[31mERROR[0m in 0.14s]
[0m05:07:02.661284 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "postgres"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m05:07:02.664213 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.test
[0m05:07:02.666524 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:07:02.695535 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m05:07:02.696662 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:07:02.697718 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m05:07:02.700317 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m05:07:02.708260 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:07:02.709878 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "postgres"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m05:07:02.718867 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m05:07:02.722166 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-29 05:07:02.550294 => 2023-07-29 05:07:02.722080
[0m05:07:02.723568 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m05:07:02.725638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e657d704-5710-4176-8554-8f523fd4ae86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118f84ffd0>]}
[0m05:07:02.727255 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.21s]
[0m05:07:02.729469 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m05:07:02.734264 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m05:07:02.735522 [info ] [Thread-4 (]: 3 of 3 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m05:07:02.737944 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m05:07:02.738791 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m05:07:02.742589 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m05:07:02.745117 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-29 05:07:02.739425 => 2023-07-29 05:07:02.745000
[0m05:07:02.745847 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m05:07:02.767613 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m05:07:02.769284 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:07:02.769904 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m05:07:02.770595 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:07:02.780028 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m05:07:02.781362 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:07:02.781975 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "postgres"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."dev"."my_first_dbt_model"
where id = 1
  );
[0m05:07:02.786021 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m05:07:02.789305 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:07:02.789843 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "postgres"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m05:07:02.791090 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:07:02.793099 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m05:07:02.793634 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:07:02.794160 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m05:07:02.795555 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m05:07:02.799360 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:07:02.799925 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "postgres"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m05:07:02.800902 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m05:07:02.803165 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-29 05:07:02.746275 => 2023-07-29 05:07:02.803068
[0m05:07:02.803919 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m05:07:02.805513 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e657d704-5710-4176-8554-8f523fd4ae86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118c6aeb10>]}
[0m05:07:02.806532 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.07s]
[0m05:07:02.808137 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m05:07:02.812577 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:07:02.813450 [debug] [MainThread]: Using postgres connection "master"
[0m05:07:02.814286 [debug] [MainThread]: On master: BEGIN
[0m05:07:02.815042 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:07:02.828462 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:07:02.829522 [debug] [MainThread]: On master: COMMIT
[0m05:07:02.830676 [debug] [MainThread]: Using postgres connection "master"
[0m05:07:02.831691 [debug] [MainThread]: On master: COMMIT
[0m05:07:02.833522 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:07:02.834585 [debug] [MainThread]: On master: Close
[0m05:07:02.836095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:07:02.837306 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m05:07:02.838087 [debug] [MainThread]: Connection 'model.my_dbt_project.test' was properly closed.
[0m05:07:02.838975 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m05:07:02.839739 [info ] [MainThread]: 
[0m05:07:02.841193 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m05:07:02.843031 [debug] [MainThread]: Command end result
[0m05:07:02.857304 [info ] [MainThread]: 
[0m05:07:02.858282 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:07:02.859365 [info ] [MainThread]: 
[0m05:07:02.861121 [error] [MainThread]: [33mDatabase Error in model test (models/example/test.sql)[0m
[0m05:07:02.862456 [error] [MainThread]:   relation "worldbank_a" does not exist
[0m05:07:02.863841 [error] [MainThread]:   LINE 21:     from worldbank_a
[0m05:07:02.866222 [error] [MainThread]:                     ^
[0m05:07:02.868862 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/test.sql
[0m05:07:02.870211 [info ] [MainThread]: 
[0m05:07:02.871603 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m05:07:02.873401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118f8ec050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118f8ec2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118f8ec0d0>]}
[0m05:07:02.874411 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 05:16:03.528829 | aba58cef-def9-4971-b9d3-088a97805246 ==============================
[0m05:16:03.528829 [info ] [MainThread]: Running with dbt=1.4.5
[0m05:16:03.531411 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:16:03.532375 [debug] [MainThread]: Tracking: tracking
[0m05:16:03.534788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3891927410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f389105ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f389160de90>]}
[0m05:16:03.551090 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m05:16:03.598391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:16:03.599526 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/test.sql
[0m05:16:03.615982 [debug] [MainThread]: 1699: static parser successfully parsed example/test.sql
[0m05:16:03.640990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aba58cef-def9-4971-b9d3-088a97805246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388f97d2d0>]}
[0m05:16:03.657034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aba58cef-def9-4971-b9d3-088a97805246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388fa3b310>]}
[0m05:16:03.658349 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:16:03.659796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aba58cef-def9-4971-b9d3-088a97805246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38910dc0d0>]}
[0m05:16:03.662526 [info ] [MainThread]: 
[0m05:16:03.665744 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:16:03.667860 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m05:16:03.679925 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m05:16:03.681391 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m05:16:03.682535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:16:03.696623 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m05:16:03.698764 [debug] [ThreadPool]: On list_postgres: Close
[0m05:16:03.701139 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dev'
[0m05:16:03.708323 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m05:16:03.709362 [debug] [ThreadPool]: On list_postgres_dev: BEGIN
[0m05:16:03.709977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:16:03.719573 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m05:16:03.720747 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m05:16:03.721784 [debug] [ThreadPool]: On list_postgres_dev: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_postgres_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m05:16:03.735022 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m05:16:03.738677 [debug] [ThreadPool]: On list_postgres_dev: ROLLBACK
[0m05:16:03.740020 [debug] [ThreadPool]: On list_postgres_dev: Close
[0m05:16:03.748695 [debug] [MainThread]: Using postgres connection "master"
[0m05:16:03.749625 [debug] [MainThread]: On master: BEGIN
[0m05:16:03.750612 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:16:03.763532 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:16:03.764729 [debug] [MainThread]: Using postgres connection "master"
[0m05:16:03.765695 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:16:03.781351 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m05:16:03.783417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aba58cef-def9-4971-b9d3-088a97805246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3891133190>]}
[0m05:16:03.784412 [debug] [MainThread]: On master: ROLLBACK
[0m05:16:03.785594 [debug] [MainThread]: Using postgres connection "master"
[0m05:16:03.786764 [debug] [MainThread]: On master: BEGIN
[0m05:16:03.788040 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:16:03.788864 [debug] [MainThread]: On master: COMMIT
[0m05:16:03.789496 [debug] [MainThread]: Using postgres connection "master"
[0m05:16:03.789999 [debug] [MainThread]: On master: COMMIT
[0m05:16:03.790892 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:16:03.791532 [debug] [MainThread]: On master: Close
[0m05:16:03.792653 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:16:03.793987 [info ] [MainThread]: 
[0m05:16:03.814188 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m05:16:03.814818 [debug] [Thread-2 (]: Began running node model.my_dbt_project.test
[0m05:16:03.815862 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m05:16:03.817637 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.test .......................................... [RUN]
[0m05:16:03.819679 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m05:16:03.821865 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.test'
[0m05:16:03.822753 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m05:16:03.823467 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.test
[0m05:16:03.827495 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m05:16:03.830476 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.test"
[0m05:16:03.833459 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-29 05:16:03.823997 => 2023-07-29 05:16:03.833354
[0m05:16:03.833998 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.test (compile): 2023-07-29 05:16:03.828214 => 2023-07-29 05:16:03.833879
[0m05:16:03.834423 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m05:16:03.835626 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.test
[0m05:16:03.906457 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m05:16:03.908760 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.test"
[0m05:16:03.912602 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.test"
[0m05:16:03.913044 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:16:03.913258 [debug] [Thread-2 (]: On model.my_dbt_project.test: BEGIN
[0m05:16:03.913807 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m05:16:03.914213 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m05:16:03.914812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:16:03.925631 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m05:16:03.926136 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:16:03.926917 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.test"
[0m05:16:03.927722 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:16:03.928420 [debug] [Thread-2 (]: On model.my_dbt_project.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.test"} */

  
    

  create  table "postgres"."dev"."test__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select * 
    from worldbank_api
    limit 10 

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m05:16:03.929156 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "postgres"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m05:16:03.933424 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m05:16:03.941014 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:16:03.941365 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0 seconds
[0m05:16:03.941991 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "postgres"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m05:16:03.945177 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.test"
[0m05:16:03.946342 [debug] [Thread-2 (]: On model.my_dbt_project.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.test"} */
alter table "postgres"."dev"."test" rename to "test__dbt_backup"
[0m05:16:03.946961 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:16:03.947415 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:16:03.949835 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:16:03.953342 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.test"
[0m05:16:03.954470 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "postgres"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m05:16:03.955192 [debug] [Thread-2 (]: On model.my_dbt_project.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.test"} */
alter table "postgres"."dev"."test__dbt_tmp" rename to "test"
[0m05:16:03.956784 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:16:03.956945 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:16:03.994425 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m05:16:03.998133 [debug] [Thread-2 (]: On model.my_dbt_project.test: COMMIT
[0m05:16:03.998882 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:16:03.999756 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.test"
[0m05:16:04.000531 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m05:16:04.001232 [debug] [Thread-2 (]: On model.my_dbt_project.test: COMMIT
[0m05:16:04.003674 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m05:16:04.004084 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m05:16:04.009135 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:16:04.011977 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.test"
[0m05:16:04.012883 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "postgres"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m05:16:04.013893 [debug] [Thread-2 (]: On model.my_dbt_project.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.test"} */
drop table if exists "postgres"."dev"."test__dbt_backup" cascade
[0m05:16:04.019082 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m05:16:04.019413 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m05:16:04.020987 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.test (execute): 2023-07-29 05:16:03.853647 => 2023-07-29 05:16:04.020923
[0m05:16:04.022619 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-29 05:16:03.836794 => 2023-07-29 05:16:04.022565
[0m05:16:04.023212 [debug] [Thread-2 (]: On model.my_dbt_project.test: Close
[0m05:16:04.023901 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m05:16:04.024991 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aba58cef-def9-4971-b9d3-088a97805246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388fa44290>]}
[0m05:16:04.025965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aba58cef-def9-4971-b9d3-088a97805246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388f995f50>]}
[0m05:16:04.026737 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dev.test ..................................... [[32mSELECT 10[0m in 0.20s]
[0m05:16:04.027732 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.21s]
[0m05:16:04.030220 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.test
[0m05:16:04.031085 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m05:16:04.033062 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m05:16:04.034164 [info ] [Thread-4 (]: 3 of 3 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m05:16:04.035347 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m05:16:04.036030 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m05:16:04.039113 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m05:16:04.040890 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-29 05:16:04.036528 => 2023-07-29 05:16:04.040817
[0m05:16:04.041520 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m05:16:04.064561 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m05:16:04.067089 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:16:04.067785 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m05:16:04.068321 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:16:04.078597 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m05:16:04.079601 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:16:04.080510 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "postgres"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."dev"."my_first_dbt_model"
where id = 1
  );
[0m05:16:04.084932 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m05:16:04.088271 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:16:04.088884 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "postgres"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m05:16:04.090123 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:16:04.092275 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m05:16:04.092927 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:16:04.093438 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m05:16:04.094751 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m05:16:04.097198 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:16:04.097911 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "postgres"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m05:16:04.098895 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m05:16:04.100415 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-29 05:16:04.041975 => 2023-07-29 05:16:04.100356
[0m05:16:04.101354 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m05:16:04.102770 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aba58cef-def9-4971-b9d3-088a97805246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388ef6a650>]}
[0m05:16:04.103611 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.07s]
[0m05:16:04.104543 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m05:16:04.108041 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:16:04.108738 [debug] [MainThread]: Using postgres connection "master"
[0m05:16:04.109290 [debug] [MainThread]: On master: BEGIN
[0m05:16:04.109885 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:16:04.119417 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:16:04.120789 [debug] [MainThread]: On master: COMMIT
[0m05:16:04.121726 [debug] [MainThread]: Using postgres connection "master"
[0m05:16:04.122493 [debug] [MainThread]: On master: COMMIT
[0m05:16:04.123509 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:16:04.124080 [debug] [MainThread]: On master: Close
[0m05:16:04.125086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:16:04.125630 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m05:16:04.126072 [debug] [MainThread]: Connection 'model.my_dbt_project.test' was properly closed.
[0m05:16:04.126566 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m05:16:04.127114 [info ] [MainThread]: 
[0m05:16:04.128137 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m05:16:04.129511 [debug] [MainThread]: Command end result
[0m05:16:04.139922 [info ] [MainThread]: 
[0m05:16:04.141026 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:16:04.142156 [info ] [MainThread]: 
[0m05:16:04.143292 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:16:04.144597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f389182f8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388f95e9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388ef4fe50>]}
[0m05:16:04.145472 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 05:32:09.387271 | 3188440a-e85b-4b76-97e9-4ed1b152c508 ==============================
[0m05:32:09.387271 [info ] [MainThread]: Running with dbt=1.4.5
[0m05:32:09.389716 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m05:32:09.390671 [debug] [MainThread]: Tracking: tracking
[0m05:32:09.393071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c38d4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c383a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c374f950>]}
[0m05:32:09.394560 [info ] [MainThread]: Setting up your profile.
[0m05:32:19.776421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c3091f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c3091e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c38e3a90>]}
[0m05:32:19.777855 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 05:37:19.233462 | 8dce0329-fa6e-4fab-8d52-703279b42918 ==============================
[0m05:37:19.233462 [info ] [MainThread]: Running with dbt=1.4.5
[0m05:37:19.236587 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:37:19.237889 [debug] [MainThread]: Tracking: tracking
[0m05:37:19.241117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c571a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c5a3e810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c5b12d90>]}
[0m05:37:19.256205 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m05:37:19.267503 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m05:37:19.268753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8dce0329-fa6e-4fab-8d52-703279b42918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c59bf510>]}
[0m05:37:19.962107 [debug] [MainThread]: 1699: static parser successfully parsed example/test.sql
[0m05:37:19.976188 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m05:37:19.980822 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m05:37:20.044432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8dce0329-fa6e-4fab-8d52-703279b42918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c3aef990>]}
[0m05:37:20.056828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8dce0329-fa6e-4fab-8d52-703279b42918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c3b4db90>]}
[0m05:37:20.057658 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:37:20.058840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dce0329-fa6e-4fab-8d52-703279b42918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c3a9a410>]}
[0m05:37:20.060819 [info ] [MainThread]: 
[0m05:37:20.063888 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:37:20.066843 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_app'
[0m05:37:20.078653 [debug] [ThreadPool]: Using postgres connection "list_my_app"
[0m05:37:20.079762 [debug] [ThreadPool]: On list_my_app: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_my_app"} */

    select distinct nspname from pg_namespace
  
[0m05:37:20.080512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:37:20.093452 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m05:37:20.096258 [debug] [ThreadPool]: On list_my_app: Close
[0m05:37:20.098319 [debug] [ThreadPool]: Acquiring new postgres connection 'create_my_app_dev'
[0m05:37:20.099790 [debug] [ThreadPool]: Acquiring new postgres connection 'create_my_app_dev'
[0m05:37:20.100851 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='my_app', schema='dev', identifier=None)"
[0m05:37:20.106906 [debug] [ThreadPool]: Using postgres connection "create_my_app_dev"
[0m05:37:20.107618 [debug] [ThreadPool]: On create_my_app_dev: BEGIN
[0m05:37:20.108379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:37:20.117722 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m05:37:20.118690 [debug] [ThreadPool]: Using postgres connection "create_my_app_dev"
[0m05:37:20.119292 [debug] [ThreadPool]: On create_my_app_dev: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "create_my_app_dev"} */
create schema if not exists "dev"
[0m05:37:20.120377 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0 seconds
[0m05:37:20.121620 [debug] [ThreadPool]: On create_my_app_dev: COMMIT
[0m05:37:20.122185 [debug] [ThreadPool]: Using postgres connection "create_my_app_dev"
[0m05:37:20.122818 [debug] [ThreadPool]: On create_my_app_dev: COMMIT
[0m05:37:20.124040 [debug] [ThreadPool]: SQL status: COMMIT in 0 seconds
[0m05:37:20.124594 [debug] [ThreadPool]: On create_my_app_dev: Close
[0m05:37:20.126872 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_app_dev'
[0m05:37:20.133628 [debug] [ThreadPool]: Using postgres connection "list_my_app_dev"
[0m05:37:20.134674 [debug] [ThreadPool]: On list_my_app_dev: BEGIN
[0m05:37:20.135395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:37:20.144417 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m05:37:20.145280 [debug] [ThreadPool]: Using postgres connection "list_my_app_dev"
[0m05:37:20.145922 [debug] [ThreadPool]: On list_my_app_dev: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_my_app_dev"} */
select
      'my_app' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'my_app' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m05:37:20.149254 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m05:37:20.150868 [debug] [ThreadPool]: On list_my_app_dev: ROLLBACK
[0m05:37:20.151791 [debug] [ThreadPool]: On list_my_app_dev: Close
[0m05:37:20.157240 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:20.158324 [debug] [MainThread]: On master: BEGIN
[0m05:37:20.159000 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:37:20.168483 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:37:20.169708 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:20.170278 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:37:20.175343 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m05:37:20.177135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dce0329-fa6e-4fab-8d52-703279b42918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c3ae6d10>]}
[0m05:37:20.177909 [debug] [MainThread]: On master: ROLLBACK
[0m05:37:20.178668 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:20.179182 [debug] [MainThread]: On master: BEGIN
[0m05:37:20.180173 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:37:20.180856 [debug] [MainThread]: On master: COMMIT
[0m05:37:20.181438 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:20.181965 [debug] [MainThread]: On master: COMMIT
[0m05:37:20.182861 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:37:20.183638 [debug] [MainThread]: On master: Close
[0m05:37:20.184741 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:37:20.186099 [info ] [MainThread]: 
[0m05:37:20.205654 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m05:37:20.206241 [debug] [Thread-2 (]: Began running node model.my_dbt_project.test
[0m05:37:20.207249 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m05:37:20.208300 [info ] [Thread-2 (]: 2 of 3 START sql table model dev.test .......................................... [RUN]
[0m05:37:20.210292 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m05:37:20.211618 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.test'
[0m05:37:20.212666 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m05:37:20.213333 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.test
[0m05:37:20.216405 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m05:37:20.219979 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.test"
[0m05:37:20.226129 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.test (compile): 2023-07-29 05:37:20.217028 => 2023-07-29 05:37:20.225874
[0m05:37:20.226712 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-29 05:37:20.214067 => 2023-07-29 05:37:20.226606
[0m05:37:20.227059 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.test
[0m05:37:20.228025 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m05:37:20.298061 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m05:37:20.300788 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.test"
[0m05:37:20.305410 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.test"
[0m05:37:20.305930 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:37:20.306187 [debug] [Thread-2 (]: On model.my_dbt_project.test: BEGIN
[0m05:37:20.306843 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m05:37:20.307258 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m05:37:20.307978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:37:20.318646 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m05:37:20.319337 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:37:20.319822 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.test"
[0m05:37:20.320559 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:37:20.321202 [debug] [Thread-2 (]: On model.my_dbt_project.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.test"} */

  
    

  create  table "my_app"."dev"."test__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select * 
    from worldbank_api
    limit 10 

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m05:37:20.321685 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "my_app"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m05:37:20.323050 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "worldbank_api" does not exist
LINE 21:     from worldbank_api
                  ^

[0m05:37:20.323946 [debug] [Thread-2 (]: On model.my_dbt_project.test: ROLLBACK
[0m05:37:20.324796 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m05:37:20.325167 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.test (execute): 2023-07-29 05:37:20.228509 => 2023-07-29 05:37:20.325087
[0m05:37:20.334010 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:37:20.335023 [debug] [Thread-2 (]: On model.my_dbt_project.test: Close
[0m05:37:20.335783 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "my_app"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m05:37:20.339719 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:37:20.341894 [debug] [Thread-2 (]: Database Error in model test (models/example/test.sql)
  relation "worldbank_api" does not exist
  LINE 21:     from worldbank_api
                    ^
  compiled Code at target/run/my_dbt_project/models/example/test.sql
[0m05:37:20.364338 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dce0329-fa6e-4fab-8d52-703279b42918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c39d1bd0>]}
[0m05:37:20.366139 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m05:37:20.367189 [error] [Thread-2 (]: 2 of 3 ERROR creating sql table model dev.test ................................. [[31mERROR[0m in 0.15s]
[0m05:37:20.368577 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:37:20.370740 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.test
[0m05:37:20.371585 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m05:37:20.374167 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m05:37:20.380749 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:37:20.381595 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "my_app"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m05:37:20.382603 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m05:37:20.384274 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-29 05:37:20.250073 => 2023-07-29 05:37:20.384216
[0m05:37:20.385012 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m05:37:20.386025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dce0329-fa6e-4fab-8d52-703279b42918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c3b85610>]}
[0m05:37:20.386905 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.18s]
[0m05:37:20.388156 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m05:37:20.389755 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m05:37:20.390931 [info ] [Thread-4 (]: 3 of 3 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m05:37:20.392312 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m05:37:20.392949 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m05:37:20.396131 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m05:37:20.397984 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-29 05:37:20.393437 => 2023-07-29 05:37:20.397909
[0m05:37:20.398610 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m05:37:20.421523 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m05:37:20.423947 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:37:20.424634 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m05:37:20.425364 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:37:20.434829 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m05:37:20.435826 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:37:20.436524 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "my_app"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "my_app"."dev"."my_first_dbt_model"
where id = 1
  );
[0m05:37:20.438831 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m05:37:20.442046 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:37:20.442643 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "my_app"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m05:37:20.443565 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:37:20.445360 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m05:37:20.446028 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:37:20.446722 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m05:37:20.448205 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m05:37:20.450947 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:37:20.451563 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "my_app"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m05:37:20.452422 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m05:37:20.454075 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-29 05:37:20.399112 => 2023-07-29 05:37:20.454014
[0m05:37:20.454806 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m05:37:20.455907 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dce0329-fa6e-4fab-8d52-703279b42918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c39f6450>]}
[0m05:37:20.456644 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.06s]
[0m05:37:20.457664 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m05:37:20.460812 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:37:20.461497 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:20.462097 [debug] [MainThread]: On master: BEGIN
[0m05:37:20.462567 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:37:20.472042 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:37:20.473243 [debug] [MainThread]: On master: COMMIT
[0m05:37:20.474049 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:20.474699 [debug] [MainThread]: On master: COMMIT
[0m05:37:20.475648 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:37:20.476338 [debug] [MainThread]: On master: Close
[0m05:37:20.477270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:37:20.477896 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m05:37:20.478534 [debug] [MainThread]: Connection 'model.my_dbt_project.test' was properly closed.
[0m05:37:20.479160 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m05:37:20.479901 [info ] [MainThread]: 
[0m05:37:20.480945 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m05:37:20.482250 [debug] [MainThread]: Command end result
[0m05:37:20.494133 [info ] [MainThread]: 
[0m05:37:20.495785 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:37:20.496994 [info ] [MainThread]: 
[0m05:37:20.499297 [error] [MainThread]: [33mDatabase Error in model test (models/example/test.sql)[0m
[0m05:37:20.501143 [error] [MainThread]:   relation "worldbank_api" does not exist
[0m05:37:20.503850 [error] [MainThread]:   LINE 21:     from worldbank_api
[0m05:37:20.505686 [error] [MainThread]:                     ^
[0m05:37:20.507333 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/test.sql
[0m05:37:20.508785 [info ] [MainThread]: 
[0m05:37:20.510107 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m05:37:20.511719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c3a22fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c5aea690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c39d1510>]}
[0m05:37:20.513961 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 05:37:47.467181 | 79415791-8425-46f9-9cc3-b075122459a5 ==============================
[0m05:37:47.467181 [info ] [MainThread]: Running with dbt=1.4.5
[0m05:37:47.470387 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:37:47.471626 [debug] [MainThread]: Tracking: tracking
[0m05:37:47.474425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08bdae89d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08bda5ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08bdae8110>]}
[0m05:37:47.489091 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m05:37:47.533272 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m05:37:47.534645 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/example/test.sql
[0m05:37:47.549221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79415791-8425-46f9-9cc3-b075122459a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08bbbe55d0>]}
[0m05:37:47.560136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79415791-8425-46f9-9cc3-b075122459a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08bbbb2e90>]}
[0m05:37:47.560873 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:37:47.561825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79415791-8425-46f9-9cc3-b075122459a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08bfa96390>]}
[0m05:37:47.563545 [info ] [MainThread]: 
[0m05:37:47.566190 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:37:47.568117 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_app'
[0m05:37:47.580633 [debug] [ThreadPool]: Using postgres connection "list_my_app"
[0m05:37:47.581550 [debug] [ThreadPool]: On list_my_app: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_my_app"} */

    select distinct nspname from pg_namespace
  
[0m05:37:47.582396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:37:47.594328 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m05:37:47.596203 [debug] [ThreadPool]: On list_my_app: Close
[0m05:37:47.598725 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_app_dev'
[0m05:37:47.606584 [debug] [ThreadPool]: Using postgres connection "list_my_app_dev"
[0m05:37:47.607576 [debug] [ThreadPool]: On list_my_app_dev: BEGIN
[0m05:37:47.608208 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:37:47.617415 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m05:37:47.618309 [debug] [ThreadPool]: Using postgres connection "list_my_app_dev"
[0m05:37:47.619016 [debug] [ThreadPool]: On list_my_app_dev: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_my_app_dev"} */
select
      'my_app' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'my_app' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m05:37:47.622181 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m05:37:47.624117 [debug] [ThreadPool]: On list_my_app_dev: ROLLBACK
[0m05:37:47.625008 [debug] [ThreadPool]: On list_my_app_dev: Close
[0m05:37:47.632024 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:47.632907 [debug] [MainThread]: On master: BEGIN
[0m05:37:47.633536 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:37:47.642617 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:37:47.643472 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:47.644148 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:37:47.648927 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m05:37:47.650841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79415791-8425-46f9-9cc3-b075122459a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08bd756fd0>]}
[0m05:37:47.651634 [debug] [MainThread]: On master: ROLLBACK
[0m05:37:47.652565 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:47.653282 [debug] [MainThread]: On master: BEGIN
[0m05:37:47.654424 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:37:47.655416 [debug] [MainThread]: On master: COMMIT
[0m05:37:47.656160 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:47.656826 [debug] [MainThread]: On master: COMMIT
[0m05:37:47.657857 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:37:47.658655 [debug] [MainThread]: On master: Close
[0m05:37:47.659840 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:37:47.660922 [info ] [MainThread]: 
[0m05:37:47.680149 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m05:37:47.681046 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m05:37:47.682361 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m05:37:47.683184 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m05:37:47.686296 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m05:37:47.688653 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-29 05:37:47.683839 => 2023-07-29 05:37:47.688572
[0m05:37:47.689249 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m05:37:47.740624 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m05:37:47.743707 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:37:47.744301 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m05:37:47.744838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:37:47.756099 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m05:37:47.757143 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:37:47.758153 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "my_app"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m05:37:47.761218 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m05:37:47.771419 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:37:47.772351 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "my_app"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m05:37:47.773585 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:37:47.776809 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:37:47.777397 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "my_app"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m05:37:47.778329 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:37:47.803824 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m05:37:47.804784 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:37:47.805274 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m05:37:47.806541 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m05:37:47.812159 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m05:37:47.812747 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "my_app"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m05:37:47.815536 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m05:37:47.817151 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-29 05:37:47.689875 => 2023-07-29 05:37:47.817092
[0m05:37:47.817696 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m05:37:47.818709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79415791-8425-46f9-9cc3-b075122459a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08bd27bed0>]}
[0m05:37:47.819392 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.14s]
[0m05:37:47.822097 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m05:37:47.823983 [debug] [Thread-3 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m05:37:47.824914 [info ] [Thread-3 (]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m05:37:47.826652 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m05:37:47.827329 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m05:37:47.830556 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m05:37:47.832213 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-29 05:37:47.827842 => 2023-07-29 05:37:47.832132
[0m05:37:47.832793 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m05:37:47.854263 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m05:37:47.857248 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:37:47.858133 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m05:37:47.858852 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:37:47.870570 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m05:37:47.871746 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:37:47.872611 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "my_app"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "my_app"."dev"."my_first_dbt_model"
where id = 1
  );
[0m05:37:47.874763 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0 seconds
[0m05:37:47.878037 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:37:47.878683 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "my_app"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m05:37:47.879922 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m05:37:47.882032 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m05:37:47.882739 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:37:47.883337 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m05:37:47.884660 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m05:37:47.887437 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m05:37:47.888340 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "my_app"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m05:37:47.889537 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0 seconds
[0m05:37:47.891181 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-29 05:37:47.833220 => 2023-07-29 05:37:47.891122
[0m05:37:47.891863 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m05:37:47.893063 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79415791-8425-46f9-9cc3-b075122459a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08bda5f290>]}
[0m05:37:47.894155 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.07s]
[0m05:37:47.895258 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m05:37:47.898819 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:37:47.899426 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:47.899951 [debug] [MainThread]: On master: BEGIN
[0m05:37:47.900422 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:37:47.911592 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m05:37:47.912659 [debug] [MainThread]: On master: COMMIT
[0m05:37:47.913378 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:47.914183 [debug] [MainThread]: On master: COMMIT
[0m05:37:47.915335 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m05:37:47.916379 [debug] [MainThread]: On master: Close
[0m05:37:47.918083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:37:47.918948 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m05:37:47.919751 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m05:37:47.920764 [info ] [MainThread]: 
[0m05:37:47.922396 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m05:37:47.924166 [debug] [MainThread]: Command end result
[0m05:37:47.962263 [info ] [MainThread]: 
[0m05:37:47.963316 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:37:47.964545 [info ] [MainThread]: 
[0m05:37:47.965677 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:37:47.966929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08bd2eb490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08bd63b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08bd2e5810>]}
[0m05:37:47.967681 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 07:36:20.806967 | 15561de6-4135-465d-ae04-d2be97f5ceac ==============================
[0m07:36:20.806967 [info ] [MainThread]: Running with dbt=1.4.5
[0m07:36:20.809865 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:36:20.811283 [debug] [MainThread]: Tracking: tracking
[0m07:36:20.815042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b2055ef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ff76810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b2055f210>]}
[0m07:36:20.828820 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m07:36:20.841291 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m07:36:20.842656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '15561de6-4135-465d-ae04-d2be97f5ceac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1e800950>]}
[0m07:36:21.579352 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m07:36:21.593790 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m07:36:21.663306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15561de6-4135-465d-ae04-d2be97f5ceac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b2036cc90>]}
[0m07:36:21.677341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15561de6-4135-465d-ae04-d2be97f5ceac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1e7e2910>]}
[0m07:36:21.678626 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m07:36:21.680233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15561de6-4135-465d-ae04-d2be97f5ceac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b2055f550>]}
[0m07:36:21.682450 [info ] [MainThread]: 
[0m07:36:21.687800 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:36:21.690365 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_app'
[0m07:36:21.704446 [debug] [ThreadPool]: Using postgres connection "list_my_app"
[0m07:36:21.705398 [debug] [ThreadPool]: On list_my_app: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_my_app"} */

    select distinct nspname from pg_namespace
  
[0m07:36:21.706250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:36:21.720041 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m07:36:21.721928 [debug] [ThreadPool]: On list_my_app: Close
[0m07:36:21.724691 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_app_public'
[0m07:36:21.732008 [debug] [ThreadPool]: Using postgres connection "list_my_app_public"
[0m07:36:21.732941 [debug] [ThreadPool]: On list_my_app_public: BEGIN
[0m07:36:21.733748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:36:21.744864 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m07:36:21.746130 [debug] [ThreadPool]: Using postgres connection "list_my_app_public"
[0m07:36:21.746948 [debug] [ThreadPool]: On list_my_app_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_my_app_public"} */
select
      'my_app' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_app' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m07:36:21.750674 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m07:36:21.752630 [debug] [ThreadPool]: On list_my_app_public: ROLLBACK
[0m07:36:21.753820 [debug] [ThreadPool]: On list_my_app_public: Close
[0m07:36:21.761271 [debug] [MainThread]: Using postgres connection "master"
[0m07:36:21.762070 [debug] [MainThread]: On master: BEGIN
[0m07:36:21.762836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:36:21.772675 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:36:21.773672 [debug] [MainThread]: Using postgres connection "master"
[0m07:36:21.774483 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:36:21.779893 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m07:36:21.782082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15561de6-4135-465d-ae04-d2be97f5ceac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1e800790>]}
[0m07:36:21.783490 [debug] [MainThread]: On master: ROLLBACK
[0m07:36:21.784678 [debug] [MainThread]: Using postgres connection "master"
[0m07:36:21.785577 [debug] [MainThread]: On master: BEGIN
[0m07:36:21.786950 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:36:21.788042 [debug] [MainThread]: On master: COMMIT
[0m07:36:21.788833 [debug] [MainThread]: Using postgres connection "master"
[0m07:36:21.789531 [debug] [MainThread]: On master: COMMIT
[0m07:36:21.790486 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:36:21.791277 [debug] [MainThread]: On master: Close
[0m07:36:21.792675 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:36:21.793634 [info ] [MainThread]: 
[0m07:36:21.813592 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m07:36:21.814701 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m07:36:21.816789 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m07:36:21.817833 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m07:36:21.821920 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m07:36:21.824616 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-29 07:36:21.818514 => 2023-07-29 07:36:21.824511
[0m07:36:21.825334 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m07:36:21.875562 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m07:36:21.879322 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m07:36:21.879955 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m07:36:21.880474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:36:21.890046 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:36:21.891039 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m07:36:21.891940 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "my_app"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m07:36:21.896037 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m07:36:21.902925 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m07:36:21.903794 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "my_app"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m07:36:21.905052 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:36:21.927004 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m07:36:21.928258 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m07:36:21.929545 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m07:36:21.931406 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:36:21.937343 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m07:36:21.938252 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "my_app"."public"."my_first_dbt_model__dbt_backup" cascade
[0m07:36:21.939573 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:36:21.941405 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-29 07:36:21.825913 => 2023-07-29 07:36:21.941344
[0m07:36:21.942158 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m07:36:21.943408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15561de6-4135-465d-ae04-d2be97f5ceac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b2078e410>]}
[0m07:36:21.944570 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.13s]
[0m07:36:21.947735 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m07:36:21.949951 [debug] [Thread-3 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m07:36:21.950998 [info ] [Thread-3 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m07:36:21.952821 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m07:36:21.953899 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m07:36:21.957376 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m07:36:21.959678 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-29 07:36:21.954711 => 2023-07-29 07:36:21.959596
[0m07:36:21.960329 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m07:36:21.982694 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m07:36:21.985878 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m07:36:21.986718 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m07:36:21.987390 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:36:21.999223 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m07:36:22.000378 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m07:36:22.001606 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "my_app"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "my_app"."public"."my_first_dbt_model"
where id = 1
  );
[0m07:36:22.004330 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0 seconds
[0m07:36:22.007695 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m07:36:22.008330 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "my_app"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m07:36:22.009350 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:36:22.011226 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m07:36:22.011964 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m07:36:22.012561 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m07:36:22.014011 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m07:36:22.016457 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m07:36:22.017009 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "my_app"."public"."my_second_dbt_model__dbt_backup" cascade
[0m07:36:22.017814 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0 seconds
[0m07:36:22.019311 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-29 07:36:21.960847 => 2023-07-29 07:36:22.019254
[0m07:36:22.019915 [debug] [Thread-3 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m07:36:22.021289 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15561de6-4135-465d-ae04-d2be97f5ceac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1e7ef790>]}
[0m07:36:22.022239 [info ] [Thread-3 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.07s]
[0m07:36:22.023469 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m07:36:22.026840 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:36:22.027562 [debug] [MainThread]: Using postgres connection "master"
[0m07:36:22.028175 [debug] [MainThread]: On master: BEGIN
[0m07:36:22.028768 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:36:22.037923 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:36:22.038883 [debug] [MainThread]: On master: COMMIT
[0m07:36:22.039561 [debug] [MainThread]: Using postgres connection "master"
[0m07:36:22.040205 [debug] [MainThread]: On master: COMMIT
[0m07:36:22.040991 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:36:22.041997 [debug] [MainThread]: On master: Close
[0m07:36:22.043297 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:36:22.044044 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m07:36:22.044849 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m07:36:22.045604 [info ] [MainThread]: 
[0m07:36:22.046587 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m07:36:22.047819 [debug] [MainThread]: Command end result
[0m07:36:22.057428 [info ] [MainThread]: 
[0m07:36:22.058768 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:36:22.059919 [info ] [MainThread]: 
[0m07:36:22.061519 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:36:22.063347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b20472950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1fe8bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1e7dfdd0>]}
[0m07:36:22.064579 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 07:49:12.427021 | 8b23be5e-fe54-420b-a6f0-67d5965857d3 ==============================
[0m07:49:12.427021 [info ] [MainThread]: Running with dbt=1.4.5
[0m07:49:12.430018 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:49:12.431191 [debug] [MainThread]: Tracking: tracking
[0m07:49:12.434202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83e5b0e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83e0736d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83e600c10>]}
[0m07:49:12.448297 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m07:49:12.460410 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m07:49:12.462116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8b23be5e-fe54-420b-a6f0-67d5965857d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83e91c710>]}
[0m07:49:13.177572 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m07:49:13.191395 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model copy.sql
[0m07:49:13.195711 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m07:49:13.258169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b23be5e-fe54-420b-a6f0-67d5965857d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83e017c50>]}
[0m07:49:13.271230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b23be5e-fe54-420b-a6f0-67d5965857d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83c941d10>]}
[0m07:49:13.271924 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m07:49:13.272918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b23be5e-fe54-420b-a6f0-67d5965857d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83c9b39d0>]}
[0m07:49:13.274710 [info ] [MainThread]: 
[0m07:49:13.277501 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:49:13.279603 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m07:49:13.291187 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m07:49:13.291981 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m07:49:13.292601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:49:13.307003 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m07:49:13.309148 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m07:49:13.311860 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m07:49:13.318484 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m07:49:13.319490 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m07:49:13.320224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:49:13.330122 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m07:49:13.331003 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m07:49:13.331629 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m07:49:13.338925 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m07:49:13.340945 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m07:49:13.342040 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m07:49:13.349061 [debug] [MainThread]: Using postgres connection "master"
[0m07:49:13.349719 [debug] [MainThread]: On master: BEGIN
[0m07:49:13.350218 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:49:13.360088 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:49:13.361033 [debug] [MainThread]: Using postgres connection "master"
[0m07:49:13.361543 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:49:13.373131 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m07:49:13.374906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b23be5e-fe54-420b-a6f0-67d5965857d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83e065750>]}
[0m07:49:13.375893 [debug] [MainThread]: On master: ROLLBACK
[0m07:49:13.376989 [debug] [MainThread]: Using postgres connection "master"
[0m07:49:13.377836 [debug] [MainThread]: On master: BEGIN
[0m07:49:13.379267 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:49:13.380023 [debug] [MainThread]: On master: COMMIT
[0m07:49:13.380888 [debug] [MainThread]: Using postgres connection "master"
[0m07:49:13.381387 [debug] [MainThread]: On master: COMMIT
[0m07:49:13.382689 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:49:13.383481 [debug] [MainThread]: On master: Close
[0m07:49:13.385131 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:49:13.386502 [info ] [MainThread]: 
[0m07:49:13.418577 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m07:49:13.419290 [debug] [Thread-2 (]: Began running node model.my_dbt_project.my_first_dbt_model copy
[0m07:49:13.420829 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m07:49:13.422196 [info ] [Thread-2 (]: 2 of 3 START sql view model public.my_first_dbt_model copy ..................... [RUN]
[0m07:49:13.423954 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m07:49:13.425716 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model copy'
[0m07:49:13.426613 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m07:49:13.427496 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.my_first_dbt_model copy
[0m07:49:13.430399 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m07:49:13.434210 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model copy"
[0m07:49:13.439429 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-29 07:49:13.427962 => 2023-07-29 07:49:13.439173
[0m07:49:13.440010 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.my_first_dbt_model copy (compile): 2023-07-29 07:49:13.431314 => 2023-07-29 07:49:13.439951
[0m07:49:13.440285 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m07:49:13.440916 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.my_first_dbt_model copy
[0m07:49:13.505255 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model copy"
[0m07:49:13.513541 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m07:49:13.517874 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m07:49:13.518526 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model copy"
[0m07:49:13.518760 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m07:49:13.519265 [debug] [Thread-2 (]: On model.my_dbt_project.my_first_dbt_model copy: BEGIN
[0m07:49:13.519787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:49:13.520295 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m07:49:13.530825 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:49:13.531293 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m07:49:13.532034 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m07:49:13.532646 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model copy"
[0m07:49:13.533389 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m07:49:13.533851 [debug] [Thread-2 (]: On model.my_dbt_project.my_first_dbt_model copy: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model copy"} */

  create view "worldbank_api_db"."public"."my_first_dbt_model copy__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with selected_rows as (

    select *
    from worldbank_api
    limit 10

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m07:49:13.535505 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "source_data" does not exist
LINE 23: from source_data
              ^

[0m07:49:13.536143 [debug] [Thread-2 (]: On model.my_dbt_project.my_first_dbt_model copy: ROLLBACK
[0m07:49:13.537060 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.my_first_dbt_model copy (execute): 2023-07-29 07:49:13.457982 => 2023-07-29 07:49:13.536976
[0m07:49:13.537557 [debug] [Thread-2 (]: On model.my_dbt_project.my_first_dbt_model copy: Close
[0m07:49:13.539729 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m07:49:13.548053 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m07:49:13.549871 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m07:49:13.551886 [debug] [Thread-2 (]: Database Error in model my_first_dbt_model copy (models/example/my_first_dbt_model copy.sql)
  relation "source_data" does not exist
  LINE 23: from source_data
                ^
  compiled Code at target/run/my_dbt_project/models/example/my_first_dbt_model copy.sql
[0m07:49:13.553611 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b23be5e-fe54-420b-a6f0-67d5965857d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83c8e1e90>]}
[0m07:49:13.553967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:49:13.554750 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model public.my_first_dbt_model copy ............ [[31mERROR[0m in 0.13s]
[0m07:49:13.573656 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.my_first_dbt_model copy
[0m07:49:13.580885 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m07:49:13.582458 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m07:49:13.583189 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m07:49:13.585623 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:49:13.591832 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m07:49:13.593287 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m07:49:13.594911 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:49:13.597262 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-29 07:49:13.441289 => 2023-07-29 07:49:13.597199
[0m07:49:13.598101 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m07:49:13.599280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b23be5e-fe54-420b-a6f0-67d5965857d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83c2241d0>]}
[0m07:49:13.600176 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.18s]
[0m07:49:13.601535 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m07:49:13.603799 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m07:49:13.605035 [info ] [Thread-4 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m07:49:13.606206 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m07:49:13.606712 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m07:49:13.609609 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m07:49:13.611285 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-29 07:49:13.607022 => 2023-07-29 07:49:13.611211
[0m07:49:13.611896 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m07:49:13.616301 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m07:49:13.618807 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m07:49:13.619328 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m07:49:13.619869 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:49:13.629944 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m07:49:13.630636 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m07:49:13.631040 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m07:49:13.634823 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m07:49:13.638079 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m07:49:13.638920 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m07:49:13.640270 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:49:13.642473 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m07:49:13.643245 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m07:49:13.644002 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m07:49:13.645815 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m07:49:13.648340 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m07:49:13.649443 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m07:49:13.650446 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m07:49:13.652198 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-29 07:49:13.612296 => 2023-07-29 07:49:13.652142
[0m07:49:13.652823 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m07:49:13.653941 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b23be5e-fe54-420b-a6f0-67d5965857d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83e3c3590>]}
[0m07:49:13.654970 [info ] [Thread-4 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.05s]
[0m07:49:13.656211 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m07:49:13.659447 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:49:13.660092 [debug] [MainThread]: Using postgres connection "master"
[0m07:49:13.660627 [debug] [MainThread]: On master: BEGIN
[0m07:49:13.661106 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:49:13.670015 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:49:13.671018 [debug] [MainThread]: On master: COMMIT
[0m07:49:13.671800 [debug] [MainThread]: Using postgres connection "master"
[0m07:49:13.672542 [debug] [MainThread]: On master: COMMIT
[0m07:49:13.673674 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:49:13.674327 [debug] [MainThread]: On master: Close
[0m07:49:13.675382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:49:13.675994 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m07:49:13.676708 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model copy' was properly closed.
[0m07:49:13.677253 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m07:49:13.677854 [info ] [MainThread]: 
[0m07:49:13.678658 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m07:49:13.679849 [debug] [MainThread]: Command end result
[0m07:49:13.689533 [info ] [MainThread]: 
[0m07:49:13.690455 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:49:13.691671 [info ] [MainThread]: 
[0m07:49:13.693178 [error] [MainThread]: [33mDatabase Error in model my_first_dbt_model copy (models/example/my_first_dbt_model copy.sql)[0m
[0m07:49:13.694434 [error] [MainThread]:   relation "source_data" does not exist
[0m07:49:13.695645 [error] [MainThread]:   LINE 23: from source_data
[0m07:49:13.696792 [error] [MainThread]:                 ^
[0m07:49:13.698193 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/my_first_dbt_model copy.sql
[0m07:49:13.699208 [info ] [MainThread]: 
[0m07:49:13.700321 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m07:49:13.701468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83c94c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83c969b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83c9b0390>]}
[0m07:49:13.702239 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 07:50:03.622601 | a33aef2b-e98b-48a0-8544-b8168a98b304 ==============================
[0m07:50:03.622601 [info ] [MainThread]: Running with dbt=1.4.5
[0m07:50:03.625370 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:50:03.626782 [debug] [MainThread]: Tracking: tracking
[0m07:50:03.630370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7500192cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7500138d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7500190810>]}
[0m07:50:03.643927 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m07:50:03.690643 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m07:50:03.691740 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/example/selected_rows.sql
[0m07:50:03.692603 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/example/my_first_dbt_model copy.sql
[0m07:50:03.711036 [debug] [MainThread]: 1699: static parser successfully parsed example/selected_rows.sql
[0m07:50:03.735370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a33aef2b-e98b-48a0-8544-b8168a98b304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7500138b10>]}
[0m07:50:03.750463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a33aef2b-e98b-48a0-8544-b8168a98b304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ffd53450>]}
[0m07:50:03.751382 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m07:50:03.752559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a33aef2b-e98b-48a0-8544-b8168a98b304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7500132bd0>]}
[0m07:50:03.754641 [info ] [MainThread]: 
[0m07:50:03.758142 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:50:03.760088 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m07:50:03.772216 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m07:50:03.773350 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m07:50:03.774132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:50:03.786834 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m07:50:03.789622 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m07:50:03.793059 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m07:50:03.801101 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m07:50:03.802315 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m07:50:03.803255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:50:03.812725 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m07:50:03.813621 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m07:50:03.814204 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m07:50:03.821071 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m07:50:03.823067 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m07:50:03.824024 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m07:50:03.830971 [debug] [MainThread]: Using postgres connection "master"
[0m07:50:03.831763 [debug] [MainThread]: On master: BEGIN
[0m07:50:03.832631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:50:03.842341 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:50:03.843229 [debug] [MainThread]: Using postgres connection "master"
[0m07:50:03.843776 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:50:03.856403 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m07:50:03.859169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a33aef2b-e98b-48a0-8544-b8168a98b304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7500570dd0>]}
[0m07:50:03.860616 [debug] [MainThread]: On master: ROLLBACK
[0m07:50:03.862093 [debug] [MainThread]: Using postgres connection "master"
[0m07:50:03.862979 [debug] [MainThread]: On master: BEGIN
[0m07:50:03.864254 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:50:03.864867 [debug] [MainThread]: On master: COMMIT
[0m07:50:03.865495 [debug] [MainThread]: Using postgres connection "master"
[0m07:50:03.865949 [debug] [MainThread]: On master: COMMIT
[0m07:50:03.866763 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:50:03.867351 [debug] [MainThread]: On master: Close
[0m07:50:03.868392 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:50:03.869438 [info ] [MainThread]: 
[0m07:50:03.891107 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m07:50:03.891821 [debug] [Thread-2 (]: Began running node model.my_dbt_project.selected_rows
[0m07:50:03.893433 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m07:50:03.894641 [info ] [Thread-2 (]: 2 of 3 START sql view model public.selected_rows ............................... [RUN]
[0m07:50:03.896442 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m07:50:03.897433 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.selected_rows'
[0m07:50:03.898197 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m07:50:03.898769 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.selected_rows
[0m07:50:03.903039 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m07:50:03.906205 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.selected_rows"
[0m07:50:03.908863 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.selected_rows (compile): 2023-07-29 07:50:03.903745 => 2023-07-29 07:50:03.908695
[0m07:50:03.909315 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-29 07:50:03.899415 => 2023-07-29 07:50:03.909236
[0m07:50:03.909695 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.selected_rows
[0m07:50:03.910304 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m07:50:03.988731 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.selected_rows"
[0m07:50:03.990026 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m07:50:03.992929 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m07:50:03.993656 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: BEGIN
[0m07:50:03.994281 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m07:50:03.994538 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m07:50:03.995349 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m07:50:03.996709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:50:04.006691 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m07:50:04.007714 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m07:50:04.007979 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:50:04.008738 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.selected_rows"} */

  create view "worldbank_api_db"."public"."selected_rows__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with selected_rows as (

    select *
    from worldbank_api
    limit 10

)

select *
from selected_rows

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m07:50:04.009553 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m07:50:04.011020 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m07:50:04.014410 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m07:50:04.014832 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m07:50:04.021373 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m07:50:04.024373 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m07:50:04.025566 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m07:50:04.026625 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.selected_rows"} */
alter table "worldbank_api_db"."public"."selected_rows__dbt_tmp" rename to "selected_rows"
[0m07:50:04.028373 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:50:04.029042 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:50:04.032315 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m07:50:04.049990 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m07:50:04.055068 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: COMMIT
[0m07:50:04.056802 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m07:50:04.057179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:50:04.058087 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: COMMIT
[0m07:50:04.072964 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m07:50:04.074870 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m07:50:04.075575 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m07:50:04.076887 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m07:50:04.085225 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m07:50:04.086894 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.selected_rows"} */
drop view if exists "worldbank_api_db"."public"."selected_rows__dbt_backup" cascade
[0m07:50:04.087651 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:50:04.088566 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m07:50:04.090970 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m07:50:04.093237 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.selected_rows (execute): 2023-07-29 07:50:03.910739 => 2023-07-29 07:50:04.093171
[0m07:50:04.094123 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m07:50:04.094719 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: Close
[0m07:50:04.096678 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a33aef2b-e98b-48a0-8544-b8168a98b304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7500191490>]}
[0m07:50:04.098431 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.selected_rows .......................... [[32mCREATE VIEW[0m in 0.20s]
[0m07:50:04.102902 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.selected_rows
[0m07:50:04.103728 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:50:04.106823 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-29 07:50:03.927639 => 2023-07-29 07:50:04.106765
[0m07:50:04.107613 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m07:50:04.109231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a33aef2b-e98b-48a0-8544-b8168a98b304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74fe5695d0>]}
[0m07:50:04.110503 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.21s]
[0m07:50:04.112027 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m07:50:04.114055 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m07:50:04.114945 [info ] [Thread-4 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m07:50:04.116392 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m07:50:04.117188 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m07:50:04.120951 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m07:50:04.123293 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-29 07:50:04.117921 => 2023-07-29 07:50:04.123199
[0m07:50:04.124055 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m07:50:04.128920 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m07:50:04.131139 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m07:50:04.131832 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m07:50:04.132495 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:50:04.143647 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m07:50:04.145050 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m07:50:04.146101 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m07:50:04.150671 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m07:50:04.156426 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m07:50:04.157294 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m07:50:04.158835 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:50:04.160874 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m07:50:04.161611 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m07:50:04.162169 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m07:50:04.163703 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m07:50:04.166178 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m07:50:04.166789 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m07:50:04.167789 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m07:50:04.169765 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-29 07:50:04.124636 => 2023-07-29 07:50:04.169617
[0m07:50:04.170623 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m07:50:04.171900 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a33aef2b-e98b-48a0-8544-b8168a98b304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74fe4fdb90>]}
[0m07:50:04.172633 [info ] [Thread-4 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.06s]
[0m07:50:04.173656 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m07:50:04.176481 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:50:04.177081 [debug] [MainThread]: Using postgres connection "master"
[0m07:50:04.177532 [debug] [MainThread]: On master: BEGIN
[0m07:50:04.178020 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:50:04.187193 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:50:04.188062 [debug] [MainThread]: On master: COMMIT
[0m07:50:04.188691 [debug] [MainThread]: Using postgres connection "master"
[0m07:50:04.189121 [debug] [MainThread]: On master: COMMIT
[0m07:50:04.189777 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:50:04.190329 [debug] [MainThread]: On master: Close
[0m07:50:04.191157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:50:04.191780 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m07:50:04.192317 [debug] [MainThread]: Connection 'model.my_dbt_project.selected_rows' was properly closed.
[0m07:50:04.192846 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m07:50:04.193440 [info ] [MainThread]: 
[0m07:50:04.194680 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m07:50:04.195769 [debug] [MainThread]: Command end result
[0m07:50:04.205686 [info ] [MainThread]: 
[0m07:50:04.206706 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:50:04.207652 [info ] [MainThread]: 
[0m07:50:04.208861 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:50:04.209952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75001db650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ffc6df90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74fe45b690>]}
[0m07:50:04.210656 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 08:07:34.467429 | b39873a2-2550-4492-8f77-57e1cb234f4a ==============================
[0m08:07:34.467429 [info ] [MainThread]: Running with dbt=1.4.5
[0m08:07:34.470499 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:07:34.472088 [debug] [MainThread]: Tracking: tracking
[0m08:07:34.476055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa252b1c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25277f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2527d4850>]}
[0m08:07:34.490927 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m08:07:34.541909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:07:34.543616 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/selected_rows.sql
[0m08:07:34.561769 [debug] [MainThread]: 1699: static parser successfully parsed example/selected_rows.sql
[0m08:07:34.586848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b39873a2-2550-4492-8f77-57e1cb234f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa252c92410>]}
[0m08:07:34.600434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b39873a2-2550-4492-8f77-57e1cb234f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa252854e10>]}
[0m08:07:34.601210 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:07:34.602442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b39873a2-2550-4492-8f77-57e1cb234f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25101bd10>]}
[0m08:07:34.604433 [info ] [MainThread]: 
[0m08:07:34.607554 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:07:34.610671 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m08:07:34.622202 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m08:07:34.622923 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m08:07:34.623527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:07:34.637482 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m08:07:34.639737 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m08:07:34.642692 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m08:07:34.650397 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m08:07:34.651178 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m08:07:34.651968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:07:34.660970 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m08:07:34.662199 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m08:07:34.662773 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m08:07:34.669265 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m08:07:34.671444 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m08:07:34.672425 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m08:07:34.680049 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:34.681064 [debug] [MainThread]: On master: BEGIN
[0m08:07:34.681805 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:07:34.691624 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:07:34.692601 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:34.693207 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:07:34.708461 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m08:07:34.711126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b39873a2-2550-4492-8f77-57e1cb234f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2527967d0>]}
[0m08:07:34.712643 [debug] [MainThread]: On master: ROLLBACK
[0m08:07:34.714036 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:34.715139 [debug] [MainThread]: On master: BEGIN
[0m08:07:34.717724 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:07:34.719663 [debug] [MainThread]: On master: COMMIT
[0m08:07:34.721162 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:34.722473 [debug] [MainThread]: On master: COMMIT
[0m08:07:34.724218 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m08:07:34.725974 [debug] [MainThread]: On master: Close
[0m08:07:34.728083 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:07:34.730473 [info ] [MainThread]: 
[0m08:07:34.752708 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m08:07:34.753164 [debug] [Thread-2 (]: Began running node model.my_dbt_project.selected_rows
[0m08:07:34.754416 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m08:07:34.755559 [info ] [Thread-2 (]: 2 of 3 START sql view model public.selected_rows ............................... [RUN]
[0m08:07:34.758080 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m08:07:34.759584 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.selected_rows'
[0m08:07:34.761000 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m08:07:34.762452 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.selected_rows
[0m08:07:34.769860 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m08:07:34.773890 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.selected_rows"
[0m08:07:34.779482 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-29 08:07:34.763957 => 2023-07-29 08:07:34.779373
[0m08:07:34.779739 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.selected_rows (compile): 2023-07-29 08:07:34.770805 => 2023-07-29 08:07:34.779678
[0m08:07:34.780427 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m08:07:34.781209 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.selected_rows
[0m08:07:34.857540 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.selected_rows"
[0m08:07:34.861038 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m08:07:34.865666 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m08:07:34.866166 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:07:34.866471 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: BEGIN
[0m08:07:34.867093 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m08:07:34.867526 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:07:34.868023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:07:34.877524 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m08:07:34.878173 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m08:07:34.878715 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m08:07:34.879955 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:07:34.880888 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.selected_rows"} */

  create view "worldbank_api_db"."public"."selected_rows__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with 

data_since_2000 as (

    select *
    from worldbank_api
    WHERE worldbank_api_date >= 2000

),

selected_columns as (

    select
    json_value(worldbank_api_indicator, "$.value") as gdp,
    worldbank_api_date as date
)

select *
from selected_columns

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m08:07:34.881850 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m08:07:34.885413 [debug] [Thread-2 (]: Postgres adapter: Postgres error: operator does not exist: character varying >= integer
LINE 20:     WHERE worldbank_api_date >= 2000
                                      ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m08:07:34.886257 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m08:07:34.886647 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: ROLLBACK
[0m08:07:34.893812 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:07:34.895144 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.selected_rows (execute): 2023-07-29 08:07:34.798480 => 2023-07-29 08:07:34.895055
[0m08:07:34.895486 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:07:34.896387 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: Close
[0m08:07:34.899116 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:07:34.902577 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:07:34.903500 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:07:34.905096 [debug] [Thread-2 (]: Database Error in model selected_rows (models/example/selected_rows.sql)
  operator does not exist: character varying >= integer
  LINE 20:     WHERE worldbank_api_date >= 2000
                                        ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/my_dbt_project/models/example/selected_rows.sql
[0m08:07:34.906015 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b39873a2-2550-4492-8f77-57e1cb234f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa250f8d990>]}
[0m08:07:34.906242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:07:34.907020 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model public.selected_rows ...................... [[31mERROR[0m in 0.15s]
[0m08:07:34.931617 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.selected_rows
[0m08:07:34.938425 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m08:07:34.940534 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:07:34.941538 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m08:07:34.944512 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m08:07:34.950745 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:07:34.951784 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m08:07:34.956706 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m08:07:34.958798 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-29 08:07:34.782101 => 2023-07-29 08:07:34.958738
[0m08:07:34.959489 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m08:07:34.960699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b39873a2-2550-4492-8f77-57e1cb234f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa252fb2250>]}
[0m08:07:34.961673 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.20s]
[0m08:07:34.962589 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m08:07:34.964418 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m08:07:34.965198 [info ] [Thread-4 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m08:07:34.966734 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m08:07:34.967363 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m08:07:34.970491 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m08:07:34.972452 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-29 08:07:34.967872 => 2023-07-29 08:07:34.972374
[0m08:07:34.973031 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m08:07:34.977660 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m08:07:34.979519 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:07:34.979972 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m08:07:34.980559 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:07:34.990083 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m08:07:34.990777 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:07:34.991203 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m08:07:34.994877 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m08:07:34.997980 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:07:34.998500 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:07:34.999816 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:07:35.001681 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m08:07:35.002095 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:07:35.002696 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m08:07:35.004259 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m08:07:35.006813 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:07:35.007539 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m08:07:35.008507 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m08:07:35.010139 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-29 08:07:34.973515 => 2023-07-29 08:07:35.010083
[0m08:07:35.010710 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m08:07:35.011729 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b39873a2-2550-4492-8f77-57e1cb234f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa250f59f50>]}
[0m08:07:35.012601 [info ] [Thread-4 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.05s]
[0m08:07:35.013713 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m08:07:35.017372 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:07:35.018004 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:35.018498 [debug] [MainThread]: On master: BEGIN
[0m08:07:35.018962 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:07:35.027974 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:07:35.029080 [debug] [MainThread]: On master: COMMIT
[0m08:07:35.029801 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:35.030456 [debug] [MainThread]: On master: COMMIT
[0m08:07:35.031225 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m08:07:35.031840 [debug] [MainThread]: On master: Close
[0m08:07:35.032752 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:07:35.033672 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m08:07:35.034568 [debug] [MainThread]: Connection 'model.my_dbt_project.selected_rows' was properly closed.
[0m08:07:35.035019 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m08:07:35.035621 [info ] [MainThread]: 
[0m08:07:35.036533 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m08:07:35.037812 [debug] [MainThread]: Command end result
[0m08:07:35.048859 [info ] [MainThread]: 
[0m08:07:35.049977 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:07:35.051023 [info ] [MainThread]: 
[0m08:07:35.052492 [error] [MainThread]: [33mDatabase Error in model selected_rows (models/example/selected_rows.sql)[0m
[0m08:07:35.053520 [error] [MainThread]:   operator does not exist: character varying >= integer
[0m08:07:35.054570 [error] [MainThread]:   LINE 20:     WHERE worldbank_api_date >= 2000
[0m08:07:35.055672 [error] [MainThread]:                                         ^
[0m08:07:35.057134 [error] [MainThread]:   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
[0m08:07:35.058612 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/selected_rows.sql
[0m08:07:35.059927 [info ] [MainThread]: 
[0m08:07:35.061813 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:07:35.063475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25063f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25063f8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25063c6d0>]}
[0m08:07:35.064796 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 08:07:56.608730 | ae207fd8-caed-443a-b8d5-1179230857bc ==============================
[0m08:07:56.608730 [info ] [MainThread]: Running with dbt=1.4.5
[0m08:07:56.611349 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:07:56.612287 [debug] [MainThread]: Tracking: tracking
[0m08:07:56.614674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febceeaf450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febce69af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febceb9c5d0>]}
[0m08:07:56.628900 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m08:07:56.673548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:07:56.674792 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/selected_rows.sql
[0m08:07:56.691735 [debug] [MainThread]: 1699: static parser successfully parsed example/selected_rows.sql
[0m08:07:56.716241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae207fd8-caed-443a-b8d5-1179230857bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febceeafc50>]}
[0m08:07:56.730322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae207fd8-caed-443a-b8d5-1179230857bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febcebd5a90>]}
[0m08:07:56.731533 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:07:56.732957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae207fd8-caed-443a-b8d5-1179230857bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febceebf850>]}
[0m08:07:56.736282 [info ] [MainThread]: 
[0m08:07:56.740858 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:07:56.743852 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m08:07:56.760483 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m08:07:56.761449 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m08:07:56.762362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:07:56.775752 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m08:07:56.777689 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m08:07:56.780098 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m08:07:56.786997 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m08:07:56.787917 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m08:07:56.788664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:07:56.797585 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m08:07:56.798653 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m08:07:56.799309 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m08:07:56.806053 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m08:07:56.807963 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m08:07:56.808715 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m08:07:56.816026 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:56.816967 [debug] [MainThread]: On master: BEGIN
[0m08:07:56.817815 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:07:56.827434 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:07:56.828280 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:56.828814 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:07:56.842241 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m08:07:56.844694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae207fd8-caed-443a-b8d5-1179230857bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febce5b4dd0>]}
[0m08:07:56.846066 [debug] [MainThread]: On master: ROLLBACK
[0m08:07:56.847517 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:56.848335 [debug] [MainThread]: On master: BEGIN
[0m08:07:56.849871 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:07:56.850916 [debug] [MainThread]: On master: COMMIT
[0m08:07:56.851573 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:56.852147 [debug] [MainThread]: On master: COMMIT
[0m08:07:56.852986 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m08:07:56.853647 [debug] [MainThread]: On master: Close
[0m08:07:56.854782 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:07:56.855928 [info ] [MainThread]: 
[0m08:07:56.877181 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m08:07:56.877733 [debug] [Thread-2 (]: Began running node model.my_dbt_project.selected_rows
[0m08:07:56.878717 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m08:07:56.880433 [info ] [Thread-2 (]: 2 of 3 START sql view model public.selected_rows ............................... [RUN]
[0m08:07:56.881905 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m08:07:56.883288 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.selected_rows'
[0m08:07:56.884231 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m08:07:56.884898 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.selected_rows
[0m08:07:56.888863 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m08:07:56.892174 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.selected_rows"
[0m08:07:56.895239 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-29 08:07:56.885539 => 2023-07-29 08:07:56.895056
[0m08:07:56.895670 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.selected_rows (compile): 2023-07-29 08:07:56.889779 => 2023-07-29 08:07:56.895609
[0m08:07:56.895931 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m08:07:56.896596 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.selected_rows
[0m08:07:56.994922 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m08:07:56.996504 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.selected_rows"
[0m08:07:57.001031 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m08:07:57.001671 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:07:57.002527 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: BEGIN
[0m08:07:57.003581 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m08:07:57.004566 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:07:57.005593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:07:57.022675 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m08:07:57.023917 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m08:07:57.024284 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m08:07:57.025444 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.selected_rows"} */

  create view "worldbank_api_db"."public"."selected_rows__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with 

data_since_2000 as (

    select *
    from worldbank_api
    WHERE worldbank_api_date => 2000

),

selected_columns as (

    select
    json_value(worldbank_api_indicator, "$.value") as gdp,
    worldbank_api_date as date
)

select *
from selected_columns

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m08:07:57.026027 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:07:57.027494 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "=>"
LINE 20:     WHERE worldbank_api_date => 2000
                                      ^

[0m08:07:57.028142 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m08:07:57.028853 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: ROLLBACK
[0m08:07:57.030571 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.selected_rows (execute): 2023-07-29 08:07:56.919379 => 2023-07-29 08:07:57.030467
[0m08:07:57.031266 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: Close
[0m08:07:57.034142 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m08:07:57.042210 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:07:57.043241 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:07:57.044561 [debug] [Thread-2 (]: Database Error in model selected_rows (models/example/selected_rows.sql)
  syntax error at or near "=>"
  LINE 20:     WHERE worldbank_api_date => 2000
                                        ^
  compiled Code at target/run/my_dbt_project/models/example/selected_rows.sql
[0m08:07:57.045921 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae207fd8-caed-443a-b8d5-1179230857bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febced4de50>]}
[0m08:07:57.046169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:07:57.047081 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model public.selected_rows ...................... [[31mERROR[0m in 0.16s]
[0m08:07:57.050460 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:07:57.052817 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.selected_rows
[0m08:07:57.053509 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:07:57.055242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:07:57.081549 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m08:07:57.082516 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:07:57.083298 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m08:07:57.085012 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m08:07:57.091094 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:07:57.091832 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m08:07:57.097332 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m08:07:57.099674 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-29 08:07:56.897147 => 2023-07-29 08:07:57.099612
[0m08:07:57.100300 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m08:07:57.101689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae207fd8-caed-443a-b8d5-1179230857bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febcea80790>]}
[0m08:07:57.102800 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.22s]
[0m08:07:57.103963 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m08:07:57.105755 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m08:07:57.106611 [info ] [Thread-4 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m08:07:57.107797 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m08:07:57.108463 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m08:07:57.111592 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m08:07:57.113572 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-29 08:07:57.109011 => 2023-07-29 08:07:57.113479
[0m08:07:57.114147 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m08:07:57.118757 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m08:07:57.120559 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:07:57.121044 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m08:07:57.121539 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:07:57.131054 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m08:07:57.131894 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:07:57.132589 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m08:07:57.136569 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m08:07:57.140142 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:07:57.140958 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:07:57.142532 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:07:57.144977 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m08:07:57.145583 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:07:57.146330 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m08:07:57.147938 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m08:07:57.150677 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:07:57.151356 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m08:07:57.152326 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m08:07:57.153887 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-29 08:07:57.114700 => 2023-07-29 08:07:57.153830
[0m08:07:57.154490 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m08:07:57.155564 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae207fd8-caed-443a-b8d5-1179230857bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febccd701d0>]}
[0m08:07:57.156218 [info ] [Thread-4 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.05s]
[0m08:07:57.157214 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m08:07:57.160139 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:07:57.160791 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:57.161336 [debug] [MainThread]: On master: BEGIN
[0m08:07:57.161850 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:07:57.171005 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:07:57.172096 [debug] [MainThread]: On master: COMMIT
[0m08:07:57.172763 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:57.173388 [debug] [MainThread]: On master: COMMIT
[0m08:07:57.174494 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m08:07:57.175445 [debug] [MainThread]: On master: Close
[0m08:07:57.176508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:07:57.177122 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m08:07:57.177666 [debug] [MainThread]: Connection 'model.my_dbt_project.selected_rows' was properly closed.
[0m08:07:57.178140 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m08:07:57.178734 [info ] [MainThread]: 
[0m08:07:57.179632 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m08:07:57.180873 [debug] [MainThread]: Command end result
[0m08:07:57.193506 [info ] [MainThread]: 
[0m08:07:57.194588 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:07:57.195734 [info ] [MainThread]: 
[0m08:07:57.196804 [error] [MainThread]: [33mDatabase Error in model selected_rows (models/example/selected_rows.sql)[0m
[0m08:07:57.197999 [error] [MainThread]:   syntax error at or near "=>"
[0m08:07:57.199224 [error] [MainThread]:   LINE 20:     WHERE worldbank_api_date => 2000
[0m08:07:57.200485 [error] [MainThread]:                                         ^
[0m08:07:57.202017 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/selected_rows.sql
[0m08:07:57.203105 [info ] [MainThread]: 
[0m08:07:57.204258 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:07:57.205854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febcc661f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febcc661890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febcc661110>]}
[0m08:07:57.206819 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 08:10:35.556469 | 939afeab-fb65-4891-9b7f-8540da7792ac ==============================
[0m08:10:35.556469 [info ] [MainThread]: Running with dbt=1.4.5
[0m08:10:35.559206 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:10:35.560316 [debug] [MainThread]: Tracking: tracking
[0m08:10:35.563821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48fd68eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48fde57790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48fde40e90>]}
[0m08:10:35.577860 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m08:10:35.620830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:10:35.622372 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:10:35.631585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '939afeab-fb65-4891-9b7f-8540da7792ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48fbfe8d50>]}
[0m08:10:35.653265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '939afeab-fb65-4891-9b7f-8540da7792ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48fde54290>]}
[0m08:10:35.654891 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:10:35.656344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '939afeab-fb65-4891-9b7f-8540da7792ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48fbf267d0>]}
[0m08:10:35.660337 [info ] [MainThread]: 
[0m08:10:35.665488 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:10:35.673293 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m08:10:35.687736 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m08:10:35.688625 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m08:10:35.689447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:10:35.706374 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m08:10:35.708931 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m08:10:35.712000 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m08:10:35.718480 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m08:10:35.719019 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m08:10:35.719428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:10:35.728692 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m08:10:35.730104 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m08:10:35.731977 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m08:10:35.739135 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m08:10:35.741378 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m08:10:35.742579 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m08:10:35.750180 [debug] [MainThread]: Using postgres connection "master"
[0m08:10:35.751298 [debug] [MainThread]: On master: BEGIN
[0m08:10:35.752030 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:10:35.762443 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:10:35.763600 [debug] [MainThread]: Using postgres connection "master"
[0m08:10:35.764445 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:10:35.778793 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m08:10:35.781442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '939afeab-fb65-4891-9b7f-8540da7792ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48fdb3ee50>]}
[0m08:10:35.782906 [debug] [MainThread]: On master: ROLLBACK
[0m08:10:35.784508 [debug] [MainThread]: Using postgres connection "master"
[0m08:10:35.785510 [debug] [MainThread]: On master: BEGIN
[0m08:10:35.787520 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:10:35.789779 [debug] [MainThread]: On master: COMMIT
[0m08:10:35.790923 [debug] [MainThread]: Using postgres connection "master"
[0m08:10:35.792288 [debug] [MainThread]: On master: COMMIT
[0m08:10:35.793835 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m08:10:35.794647 [debug] [MainThread]: On master: Close
[0m08:10:35.796158 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:10:35.797889 [info ] [MainThread]: 
[0m08:10:35.825721 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m08:10:35.826349 [debug] [Thread-2 (]: Began running node model.my_dbt_project.selected_rows
[0m08:10:35.827925 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m08:10:35.829417 [info ] [Thread-2 (]: 2 of 3 START sql view model public.selected_rows ............................... [RUN]
[0m08:10:35.831373 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m08:10:35.833000 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.selected_rows'
[0m08:10:35.834355 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m08:10:35.835314 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.selected_rows
[0m08:10:35.839044 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m08:10:35.843163 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.selected_rows"
[0m08:10:35.846753 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-29 08:10:35.835915 => 2023-07-29 08:10:35.846637
[0m08:10:35.847379 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.selected_rows (compile): 2023-07-29 08:10:35.839936 => 2023-07-29 08:10:35.847303
[0m08:10:35.847648 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m08:10:35.848438 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.selected_rows
[0m08:10:35.930373 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.selected_rows"
[0m08:10:35.934907 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m08:10:35.937958 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:10:35.938609 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m08:10:35.939020 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m08:10:35.939729 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: BEGIN
[0m08:10:35.940542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:10:35.941196 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:10:35.953236 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m08:10:35.953672 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m08:10:35.954569 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:10:35.955322 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m08:10:35.956067 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m08:10:35.956753 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.selected_rows"} */

  create view "worldbank_api_db"."public"."selected_rows__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with 

data_since_2000 as (

    select *
    from worldbank_api
    WHERE worldbank_api_date => 2000

),

selected_columns as (

    select
    json_value(worldbank_api_indicator, "$.value") as gdp,
    worldbank_api_date as date
)

select *
from selected_columns

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m08:10:35.958851 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "=>"
LINE 20:     WHERE worldbank_api_date => 2000
                                      ^

[0m08:10:35.959801 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: ROLLBACK
[0m08:10:35.960824 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.selected_rows (execute): 2023-07-29 08:10:35.871272 => 2023-07-29 08:10:35.960737
[0m08:10:35.961333 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m08:10:35.961577 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: Close
[0m08:10:35.968522 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:10:35.972985 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:10:35.975330 [debug] [Thread-2 (]: Database Error in model selected_rows (models/example/selected_rows.sql)
  syntax error at or near "=>"
  LINE 20:     WHERE worldbank_api_date => 2000
                                        ^
  compiled Code at target/run/my_dbt_project/models/example/selected_rows.sql
[0m08:10:35.976439 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '939afeab-fb65-4891-9b7f-8540da7792ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48fbe93550>]}
[0m08:10:35.976712 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:10:35.977612 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model public.selected_rows ...................... [[31mERROR[0m in 0.14s]
[0m08:10:35.981998 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:10:35.984429 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.selected_rows
[0m08:10:35.985028 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:10:35.986952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:10:36.013457 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m08:10:36.014596 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:10:36.015346 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m08:10:36.017359 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m08:10:36.023619 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:10:36.024798 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m08:10:36.029855 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m08:10:36.032096 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-29 08:10:35.848855 => 2023-07-29 08:10:36.032003
[0m08:10:36.032907 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m08:10:36.034012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '939afeab-fb65-4891-9b7f-8540da7792ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48fbe583d0>]}
[0m08:10:36.034980 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.20s]
[0m08:10:36.036354 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m08:10:36.038106 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m08:10:36.038867 [info ] [Thread-4 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m08:10:36.040487 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m08:10:36.041181 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m08:10:36.043994 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m08:10:36.045819 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-29 08:10:36.041682 => 2023-07-29 08:10:36.045744
[0m08:10:36.046383 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m08:10:36.050994 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m08:10:36.052883 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:10:36.053391 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m08:10:36.053857 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:10:36.063477 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m08:10:36.064363 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:10:36.064877 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m08:10:36.068619 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m08:10:36.072185 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:10:36.072913 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:10:36.074258 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:10:36.076311 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m08:10:36.077070 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:10:36.077858 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m08:10:36.079327 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m08:10:36.081853 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:10:36.082429 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m08:10:36.083332 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m08:10:36.084864 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-29 08:10:36.046886 => 2023-07-29 08:10:36.084807
[0m08:10:36.085462 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m08:10:36.086595 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '939afeab-fb65-4891-9b7f-8540da7792ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48fbeae410>]}
[0m08:10:36.087546 [info ] [Thread-4 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.05s]
[0m08:10:36.088522 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m08:10:36.092081 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:10:36.092770 [debug] [MainThread]: Using postgres connection "master"
[0m08:10:36.093364 [debug] [MainThread]: On master: BEGIN
[0m08:10:36.093858 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:10:36.102904 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:10:36.103903 [debug] [MainThread]: On master: COMMIT
[0m08:10:36.104478 [debug] [MainThread]: Using postgres connection "master"
[0m08:10:36.104861 [debug] [MainThread]: On master: COMMIT
[0m08:10:36.105594 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m08:10:36.105968 [debug] [MainThread]: On master: Close
[0m08:10:36.106819 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:10:36.107593 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m08:10:36.108110 [debug] [MainThread]: Connection 'model.my_dbt_project.selected_rows' was properly closed.
[0m08:10:36.108676 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m08:10:36.109083 [info ] [MainThread]: 
[0m08:10:36.109644 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m08:10:36.110641 [debug] [MainThread]: Command end result
[0m08:10:36.118954 [info ] [MainThread]: 
[0m08:10:36.119565 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:10:36.120572 [info ] [MainThread]: 
[0m08:10:36.121425 [error] [MainThread]: [33mDatabase Error in model selected_rows (models/example/selected_rows.sql)[0m
[0m08:10:36.122381 [error] [MainThread]:   syntax error at or near "=>"
[0m08:10:36.123374 [error] [MainThread]:   LINE 20:     WHERE worldbank_api_date => 2000
[0m08:10:36.124362 [error] [MainThread]:                                         ^
[0m08:10:36.125198 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/selected_rows.sql
[0m08:10:36.126246 [info ] [MainThread]: 
[0m08:10:36.127026 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:10:36.128073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490151a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48fbfcd110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48fbfe8a50>]}
[0m08:10:36.129462 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 08:11:58.157492 | 71628341-af11-4ca6-a257-5b5fbb36e675 ==============================
[0m08:11:58.157492 [info ] [MainThread]: Running with dbt=1.4.5
[0m08:11:58.160636 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:11:58.161923 [debug] [MainThread]: Tracking: tracking
[0m08:11:58.165212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a248c0d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2279d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a248070d0>]}
[0m08:11:58.179269 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m08:11:58.225354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:11:58.226688 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/selected_rows.sql
[0m08:11:58.242964 [debug] [MainThread]: 1699: static parser successfully parsed example/selected_rows.sql
[0m08:11:58.271972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71628341-af11-4ca6-a257-5b5fbb36e675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2450d810>]}
[0m08:11:58.286548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71628341-af11-4ca6-a257-5b5fbb36e675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a226ff050>]}
[0m08:11:58.287745 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:11:58.288998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71628341-af11-4ca6-a257-5b5fbb36e675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a227dc850>]}
[0m08:11:58.291143 [info ] [MainThread]: 
[0m08:11:58.294841 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:11:58.296958 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m08:11:58.309413 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m08:11:58.310485 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m08:11:58.311431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:11:58.324104 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m08:11:58.326211 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m08:11:58.328791 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m08:11:58.335130 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m08:11:58.335711 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m08:11:58.336081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:58.345909 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m08:11:58.347070 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m08:11:58.347825 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m08:11:58.354285 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m08:11:58.356289 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m08:11:58.357349 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m08:11:58.365130 [debug] [MainThread]: Using postgres connection "master"
[0m08:11:58.366063 [debug] [MainThread]: On master: BEGIN
[0m08:11:58.366780 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:11:58.378423 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:11:58.379515 [debug] [MainThread]: Using postgres connection "master"
[0m08:11:58.380193 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:11:58.394190 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m08:11:58.396687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71628341-af11-4ca6-a257-5b5fbb36e675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2450cb90>]}
[0m08:11:58.397821 [debug] [MainThread]: On master: ROLLBACK
[0m08:11:58.399012 [debug] [MainThread]: Using postgres connection "master"
[0m08:11:58.399744 [debug] [MainThread]: On master: BEGIN
[0m08:11:58.401007 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:11:58.402319 [debug] [MainThread]: On master: COMMIT
[0m08:11:58.403078 [debug] [MainThread]: Using postgres connection "master"
[0m08:11:58.403975 [debug] [MainThread]: On master: COMMIT
[0m08:11:58.404907 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m08:11:58.405615 [debug] [MainThread]: On master: Close
[0m08:11:58.407103 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:11:58.408494 [info ] [MainThread]: 
[0m08:11:58.432416 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m08:11:58.432884 [debug] [Thread-2 (]: Began running node model.my_dbt_project.selected_rows
[0m08:11:58.434393 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m08:11:58.435659 [info ] [Thread-2 (]: 2 of 3 START sql view model public.selected_rows ............................... [RUN]
[0m08:11:58.437716 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m08:11:58.438770 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.selected_rows'
[0m08:11:58.439640 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m08:11:58.440295 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.selected_rows
[0m08:11:58.444595 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m08:11:58.449846 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.selected_rows"
[0m08:11:58.453433 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.selected_rows (compile): 2023-07-29 08:11:58.445346 => 2023-07-29 08:11:58.453320
[0m08:11:58.453718 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-29 08:11:58.440945 => 2023-07-29 08:11:58.453650
[0m08:11:58.454232 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.selected_rows
[0m08:11:58.454879 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m08:11:58.544620 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.selected_rows"
[0m08:11:58.557377 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m08:11:58.560057 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m08:11:58.560936 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:11:58.561380 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: BEGIN
[0m08:11:58.562937 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m08:11:58.564323 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:11:58.565396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:58.578418 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m08:11:58.580324 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m08:11:58.580990 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m08:11:58.582108 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.selected_rows"} */

  create view "worldbank_api_db"."public"."selected_rows__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with 

data_since_2000 as (

    select *
    from worldbank_api
    --WHERE worldbank_api_date => 2000

),

selected_columns as (

    select
    json_value(worldbank_api_indicator, "$.value") as gdp,
    worldbank_api_date as date
)

select *
from selected_columns

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m08:11:58.583332 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:11:58.584880 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m08:11:58.585699 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "worldbank_api_indicator" does not exist
LINE 27:     json_value(worldbank_api_indicator, "$.value") as gdp,
                        ^

[0m08:11:58.587578 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: ROLLBACK
[0m08:11:58.588911 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.selected_rows (execute): 2023-07-29 08:11:58.455336 => 2023-07-29 08:11:58.588787
[0m08:11:58.589852 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: Close
[0m08:11:58.592935 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m08:11:58.604909 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:11:58.606686 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:11:58.609453 [debug] [Thread-2 (]: Database Error in model selected_rows (models/example/selected_rows.sql)
  column "worldbank_api_indicator" does not exist
  LINE 27:     json_value(worldbank_api_indicator, "$.value") as gdp,
                          ^
  compiled Code at target/run/my_dbt_project/models/example/selected_rows.sql
[0m08:11:58.613097 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:11:58.614330 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71628341-af11-4ca6-a257-5b5fbb36e675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a227b3bd0>]}
[0m08:11:58.628408 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:11:58.630466 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model public.selected_rows ...................... [[31mERROR[0m in 0.18s]
[0m08:11:58.631861 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:11:58.635091 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.selected_rows
[0m08:11:58.637845 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:11:58.685619 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m08:11:58.686901 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:11:58.687711 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m08:11:58.690280 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m08:11:58.697707 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:11:58.699098 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m08:11:58.706331 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m08:11:58.708783 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-29 08:11:58.472224 => 2023-07-29 08:11:58.708677
[0m08:11:58.709790 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m08:11:58.711110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71628341-af11-4ca6-a257-5b5fbb36e675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2273d550>]}
[0m08:11:58.712120 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.27s]
[0m08:11:58.713482 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m08:11:58.715772 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m08:11:58.716901 [info ] [Thread-4 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m08:11:58.718597 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m08:11:58.719518 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m08:11:58.723245 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m08:11:58.725447 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-29 08:11:58.720077 => 2023-07-29 08:11:58.725307
[0m08:11:58.726298 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m08:11:58.731209 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m08:11:58.733078 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:11:58.733640 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m08:11:58.734122 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:11:58.744259 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m08:11:58.745293 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:11:58.745790 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m08:11:58.749744 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m08:11:58.753155 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:11:58.754019 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:11:58.755370 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:11:58.757139 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m08:11:58.757643 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:11:58.758226 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m08:11:58.759758 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m08:11:58.762057 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:11:58.762611 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m08:11:58.763685 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m08:11:58.765532 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-29 08:11:58.726934 => 2023-07-29 08:11:58.765472
[0m08:11:58.766106 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m08:11:58.767140 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71628341-af11-4ca6-a257-5b5fbb36e675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2270e590>]}
[0m08:11:58.767856 [info ] [Thread-4 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.05s]
[0m08:11:58.768795 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m08:11:58.771779 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:11:58.772417 [debug] [MainThread]: Using postgres connection "master"
[0m08:11:58.772952 [debug] [MainThread]: On master: BEGIN
[0m08:11:58.773505 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:11:58.784254 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:11:58.785665 [debug] [MainThread]: On master: COMMIT
[0m08:11:58.786899 [debug] [MainThread]: Using postgres connection "master"
[0m08:11:58.788041 [debug] [MainThread]: On master: COMMIT
[0m08:11:58.789404 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m08:11:58.790303 [debug] [MainThread]: On master: Close
[0m08:11:58.791900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:11:58.792807 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m08:11:58.793692 [debug] [MainThread]: Connection 'model.my_dbt_project.selected_rows' was properly closed.
[0m08:11:58.794894 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m08:11:58.796123 [info ] [MainThread]: 
[0m08:11:58.798150 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m08:11:58.799853 [debug] [MainThread]: Command end result
[0m08:11:58.816047 [info ] [MainThread]: 
[0m08:11:58.817378 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:11:58.819066 [info ] [MainThread]: 
[0m08:11:58.820477 [error] [MainThread]: [33mDatabase Error in model selected_rows (models/example/selected_rows.sql)[0m
[0m08:11:58.821900 [error] [MainThread]:   column "worldbank_api_indicator" does not exist
[0m08:11:58.823068 [error] [MainThread]:   LINE 27:     json_value(worldbank_api_indicator, "$.value") as gdp,
[0m08:11:58.824484 [error] [MainThread]:                           ^
[0m08:11:58.825954 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/selected_rows.sql
[0m08:11:58.827312 [info ] [MainThread]: 
[0m08:11:58.828559 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:11:58.830108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2445e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a23f2e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a24e6a710>]}
[0m08:11:58.831470 [debug] [MainThread]: Flushing usage events
[0m08:12:04.788478 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2023-07-29 08:16:56.902577 | a67b1e40-da4e-46ee-9c87-14cea6d77a33 ==============================
[0m08:16:56.902577 [info ] [MainThread]: Running with dbt=1.4.5
[0m08:16:56.905458 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:16:56.906812 [debug] [MainThread]: Tracking: tracking
[0m08:16:56.910165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2181e000d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2181dc76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21822c6a10>]}
[0m08:16:56.924716 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m08:16:56.974482 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:16:56.975682 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/selected_rows.sql
[0m08:16:56.991814 [debug] [MainThread]: 1699: static parser successfully parsed example/selected_rows.sql
[0m08:16:57.017176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a67b1e40-da4e-46ee-9c87-14cea6d77a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2181da1790>]}
[0m08:16:57.029998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a67b1e40-da4e-46ee-9c87-14cea6d77a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2182280d90>]}
[0m08:16:57.030738 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:16:57.031700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a67b1e40-da4e-46ee-9c87-14cea6d77a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2181e78710>]}
[0m08:16:57.033682 [info ] [MainThread]: 
[0m08:16:57.036314 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:16:57.039246 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m08:16:57.051035 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m08:16:57.052094 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m08:16:57.052993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:16:57.066111 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m08:16:57.068702 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m08:16:57.071989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m08:16:57.078934 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m08:16:57.079867 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m08:16:57.080617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:16:57.091887 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m08:16:57.093488 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m08:16:57.094455 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m08:16:57.101346 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m08:16:57.103377 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m08:16:57.104340 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m08:16:57.114834 [debug] [MainThread]: Using postgres connection "master"
[0m08:16:57.116321 [debug] [MainThread]: On master: BEGIN
[0m08:16:57.118148 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:16:57.133637 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:16:57.135208 [debug] [MainThread]: Using postgres connection "master"
[0m08:16:57.135803 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:16:57.155225 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m08:16:57.158673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a67b1e40-da4e-46ee-9c87-14cea6d77a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2180705450>]}
[0m08:16:57.159898 [debug] [MainThread]: On master: ROLLBACK
[0m08:16:57.161441 [debug] [MainThread]: Using postgres connection "master"
[0m08:16:57.162859 [debug] [MainThread]: On master: BEGIN
[0m08:16:57.164408 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:16:57.165791 [debug] [MainThread]: On master: COMMIT
[0m08:16:57.166669 [debug] [MainThread]: Using postgres connection "master"
[0m08:16:57.167599 [debug] [MainThread]: On master: COMMIT
[0m08:16:57.168646 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m08:16:57.169406 [debug] [MainThread]: On master: Close
[0m08:16:57.170689 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:16:57.171989 [info ] [MainThread]: 
[0m08:16:57.193925 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m08:16:57.194574 [debug] [Thread-2 (]: Began running node model.my_dbt_project.selected_rows
[0m08:16:57.195860 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m08:16:57.197383 [info ] [Thread-2 (]: 2 of 3 START sql view model public.selected_rows ............................... [RUN]
[0m08:16:57.199504 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m08:16:57.200907 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.selected_rows'
[0m08:16:57.201722 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m08:16:57.202667 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.selected_rows
[0m08:16:57.206484 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m08:16:57.209887 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.selected_rows"
[0m08:16:57.213531 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-29 08:16:57.203223 => 2023-07-29 08:16:57.213407
[0m08:16:57.213863 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.selected_rows (compile): 2023-07-29 08:16:57.207349 => 2023-07-29 08:16:57.213804
[0m08:16:57.214999 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m08:16:57.216224 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.selected_rows
[0m08:16:57.291121 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.selected_rows"
[0m08:16:57.295715 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m08:16:57.299585 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m08:16:57.300240 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:16:57.300473 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: BEGIN
[0m08:16:57.301160 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m08:16:57.301606 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:16:57.302286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:16:57.314483 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m08:16:57.314865 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m08:16:57.315899 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:16:57.316934 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m08:16:57.317886 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m08:16:57.318736 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.selected_rows"} */

  create view "worldbank_api_db"."public"."selected_rows__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with 

data_since_2000 as (

    select *
    from worldbank_api
    --WHERE worldbank_api_date => 2000

),

selected_columns as (

    select
        json_value(worldbank_api_indicator, "$.value") as gdp,
        worldbank_api_date as date
    from data_since_2000
)

select *
from selected_columns

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m08:16:57.321946 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "$.value" does not exist
LINE 27:         json_value(worldbank_api_indicator, "$.value") as gd...
                                                     ^

[0m08:16:57.322979 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m08:16:57.323320 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: ROLLBACK
[0m08:16:57.331321 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:16:57.332679 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.selected_rows (execute): 2023-07-29 08:16:57.233713 => 2023-07-29 08:16:57.332594
[0m08:16:57.332949 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:16:57.333895 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: Close
[0m08:16:57.337291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:16:57.340726 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:16:57.341474 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:16:57.342684 [debug] [Thread-2 (]: Database Error in model selected_rows (models/example/selected_rows.sql)
  column "$.value" does not exist
  LINE 27:         json_value(worldbank_api_indicator, "$.value") as gd...
                                                       ^
  compiled Code at target/run/my_dbt_project/models/example/selected_rows.sql
[0m08:16:57.343837 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:16:57.344396 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a67b1e40-da4e-46ee-9c87-14cea6d77a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f217bd55fd0>]}
[0m08:16:57.370772 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m08:16:57.371359 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model public.selected_rows ...................... [[31mERROR[0m in 0.14s]
[0m08:16:57.372565 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:16:57.374935 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.selected_rows
[0m08:16:57.375911 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m08:16:57.379157 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m08:16:57.385006 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m08:16:57.385790 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m08:16:57.390831 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m08:16:57.392736 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-29 08:16:57.217016 => 2023-07-29 08:16:57.392677
[0m08:16:57.393461 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m08:16:57.394727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a67b1e40-da4e-46ee-9c87-14cea6d77a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f217bd55d50>]}
[0m08:16:57.395529 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.20s]
[0m08:16:57.396536 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m08:16:57.397845 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m08:16:57.398561 [info ] [Thread-4 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m08:16:57.399961 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m08:16:57.400747 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m08:16:57.403907 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m08:16:57.405867 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-29 08:16:57.401387 => 2023-07-29 08:16:57.405797
[0m08:16:57.406483 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m08:16:57.411204 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m08:16:57.414796 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:16:57.415718 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m08:16:57.417433 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:16:57.427530 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m08:16:57.428454 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:16:57.429239 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m08:16:57.433907 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m08:16:57.437525 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:16:57.439017 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:16:57.440679 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:16:57.442795 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m08:16:57.443459 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:16:57.444111 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m08:16:57.445780 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m08:16:57.448612 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m08:16:57.449326 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m08:16:57.450257 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m08:16:57.451900 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-29 08:16:57.406954 => 2023-07-29 08:16:57.451843
[0m08:16:57.452674 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m08:16:57.453776 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a67b1e40-da4e-46ee-9c87-14cea6d77a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21806e05d0>]}
[0m08:16:57.454527 [info ] [Thread-4 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.05s]
[0m08:16:57.455620 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m08:16:57.458812 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:16:57.459469 [debug] [MainThread]: Using postgres connection "master"
[0m08:16:57.460054 [debug] [MainThread]: On master: BEGIN
[0m08:16:57.460547 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:16:57.469928 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:16:57.471246 [debug] [MainThread]: On master: COMMIT
[0m08:16:57.472120 [debug] [MainThread]: Using postgres connection "master"
[0m08:16:57.472867 [debug] [MainThread]: On master: COMMIT
[0m08:16:57.473914 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m08:16:57.474862 [debug] [MainThread]: On master: Close
[0m08:16:57.475911 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:16:57.476572 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m08:16:57.477181 [debug] [MainThread]: Connection 'model.my_dbt_project.selected_rows' was properly closed.
[0m08:16:57.477762 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m08:16:57.478537 [info ] [MainThread]: 
[0m08:16:57.479872 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m08:16:57.481291 [debug] [MainThread]: Command end result
[0m08:16:57.497072 [info ] [MainThread]: 
[0m08:16:57.498592 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:16:57.499805 [info ] [MainThread]: 
[0m08:16:57.500964 [error] [MainThread]: [33mDatabase Error in model selected_rows (models/example/selected_rows.sql)[0m
[0m08:16:57.502558 [error] [MainThread]:   column "$.value" does not exist
[0m08:16:57.504317 [error] [MainThread]:   LINE 27:         json_value(worldbank_api_indicator, "$.value") as gd...
[0m08:16:57.505835 [error] [MainThread]:                                                        ^
[0m08:16:57.507623 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/selected_rows.sql
[0m08:16:57.508733 [info ] [MainThread]: 
[0m08:16:57.510123 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:16:57.511427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2184075490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21823336d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f217bdb17d0>]}
[0m08:16:57.512322 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 22:04:47.499998 | f4efff94-583f-47f8-8174-8c319d95e9a8 ==============================
[0m22:04:47.499998 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:04:47.503677 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:04:47.504879 [debug] [MainThread]: Tracking: tracking
[0m22:04:47.507837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9f4d5c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9f95f510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9f83ba50>]}
[0m22:04:47.522394 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:04:47.581271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:04:47.582306 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:04:47.593504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4efff94-583f-47f8-8174-8c319d95e9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9f4d64d0>]}
[0m22:04:47.610435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4efff94-583f-47f8-8174-8c319d95e9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9d8f4c90>]}
[0m22:04:47.611269 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m22:04:47.612241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4efff94-583f-47f8-8174-8c319d95e9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9f80b8d0>]}
[0m22:04:47.614621 [info ] [MainThread]: 
[0m22:04:47.618697 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:04:47.621581 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m22:04:47.637108 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m22:04:47.638314 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m22:04:47.639304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:47.666926 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:04:47.669231 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m22:04:47.671898 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m22:04:47.678759 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m22:04:47.679633 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m22:04:47.680317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:04:47.690543 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:04:47.691954 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m22:04:47.692859 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:04:47.706904 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:04:47.708956 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m22:04:47.709883 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m22:04:47.717596 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:47.718591 [debug] [MainThread]: On master: BEGIN
[0m22:04:47.719268 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:04:47.730269 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:04:47.731541 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:47.732166 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:04:47.759194 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m22:04:47.761514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4efff94-583f-47f8-8174-8c319d95e9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9d977690>]}
[0m22:04:47.762526 [debug] [MainThread]: On master: ROLLBACK
[0m22:04:47.763428 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:47.764138 [debug] [MainThread]: On master: BEGIN
[0m22:04:47.765568 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:04:47.766928 [debug] [MainThread]: On master: COMMIT
[0m22:04:47.767873 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:47.768815 [debug] [MainThread]: On master: COMMIT
[0m22:04:47.769674 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:04:47.770313 [debug] [MainThread]: On master: Close
[0m22:04:47.771315 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:04:47.772518 [info ] [MainThread]: 
[0m22:04:47.794303 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m22:04:47.794816 [debug] [Thread-2 (]: Began running node model.my_dbt_project.selected_rows
[0m22:04:47.795869 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m22:04:47.797077 [info ] [Thread-2 (]: 2 of 3 START sql view model public.selected_rows ............................... [RUN]
[0m22:04:47.799363 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m22:04:47.800917 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.selected_rows'
[0m22:04:47.801790 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m22:04:47.802425 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.selected_rows
[0m22:04:47.805474 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m22:04:47.808201 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.selected_rows"
[0m22:04:47.812188 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-29 22:04:47.802984 => 2023-07-29 22:04:47.812100
[0m22:04:47.812574 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.selected_rows (compile): 2023-07-29 22:04:47.806102 => 2023-07-29 22:04:47.812517
[0m22:04:47.812882 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m22:04:47.813523 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.selected_rows
[0m22:04:47.874738 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.selected_rows"
[0m22:04:47.877856 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m22:04:47.883223 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m22:04:47.883731 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m22:04:47.883993 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m22:04:47.884637 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: BEGIN
[0m22:04:47.885063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:47.885613 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:04:47.897300 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m22:04:47.897955 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:04:47.898485 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m22:04:47.899516 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m22:04:47.900184 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.selected_rows"} */

  create view "worldbank_api_db"."public"."selected_rows__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with 

data_since_2000 as (

    select *
    from worldbank_api
    --WHERE worldbank_api_date => 2000

),

selected_columns as (

    select
        json_value(worldbank_api_indicator, "$.value") as gdp,
        worldbank_api_date as date
    from data_since_2000
)

select *
from selected_columns

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m22:04:47.900820 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m22:04:47.903618 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "$.value" does not exist
LINE 27:         json_value(worldbank_api_indicator, "$.value") as gd...
                                                     ^

[0m22:04:47.905037 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: ROLLBACK
[0m22:04:47.906606 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.selected_rows (execute): 2023-07-29 22:04:47.838525 => 2023-07-29 22:04:47.906519
[0m22:04:47.907833 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: Close
[0m22:04:47.912943 [debug] [Thread-2 (]: Database Error in model selected_rows (models/example/selected_rows.sql)
  column "$.value" does not exist
  LINE 27:         json_value(worldbank_api_indicator, "$.value") as gd...
                                                       ^
  compiled Code at target/run/my_dbt_project/models/example/selected_rows.sql
[0m22:04:47.914674 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4efff94-583f-47f8-8174-8c319d95e9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9f218a50>]}
[0m22:04:47.916829 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m22:04:47.916534 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model public.selected_rows ...................... [[31mERROR[0m in 0.11s]
[0m22:04:47.924739 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m22:04:47.926853 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.selected_rows
[0m22:04:47.927610 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m22:04:47.930088 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:04:47.935832 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m22:04:47.936792 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m22:04:47.938523 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:04:47.963792 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m22:04:47.964677 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m22:04:47.965477 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m22:04:47.967274 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m22:04:47.973566 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m22:04:47.974330 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m22:04:47.996709 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m22:04:47.998887 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-29 22:04:47.814104 => 2023-07-29 22:04:47.998816
[0m22:04:47.999690 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m22:04:48.000974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4efff94-583f-47f8-8174-8c319d95e9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9d808a50>]}
[0m22:04:48.001844 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.20s]
[0m22:04:48.003194 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m22:04:48.004931 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m22:04:48.005705 [info ] [Thread-4 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m22:04:48.006887 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m22:04:48.007390 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m22:04:48.010211 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m22:04:48.011663 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-29 22:04:48.007688 => 2023-07-29 22:04:48.011530
[0m22:04:48.012297 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m22:04:48.016644 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m22:04:48.018656 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m22:04:48.019156 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m22:04:48.019595 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:04:48.029722 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m22:04:48.030516 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m22:04:48.030940 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m22:04:48.034986 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m22:04:48.038179 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m22:04:48.039131 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m22:04:48.040594 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:04:48.042651 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m22:04:48.043140 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m22:04:48.043489 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m22:04:48.045038 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m22:04:48.048154 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m22:04:48.048843 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m22:04:48.049974 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m22:04:48.051563 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-29 22:04:48.012719 => 2023-07-29 22:04:48.051504
[0m22:04:48.052101 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m22:04:48.053138 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4efff94-583f-47f8-8174-8c319d95e9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9f82eb10>]}
[0m22:04:48.053891 [info ] [Thread-4 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.05s]
[0m22:04:48.054803 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m22:04:48.057863 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:04:48.058545 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:48.059050 [debug] [MainThread]: On master: BEGIN
[0m22:04:48.059526 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:04:48.068984 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:04:48.070084 [debug] [MainThread]: On master: COMMIT
[0m22:04:48.070663 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:48.071243 [debug] [MainThread]: On master: COMMIT
[0m22:04:48.072161 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:04:48.072694 [debug] [MainThread]: On master: Close
[0m22:04:48.073728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:48.074361 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m22:04:48.075009 [debug] [MainThread]: Connection 'model.my_dbt_project.selected_rows' was properly closed.
[0m22:04:48.075657 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m22:04:48.076406 [info ] [MainThread]: 
[0m22:04:48.077337 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m22:04:48.078572 [debug] [MainThread]: Command end result
[0m22:04:48.088926 [info ] [MainThread]: 
[0m22:04:48.090136 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:04:48.091072 [info ] [MainThread]: 
[0m22:04:48.092239 [error] [MainThread]: [33mDatabase Error in model selected_rows (models/example/selected_rows.sql)[0m
[0m22:04:48.093116 [error] [MainThread]:   column "$.value" does not exist
[0m22:04:48.094176 [error] [MainThread]:   LINE 27:         json_value(worldbank_api_indicator, "$.value") as gd...
[0m22:04:48.095316 [error] [MainThread]:                                                        ^
[0m22:04:48.096260 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/selected_rows.sql
[0m22:04:48.098203 [info ] [MainThread]: 
[0m22:04:48.099509 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:04:48.100879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9d8e1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9d8c3110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9f772550>]}
[0m22:04:48.101743 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 22:09:23.108195 | 6da3caee-7d04-4ce3-b698-b08f93317ade ==============================
[0m22:09:23.108195 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:09:23.110870 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:09:23.111688 [debug] [MainThread]: Tracking: tracking
[0m22:09:23.114503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97a3560d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97a426010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97a68f150>]}
[0m22:09:23.132863 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:09:23.177533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:09:23.178534 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/selected_rows.sql
[0m22:09:23.198332 [debug] [MainThread]: 1699: static parser successfully parsed example/selected_rows.sql
[0m22:09:23.222013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6da3caee-7d04-4ce3-b698-b08f93317ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97a38fb10>]}
[0m22:09:23.234930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6da3caee-7d04-4ce3-b698-b08f93317ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc978572fd0>]}
[0m22:09:23.236111 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m22:09:23.237860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6da3caee-7d04-4ce3-b698-b08f93317ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97a11f310>]}
[0m22:09:23.240888 [info ] [MainThread]: 
[0m22:09:23.244951 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:09:23.247659 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m22:09:23.259700 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m22:09:23.260379 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m22:09:23.260949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:09:23.272515 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:09:23.274679 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m22:09:23.276872 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m22:09:23.283189 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m22:09:23.284010 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m22:09:23.284698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:09:23.294243 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:09:23.295324 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m22:09:23.296062 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:09:23.302832 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:09:23.304886 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m22:09:23.306120 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m22:09:23.313091 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:23.313905 [debug] [MainThread]: On master: BEGIN
[0m22:09:23.314515 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:09:23.324097 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:09:23.325003 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:23.325572 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:09:23.339089 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m22:09:23.341650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6da3caee-7d04-4ce3-b698-b08f93317ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9786a4910>]}
[0m22:09:23.343580 [debug] [MainThread]: On master: ROLLBACK
[0m22:09:23.345154 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:23.345886 [debug] [MainThread]: On master: BEGIN
[0m22:09:23.347077 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:09:23.348194 [debug] [MainThread]: On master: COMMIT
[0m22:09:23.349323 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:23.349997 [debug] [MainThread]: On master: COMMIT
[0m22:09:23.350811 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:09:23.351354 [debug] [MainThread]: On master: Close
[0m22:09:23.352353 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:09:23.353323 [info ] [MainThread]: 
[0m22:09:23.370944 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m22:09:23.371462 [debug] [Thread-2 (]: Began running node model.my_dbt_project.selected_rows
[0m22:09:23.372386 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m22:09:23.373318 [info ] [Thread-2 (]: 2 of 3 START sql view model public.selected_rows ............................... [RUN]
[0m22:09:23.375028 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m22:09:23.375980 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.selected_rows'
[0m22:09:23.376778 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m22:09:23.377364 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.selected_rows
[0m22:09:23.381300 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m22:09:23.384288 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.selected_rows"
[0m22:09:23.387034 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.selected_rows (compile): 2023-07-29 22:09:23.381929 => 2023-07-29 22:09:23.386858
[0m22:09:23.387497 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-29 22:09:23.378026 => 2023-07-29 22:09:23.387417
[0m22:09:23.387836 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.selected_rows
[0m22:09:23.388435 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m22:09:23.454448 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m22:09:23.456822 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.selected_rows"
[0m22:09:23.460489 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m22:09:23.460907 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m22:09:23.461473 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m22:09:23.462016 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: BEGIN
[0m22:09:23.462582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:09:23.463037 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:09:23.472876 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:09:23.473700 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m22:09:23.474510 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m22:09:23.475490 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m22:09:23.476092 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m22:09:23.476786 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.selected_rows"} */

  create view "worldbank_api_db"."public"."selected_rows__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with 

data_since_2000 as (

    select *
    from worldbank_api
    --WHERE worldbank_api_date => 2000

),

selected_columns as (

    select
        worldbank_api_indicator.value as gdp,
        worldbank_api_date as date
    from data_since_2000
)

select *
from selected_columns

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m22:09:23.479220 [debug] [Thread-2 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "worldbank_api_indicator"
LINE 27:         worldbank_api_indicator.value as gdp,
                 ^

[0m22:09:23.480111 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: ROLLBACK
[0m22:09:23.481245 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.selected_rows (execute): 2023-07-29 22:09:23.388858 => 2023-07-29 22:09:23.481158
[0m22:09:23.481924 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: Close
[0m22:09:23.484449 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m22:09:23.491887 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m22:09:23.492531 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m22:09:23.494609 [debug] [Thread-2 (]: Database Error in model selected_rows (models/example/selected_rows.sql)
  missing FROM-clause entry for table "worldbank_api_indicator"
  LINE 27:         worldbank_api_indicator.value as gdp,
                   ^
  compiled Code at target/run/my_dbt_project/models/example/selected_rows.sql
[0m22:09:23.494929 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:09:23.495589 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6da3caee-7d04-4ce3-b698-b08f93317ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9785e5bd0>]}
[0m22:09:23.498680 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m22:09:23.499594 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model public.selected_rows ...................... [[31mERROR[0m in 0.12s]
[0m22:09:23.500285 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m22:09:23.502686 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.selected_rows
[0m22:09:23.504121 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:09:23.529703 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m22:09:23.531223 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m22:09:23.532525 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m22:09:23.534842 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m22:09:23.540941 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m22:09:23.542270 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m22:09:23.550010 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m22:09:23.552238 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-29 22:09:23.405450 => 2023-07-29 22:09:23.552176
[0m22:09:23.552902 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m22:09:23.554030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6da3caee-7d04-4ce3-b698-b08f93317ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9786b29d0>]}
[0m22:09:23.554902 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.18s]
[0m22:09:23.555720 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m22:09:23.557310 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m22:09:23.558006 [info ] [Thread-4 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m22:09:23.559172 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m22:09:23.559664 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m22:09:23.562315 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m22:09:23.563474 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-29 22:09:23.559983 => 2023-07-29 22:09:23.563408
[0m22:09:23.563949 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m22:09:23.568244 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m22:09:23.569959 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m22:09:23.570483 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m22:09:23.571090 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:09:23.580846 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m22:09:23.581734 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m22:09:23.582325 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m22:09:23.586253 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m22:09:23.589527 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m22:09:23.590439 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m22:09:23.591950 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:09:23.594023 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m22:09:23.594725 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m22:09:23.595342 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m22:09:23.596893 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m22:09:23.599445 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m22:09:23.600087 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m22:09:23.601020 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m22:09:23.602541 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-29 22:09:23.564252 => 2023-07-29 22:09:23.602486
[0m22:09:23.603147 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m22:09:23.604449 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6da3caee-7d04-4ce3-b698-b08f93317ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9786ce590>]}
[0m22:09:23.605776 [info ] [Thread-4 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.05s]
[0m22:09:23.607096 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m22:09:23.609952 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:09:23.610414 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:23.610831 [debug] [MainThread]: On master: BEGIN
[0m22:09:23.611158 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:09:23.620100 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:09:23.620972 [debug] [MainThread]: On master: COMMIT
[0m22:09:23.621423 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:23.621840 [debug] [MainThread]: On master: COMMIT
[0m22:09:23.622416 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:09:23.622918 [debug] [MainThread]: On master: Close
[0m22:09:23.623833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:09:23.624262 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m22:09:23.624847 [debug] [MainThread]: Connection 'model.my_dbt_project.selected_rows' was properly closed.
[0m22:09:23.625362 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m22:09:23.626116 [info ] [MainThread]: 
[0m22:09:23.627037 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m22:09:23.628134 [debug] [MainThread]: Command end result
[0m22:09:23.638974 [info ] [MainThread]: 
[0m22:09:23.640214 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:09:23.641506 [info ] [MainThread]: 
[0m22:09:23.643478 [error] [MainThread]: [33mDatabase Error in model selected_rows (models/example/selected_rows.sql)[0m
[0m22:09:23.644988 [error] [MainThread]:   missing FROM-clause entry for table "worldbank_api_indicator"
[0m22:09:23.646320 [error] [MainThread]:   LINE 27:         worldbank_api_indicator.value as gdp,
[0m22:09:23.648087 [error] [MainThread]:                    ^
[0m22:09:23.649549 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/selected_rows.sql
[0m22:09:23.650774 [info ] [MainThread]: 
[0m22:09:23.651885 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:09:23.653058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97a2f8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97a2cd8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97a301510>]}
[0m22:09:23.653768 [debug] [MainThread]: Flushing usage events


============================== 2023-07-29 22:12:18.917402 | 81378bcb-50d4-4d8f-9831-55609d5b9b87 ==============================
[0m22:12:18.917402 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:12:18.920607 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:12:18.921771 [debug] [MainThread]: Tracking: tracking
[0m22:12:18.924884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d821c8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8215e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d81c8cc50>]}
[0m22:12:18.938712 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:12:18.988582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:12:18.989579 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/selected_rows.sql
[0m22:12:19.006021 [debug] [MainThread]: 1699: static parser successfully parsed example/selected_rows.sql
[0m22:12:19.029869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81378bcb-50d4-4d8f-9831-55609d5b9b87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d81c3ff90>]}
[0m22:12:19.045682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81378bcb-50d4-4d8f-9831-55609d5b9b87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d7bb02d50>]}
[0m22:12:19.046770 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m22:12:19.047928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81378bcb-50d4-4d8f-9831-55609d5b9b87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d821c8ad0>]}
[0m22:12:19.050545 [info ] [MainThread]: 
[0m22:12:19.053727 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:12:19.055881 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m22:12:19.067361 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m22:12:19.068270 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m22:12:19.069007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:12:19.083679 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:12:19.085763 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m22:12:19.089021 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m22:12:19.095520 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m22:12:19.096177 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m22:12:19.096863 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:12:19.106226 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:12:19.107257 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m22:12:19.107959 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:12:19.114729 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:12:19.116621 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m22:12:19.117726 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m22:12:19.124725 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:19.125669 [debug] [MainThread]: On master: BEGIN
[0m22:12:19.126482 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:12:19.136682 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:12:19.137804 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:19.138439 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:12:19.155847 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m22:12:19.167387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81378bcb-50d4-4d8f-9831-55609d5b9b87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d824991d0>]}
[0m22:12:19.169538 [debug] [MainThread]: On master: ROLLBACK
[0m22:12:19.171934 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:19.173082 [debug] [MainThread]: On master: BEGIN
[0m22:12:19.175330 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:12:19.176493 [debug] [MainThread]: On master: COMMIT
[0m22:12:19.177470 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:19.178879 [debug] [MainThread]: On master: COMMIT
[0m22:12:19.180030 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:12:19.180974 [debug] [MainThread]: On master: Close
[0m22:12:19.183303 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:12:19.184472 [info ] [MainThread]: 
[0m22:12:19.203580 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m22:12:19.204066 [debug] [Thread-2 (]: Began running node model.my_dbt_project.selected_rows
[0m22:12:19.204913 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m22:12:19.207257 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m22:12:19.205945 [info ] [Thread-2 (]: 2 of 3 START sql view model public.selected_rows ............................... [RUN]
[0m22:12:19.208090 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m22:12:19.209325 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.selected_rows'
[0m22:12:19.213699 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m22:12:19.214634 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.selected_rows
[0m22:12:19.218827 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.selected_rows"
[0m22:12:19.222421 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-29 22:12:19.210000 => 2023-07-29 22:12:19.222210
[0m22:12:19.224066 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.selected_rows (compile): 2023-07-29 22:12:19.216095 => 2023-07-29 22:12:19.223836
[0m22:12:19.224406 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m22:12:19.226145 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.selected_rows
[0m22:12:19.310978 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.selected_rows"
[0m22:12:19.313961 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m22:12:19.317287 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m22:12:19.317892 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m22:12:19.318136 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m22:12:19.318772 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: BEGIN
[0m22:12:19.319187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:19.319733 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:12:19.329883 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m22:12:19.330885 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:12:19.331361 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m22:12:19.332092 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m22:12:19.332736 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.selected_rows"} */

  create view "worldbank_api_db"."public"."selected_rows__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with 

data_since_2000 as (

    select *
    from worldbank_api
    --WHERE worldbank_api_date => 2000

),

selected_columns as (

    select
        worldbank_api_indicator as gdp,
        worldbank_api_date as worldbank_api_date
    from data_since_2000
)

select *
from selected_columns

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m22:12:19.333220 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m22:12:19.338158 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m22:12:19.344866 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m22:12:19.345410 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m22:12:19.348483 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m22:12:19.349004 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m22:12:19.349830 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.selected_rows"} */
alter table "worldbank_api_db"."public"."selected_rows" rename to "selected_rows__dbt_backup"
[0m22:12:19.351351 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:12:19.354043 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m22:12:19.354278 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:12:19.354914 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m22:12:19.358039 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m22:12:19.359712 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.selected_rows"} */
alter table "worldbank_api_db"."public"."selected_rows__dbt_tmp" rename to "selected_rows"
[0m22:12:19.359935 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:12:19.366800 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:12:19.398463 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m22:12:19.400545 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: COMMIT
[0m22:12:19.401367 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m22:12:19.402176 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m22:12:19.402959 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m22:12:19.403670 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: COMMIT
[0m22:12:19.406264 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m22:12:19.406833 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m22:12:19.412110 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m22:12:19.415111 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.selected_rows"
[0m22:12:19.415781 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m22:12:19.416677 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.selected_rows"} */
drop view if exists "worldbank_api_db"."public"."selected_rows__dbt_backup" cascade
[0m22:12:19.421801 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m22:12:19.422576 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m22:12:19.424097 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.selected_rows (execute): 2023-07-29 22:12:19.244110 => 2023-07-29 22:12:19.424026
[0m22:12:19.425570 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-29 22:12:19.227043 => 2023-07-29 22:12:19.425524
[0m22:12:19.426272 [debug] [Thread-2 (]: On model.my_dbt_project.selected_rows: Close
[0m22:12:19.426771 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m22:12:19.428128 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81378bcb-50d4-4d8f-9831-55609d5b9b87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d7bb59fd0>]}
[0m22:12:19.429176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81378bcb-50d4-4d8f-9831-55609d5b9b87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d7bb5b050>]}
[0m22:12:19.429722 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.selected_rows .......................... [[32mCREATE VIEW[0m in 0.22s]
[0m22:12:19.430558 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.22s]
[0m22:12:19.433387 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.selected_rows
[0m22:12:19.434074 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m22:12:19.436420 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m22:12:19.437110 [info ] [Thread-4 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m22:12:19.438466 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m22:12:19.439094 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m22:12:19.442303 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m22:12:19.444212 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-29 22:12:19.439550 => 2023-07-29 22:12:19.444135
[0m22:12:19.444850 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m22:12:19.451060 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m22:12:19.454113 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m22:12:19.455215 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m22:12:19.456710 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:12:19.468243 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m22:12:19.469332 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m22:12:19.469966 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m22:12:19.475345 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m22:12:19.479012 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m22:12:19.479872 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m22:12:19.482039 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:12:19.484600 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m22:12:19.485409 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m22:12:19.486112 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m22:12:19.487806 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m22:12:19.490342 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m22:12:19.491042 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m22:12:19.491905 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m22:12:19.493459 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-29 22:12:19.445319 => 2023-07-29 22:12:19.493404
[0m22:12:19.494019 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m22:12:19.495145 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81378bcb-50d4-4d8f-9831-55609d5b9b87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d83614790>]}
[0m22:12:19.495986 [info ] [Thread-4 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.06s]
[0m22:12:19.497070 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m22:12:19.500725 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:12:19.501351 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:19.501903 [debug] [MainThread]: On master: BEGIN
[0m22:12:19.502372 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:12:19.512054 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:12:19.513172 [debug] [MainThread]: On master: COMMIT
[0m22:12:19.513785 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:19.514416 [debug] [MainThread]: On master: COMMIT
[0m22:12:19.515310 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:12:19.515852 [debug] [MainThread]: On master: Close
[0m22:12:19.516846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:12:19.517823 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m22:12:19.518433 [debug] [MainThread]: Connection 'model.my_dbt_project.selected_rows' was properly closed.
[0m22:12:19.518954 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m22:12:19.519616 [info ] [MainThread]: 
[0m22:12:19.520630 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m22:12:19.522009 [debug] [MainThread]: Command end result
[0m22:12:19.531465 [info ] [MainThread]: 
[0m22:12:19.532832 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:12:19.534193 [info ] [MainThread]: 
[0m22:12:19.535759 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:12:19.537099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d80599310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d81c634d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d824981d0>]}
[0m22:12:19.538319 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 01:15:09.330480 | 11e7acc4-12c9-488d-a27c-005ff0651126 ==============================
[0m01:15:09.330480 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:15:09.334001 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:15:09.335448 [debug] [MainThread]: Tracking: tracking
[0m01:15:09.338615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccda94ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccda503490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccda47d510>]}
[0m01:15:09.353185 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:15:09.422964 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 4 files added, 0 files changed.
[0m01:15:09.424139 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/example/my_first_dbt_model copy.sql
[0m01:15:09.425143 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/example/worlbank_api_schema.yml
[0m01:15:09.426022 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/example/worldbank_api_stg.sql
[0m01:15:09.426785 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m01:15:09.427384 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/example/selected_rows.sql
[0m01:15:09.442747 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model copy.sql
[0m01:15:09.459836 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_stg.sql
[0m01:15:09.464129 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m01:15:09.474700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd85d7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd85d5810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd85f7bd0>]}
[0m01:15:09.475699 [debug] [MainThread]: Flushing usage events
[0m01:15:11.527316 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named my_first_dbt_model. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for my_first_dbt_model in one of these files:
   - models/example/worlbank_api_schema.yml
  models/example/schema.yml


============================== 2023-07-30 01:17:16.019947 | 3cd9f429-347f-4151-9ea7-996f34c0124e ==============================
[0m01:17:16.019947 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:17:16.022520 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:17:16.023349 [debug] [MainThread]: Tracking: tracking
[0m01:17:16.027077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766dbc4c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766d84bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766e074c10>]}
[0m01:17:16.039981 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:17:16.091278 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m01:17:16.092663 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m01:17:16.093907 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/example/worldbank_api_stg.sql
[0m01:17:16.094831 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/example/selected_rows.sql
[0m01:17:16.111524 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m01:17:16.127577 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_stg.sql
[0m01:17:16.142390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cd9f429-347f-4151-9ea7-996f34c0124e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766c0f4f90>]}
[0m01:17:16.158013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cd9f429-347f-4151-9ea7-996f34c0124e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766c0e7290>]}
[0m01:17:16.159123 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:17:16.160357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cd9f429-347f-4151-9ea7-996f34c0124e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766dce0690>]}
[0m01:17:16.163418 [info ] [MainThread]: 
[0m01:17:16.168881 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:17:16.171767 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m01:17:16.188618 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m01:17:16.189687 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m01:17:16.190413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:16.205906 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:17:16.207876 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m01:17:16.210638 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m01:17:16.217387 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:17:16.218132 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m01:17:16.218917 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:16.227808 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m01:17:16.228585 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:17:16.229335 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:17:16.236401 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m01:17:16.238366 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m01:17:16.239778 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m01:17:16.246695 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:16.247551 [debug] [MainThread]: On master: BEGIN
[0m01:17:16.248348 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:17:16.257436 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:17:16.258175 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:16.259008 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:17:16.270421 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m01:17:16.272364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cd9f429-347f-4151-9ea7-996f34c0124e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766d856350>]}
[0m01:17:16.273502 [debug] [MainThread]: On master: ROLLBACK
[0m01:17:16.274628 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:16.275288 [debug] [MainThread]: On master: BEGIN
[0m01:17:16.276228 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:17:16.277229 [debug] [MainThread]: On master: COMMIT
[0m01:17:16.277927 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:16.278534 [debug] [MainThread]: On master: COMMIT
[0m01:17:16.279338 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:17:16.279931 [debug] [MainThread]: On master: Close
[0m01:17:16.280842 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:17:16.281678 [info ] [MainThread]: 
[0m01:17:16.303345 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m01:17:16.303786 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m01:17:16.304136 [debug] [Thread-3 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m01:17:16.305037 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m01:17:16.306311 [info ] [Thread-2 (]: 2 of 4 START sql view model public.worldbank_api_metrics ....................... [RUN]
[0m01:17:16.307703 [info ] [Thread-3 (]: 3 of 4 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m01:17:16.309569 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m01:17:16.310923 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m01:17:16.311955 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m01:17:16.312821 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m01:17:16.313577 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m01:17:16.314137 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m01:17:16.317467 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m01:17:16.321215 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:17:16.324535 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m01:17:16.331637 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-30 01:17:16.314925 => 2023-07-30 01:17:16.331368
[0m01:17:16.332123 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 01:17:16.318575 => 2023-07-30 01:17:16.332055
[0m01:17:16.332785 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 01:17:16.321961 => 2023-07-30 01:17:16.332671
[0m01:17:16.333431 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m01:17:16.334437 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m01:17:16.335260 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m01:17:16.410787 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:17:16.414576 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m01:17:16.421069 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m01:17:16.424729 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:17:16.425632 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m01:17:16.426464 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:17:16.426695 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:17:16.426924 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:17:16.427611 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m01:17:16.429543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:16.428183 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m01:17:16.432662 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:17:16.442442 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m01:17:16.443584 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:17:16.444390 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  create view "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp
    from worldbank_api_stg
    where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        MIN(gdp) as min_gdp_growth_since_2000,
        MAX(gdp) as max_gdp_growth_since_2000
    from filtered_data
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
[0m01:17:16.444776 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:17:16.446507 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:17:16.447406 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m01:17:16.448530 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "=>"
LINE 13:     where worldbank_api_date => 2000
                                      ^

[0m01:17:16.449423 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: ROLLBACK
[0m01:17:16.450351 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m01:17:16.451248 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:17:16.451808 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

generate_surrogate_key as (

    select 
        dbt_utils.generate_surrogate_key(
            ['worldbank_api_indicator', 
            'worldbank_api_date',
            'worldbank_api_countryiso3code',
            'worldbank_api_date',
            'worldbank_api_value',
            'worldbank_api_unit',
            'worldbank_api_obs_status','worldbank_api_decimal']) as generated_id,
        worldbank_api_indicator.id as worldbank_api_indicator_id
        worldbank_api_indicator.value as worldbank_api_indicator_value,
        worldbank_api_country.id as worldbank_api_country_id,
        worldbank_api_country.value as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
)

select *
from generate_surrogate_key
  );
  
[0m01:17:16.452932 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 01:17:16.352603 => 2023-07-30 01:17:16.452825
[0m01:17:16.453510 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m01:17:16.454037 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "["
LINE 16:             ['worldbank_api_indicator', 
                     ^

[0m01:17:16.454546 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m01:17:16.464337 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:17:16.465155 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: ROLLBACK
[0m01:17:16.470020 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:17:16.474215 [debug] [Thread-2 (]: Database Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)
  syntax error at or near "=>"
  LINE 13:     where worldbank_api_date => 2000
                                        ^
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m01:17:16.475020 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 01:17:16.415382 => 2023-07-30 01:17:16.474855
[0m01:17:16.477399 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:17:16.477977 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cd9f429-347f-4151-9ea7-996f34c0124e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766c003f10>]}
[0m01:17:16.478772 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m01:17:16.496682 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.worldbank_api_metrics .............. [[31mERROR[0m in 0.17s]
[0m01:17:16.503586 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:17:16.506394 [debug] [Thread-3 (]: Database Error in model worldbank_api_stg (models/example/worldbank_api_stg.sql)
  syntax error at or near "["
  LINE 16:             ['worldbank_api_indicator', 
                       ^
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_stg.sql
[0m01:17:16.508073 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m01:17:16.508716 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:17:16.509746 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cd9f429-347f-4151-9ea7-996f34c0124e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766bfc3090>]}
[0m01:17:16.511364 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:17:16.512400 [error] [Thread-3 (]: 3 of 4 ERROR creating sql table model public.worldbank_api_stg ................. [[31mERROR[0m in 0.20s]
[0m01:17:16.513768 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m01:17:16.514234 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m01:17:16.519851 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:17:16.520548 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m01:17:16.521660 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m01:17:16.523275 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-30 01:17:16.336121 => 2023-07-30 01:17:16.523222
[0m01:17:16.523904 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m01:17:16.524932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cd9f429-347f-4151-9ea7-996f34c0124e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766bff2950>]}
[0m01:17:16.525708 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.22s]
[0m01:17:16.526823 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m01:17:16.528034 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m01:17:16.529119 [info ] [Thread-4 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m01:17:16.530448 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m01:17:16.531155 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m01:17:16.534208 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m01:17:16.536460 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-30 01:17:16.531670 => 2023-07-30 01:17:16.536375
[0m01:17:16.537071 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m01:17:16.541798 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m01:17:16.544418 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:17:16.544956 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m01:17:16.545482 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:17:16.555447 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m01:17:16.556275 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:17:16.556826 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m01:17:16.560466 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m01:17:16.565355 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:17:16.566339 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m01:17:16.567823 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:17:16.569852 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:17:16.570410 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:17:16.570876 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:17:16.572115 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m01:17:16.574510 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:17:16.575078 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m01:17:16.575922 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m01:17:16.577439 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-30 01:17:16.537592 => 2023-07-30 01:17:16.577343
[0m01:17:16.578067 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m01:17:16.579109 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cd9f429-347f-4151-9ea7-996f34c0124e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766c090ed0>]}
[0m01:17:16.579833 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.05s]
[0m01:17:16.580829 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m01:17:16.583994 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:17:16.584527 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:16.584877 [debug] [MainThread]: On master: BEGIN
[0m01:17:16.585202 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:17:16.594169 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:17:16.594875 [debug] [MainThread]: On master: COMMIT
[0m01:17:16.595426 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:16.596030 [debug] [MainThread]: On master: COMMIT
[0m01:17:16.597064 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:17:16.597850 [debug] [MainThread]: On master: Close
[0m01:17:16.598966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:17:16.599571 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m01:17:16.600323 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m01:17:16.600767 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m01:17:16.601194 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m01:17:16.602077 [info ] [MainThread]: 
[0m01:17:16.603026 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m01:17:16.603940 [debug] [MainThread]: Command end result
[0m01:17:16.613026 [info ] [MainThread]: 
[0m01:17:16.614111 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:17:16.615128 [info ] [MainThread]: 
[0m01:17:16.616180 [error] [MainThread]: [33mDatabase Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)[0m
[0m01:17:16.617301 [error] [MainThread]:   syntax error at or near "=>"
[0m01:17:16.618191 [error] [MainThread]:   LINE 13:     where worldbank_api_date => 2000
[0m01:17:16.619476 [error] [MainThread]:                                         ^
[0m01:17:16.620629 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m01:17:16.621721 [info ] [MainThread]: 
[0m01:17:16.623450 [error] [MainThread]: [33mDatabase Error in model worldbank_api_stg (models/example/worldbank_api_stg.sql)[0m
[0m01:17:16.624496 [error] [MainThread]:   syntax error at or near "["
[0m01:17:16.625619 [error] [MainThread]:   LINE 16:             ['worldbank_api_indicator', 
[0m01:17:16.626799 [error] [MainThread]:                        ^
[0m01:17:16.627720 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_stg.sql
[0m01:17:16.628595 [info ] [MainThread]: 
[0m01:17:16.629520 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m01:17:16.630725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766bfef710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766bfecf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766bfee9d0>]}
[0m01:17:16.631552 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 01:18:04.458313 | 38bf12b4-cc5c-42aa-bcd9-7de6bd6956bd ==============================
[0m01:18:04.458313 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:18:04.461306 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:18:04.462061 [debug] [MainThread]: Tracking: tracking
[0m01:18:04.467346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ec775790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ec58be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ec58aed0>]}
[0m01:18:04.481389 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:18:04.532754 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:18:04.533889 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_stg.sql
[0m01:18:04.535083 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m01:18:04.551812 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_stg.sql
[0m01:18:04.567435 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m01:18:04.581038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38bf12b4-cc5c-42aa-bcd9-7de6bd6956bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ec58bc50>]}
[0m01:18:04.594514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38bf12b4-cc5c-42aa-bcd9-7de6bd6956bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ea8f8310>]}
[0m01:18:04.595610 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:18:04.597190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38bf12b4-cc5c-42aa-bcd9-7de6bd6956bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ec658a10>]}
[0m01:18:04.599620 [info ] [MainThread]: 
[0m01:18:04.605313 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:18:04.608489 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m01:18:04.624912 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m01:18:04.626040 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m01:18:04.626998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:04.640430 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:18:04.642720 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m01:18:04.645538 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m01:18:04.652349 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:18:04.653211 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m01:18:04.654031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:04.663247 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m01:18:04.664035 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:18:04.664657 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:18:04.671206 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m01:18:04.673360 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m01:18:04.674289 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m01:18:04.681057 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:04.681898 [debug] [MainThread]: On master: BEGIN
[0m01:18:04.682619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:18:04.691819 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:18:04.692505 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:04.692914 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:18:04.705262 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m01:18:04.707582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38bf12b4-cc5c-42aa-bcd9-7de6bd6956bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ec078850>]}
[0m01:18:04.708307 [debug] [MainThread]: On master: ROLLBACK
[0m01:18:04.708929 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:04.709420 [debug] [MainThread]: On master: BEGIN
[0m01:18:04.710255 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:18:04.710896 [debug] [MainThread]: On master: COMMIT
[0m01:18:04.711453 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:04.711949 [debug] [MainThread]: On master: COMMIT
[0m01:18:04.712570 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:18:04.712961 [debug] [MainThread]: On master: Close
[0m01:18:04.713778 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:18:04.714519 [info ] [MainThread]: 
[0m01:18:04.733758 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m01:18:04.734246 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m01:18:04.734659 [debug] [Thread-3 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m01:18:04.737637 [info ] [Thread-3 (]: 3 of 4 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m01:18:04.736327 [info ] [Thread-2 (]: 2 of 4 START sql view model public.worldbank_api_metrics ....................... [RUN]
[0m01:18:04.735608 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m01:18:04.739057 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m01:18:04.740159 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m01:18:04.741056 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m01:18:04.741706 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m01:18:04.742386 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m01:18:04.743103 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m01:18:04.746365 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m01:18:04.749543 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:18:04.752907 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m01:18:04.756714 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 01:18:04.743739 => 2023-07-30 01:18:04.756618
[0m01:18:04.757067 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 01:18:04.747159 => 2023-07-30 01:18:04.756994
[0m01:18:04.757476 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-30 01:18:04.750421 => 2023-07-30 01:18:04.757381
[0m01:18:04.757805 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m01:18:04.758730 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m01:18:04.759434 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m01:18:04.835562 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:18:04.847750 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m01:18:04.848406 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m01:18:04.852020 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:18:04.852257 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:18:04.852683 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:18:04.852898 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m01:18:04.853539 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m01:18:04.854096 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m01:18:04.854695 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:18:04.855273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:04.855846 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:18:04.867876 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m01:18:04.868319 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:18:04.869194 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:18:04.869534 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m01:18:04.870087 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:18:04.870702 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  create view "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        MIN(gdp) as min_gdp_growth_since_2000,
        MAX(gdp) as max_gdp_growth_since_2000
    from filtered_data
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
[0m01:18:04.871280 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:18:04.871869 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m01:18:04.873222 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

generate_surrogate_key as (

    select 
        dbt_utils.generate_surrogate_key(
            ['worldbank_api_indicator', 
            'worldbank_api_date',
            'worldbank_api_countryiso3code',
            'worldbank_api_date',
            'worldbank_api_value',
            'worldbank_api_unit',
            'worldbank_api_obs_status','worldbank_api_decimal']) as generated_id,
        worldbank_api_indicator.id as worldbank_api_indicator_id,
        worldbank_api_indicator.value as worldbank_api_indicator_value,
        worldbank_api_country.id as worldbank_api_country_id,
        worldbank_api_country.value as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
)

select *
from generate_surrogate_key
  );
  
[0m01:18:04.874011 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "worldbank_api_stg" does not exist
LINE 12:     from worldbank_api_stg
                  ^

[0m01:18:04.875468 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: ROLLBACK
[0m01:18:04.875873 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "["
LINE 16:             ['worldbank_api_indicator', 
                     ^

[0m01:18:04.877017 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 01:18:04.777099 => 2023-07-30 01:18:04.876933
[0m01:18:04.877285 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: ROLLBACK
[0m01:18:04.877958 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m01:18:04.878886 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 01:18:04.760006 => 2023-07-30 01:18:04.878828
[0m01:18:04.879182 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m01:18:04.881551 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m01:18:04.890182 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:18:04.894977 [debug] [Thread-2 (]: Database Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)
  relation "worldbank_api_stg" does not exist
  LINE 12:     from worldbank_api_stg
                    ^
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m01:18:04.896149 [debug] [Thread-3 (]: Database Error in model worldbank_api_stg (models/example/worldbank_api_stg.sql)
  syntax error at or near "["
  LINE 16:             ['worldbank_api_indicator', 
                       ^
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_stg.sql
[0m01:18:04.896901 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m01:18:04.897925 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bf12b4-cc5c-42aa-bcd9-7de6bd6956bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ea814910>]}
[0m01:18:04.899133 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bf12b4-cc5c-42aa-bcd9-7de6bd6956bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ee7b2050>]}
[0m01:18:04.901056 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:18:04.900675 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.worldbank_api_metrics .............. [[31mERROR[0m in 0.16s]
[0m01:18:04.901976 [error] [Thread-3 (]: 3 of 4 ERROR creating sql table model public.worldbank_api_stg ................. [[31mERROR[0m in 0.16s]
[0m01:18:04.905499 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:18:04.908070 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m01:18:04.908868 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m01:18:04.909935 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:18:04.912887 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:18:04.936416 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:18:04.937337 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:18:04.938119 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:18:04.940012 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m01:18:04.945685 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:18:04.946632 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m01:18:04.952172 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m01:18:04.954345 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-30 01:18:04.815282 => 2023-07-30 01:18:04.954283
[0m01:18:04.955128 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m01:18:04.956335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bf12b4-cc5c-42aa-bcd9-7de6bd6956bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ea7815d0>]}
[0m01:18:04.957147 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.22s]
[0m01:18:04.958260 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m01:18:04.959876 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m01:18:04.960933 [info ] [Thread-4 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m01:18:04.962391 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m01:18:04.963140 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m01:18:04.965875 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m01:18:04.967663 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-30 01:18:04.963717 => 2023-07-30 01:18:04.967590
[0m01:18:04.968223 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m01:18:04.974287 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m01:18:04.976668 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:18:04.977310 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m01:18:04.978214 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:18:04.987684 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m01:18:04.988464 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:18:04.988983 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m01:18:04.992647 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m01:18:04.996135 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:18:04.996921 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m01:18:04.998299 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:18:05.000502 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:18:05.001422 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:18:05.002134 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:18:05.003609 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m01:18:05.006183 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:18:05.006956 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m01:18:05.007820 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m01:18:05.009371 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-30 01:18:04.968757 => 2023-07-30 01:18:05.009311
[0m01:18:05.010094 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m01:18:05.011269 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38bf12b4-cc5c-42aa-bcd9-7de6bd6956bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e8676b10>]}
[0m01:18:05.012214 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.05s]
[0m01:18:05.013801 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m01:18:05.017131 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:18:05.017943 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:05.018476 [debug] [MainThread]: On master: BEGIN
[0m01:18:05.018989 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:18:05.028347 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:18:05.029550 [debug] [MainThread]: On master: COMMIT
[0m01:18:05.030331 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:05.030895 [debug] [MainThread]: On master: COMMIT
[0m01:18:05.031573 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:18:05.031999 [debug] [MainThread]: On master: Close
[0m01:18:05.032781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:05.033209 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m01:18:05.033623 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m01:18:05.034001 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m01:18:05.034521 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m01:18:05.035093 [info ] [MainThread]: 
[0m01:18:05.036034 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m01:18:05.037058 [debug] [MainThread]: Command end result
[0m01:18:05.046242 [info ] [MainThread]: 
[0m01:18:05.047440 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:18:05.048236 [info ] [MainThread]: 
[0m01:18:05.049274 [error] [MainThread]: [33mDatabase Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)[0m
[0m01:18:05.050484 [error] [MainThread]:   relation "worldbank_api_stg" does not exist
[0m01:18:05.051438 [error] [MainThread]:   LINE 12:     from worldbank_api_stg
[0m01:18:05.052515 [error] [MainThread]:                     ^
[0m01:18:05.053470 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m01:18:05.054895 [info ] [MainThread]: 
[0m01:18:05.056654 [error] [MainThread]: [33mDatabase Error in model worldbank_api_stg (models/example/worldbank_api_stg.sql)[0m
[0m01:18:05.057881 [error] [MainThread]:   syntax error at or near "["
[0m01:18:05.058993 [error] [MainThread]:   LINE 16:             ['worldbank_api_indicator', 
[0m01:18:05.060126 [error] [MainThread]:                        ^
[0m01:18:05.061320 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_stg.sql
[0m01:18:05.063150 [info ] [MainThread]: 
[0m01:18:05.064461 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m01:18:05.066101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ea84b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ec88ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e86687d0>]}
[0m01:18:05.067406 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 01:20:02.863888 | 29127431-2685-4d12-9210-8df5e3e7cbfe ==============================
[0m01:20:02.863888 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:20:02.866327 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:20:02.867271 [debug] [MainThread]: Tracking: tracking
[0m01:20:02.871316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda46926a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda465c85d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda468ed690>]}
[0m01:20:02.885485 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:20:02.935421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:20:02.936633 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_stg.sql
[0m01:20:02.953886 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_stg.sql
[0m01:20:02.982288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29127431-2685-4d12-9210-8df5e3e7cbfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda468797d0>]}
[0m01:20:02.996468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29127431-2685-4d12-9210-8df5e3e7cbfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda46900850>]}
[0m01:20:02.997872 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:20:02.999432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29127431-2685-4d12-9210-8df5e3e7cbfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda460f9710>]}
[0m01:20:03.001761 [info ] [MainThread]: 
[0m01:20:03.005741 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:20:03.008775 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m01:20:03.023892 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m01:20:03.024840 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m01:20:03.025693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:03.039584 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:20:03.043606 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m01:20:03.047436 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m01:20:03.057117 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:20:03.058319 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m01:20:03.059238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:03.069926 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m01:20:03.070810 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:20:03.071507 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:20:03.079079 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m01:20:03.081261 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m01:20:03.082344 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m01:20:03.095558 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:03.097168 [debug] [MainThread]: On master: BEGIN
[0m01:20:03.099066 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:20:03.127469 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:20:03.128800 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:03.129806 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:20:03.143196 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m01:20:03.145210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29127431-2685-4d12-9210-8df5e3e7cbfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda460a93d0>]}
[0m01:20:03.146065 [debug] [MainThread]: On master: ROLLBACK
[0m01:20:03.146981 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:03.147719 [debug] [MainThread]: On master: BEGIN
[0m01:20:03.148782 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:20:03.149615 [debug] [MainThread]: On master: COMMIT
[0m01:20:03.150338 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:03.150919 [debug] [MainThread]: On master: COMMIT
[0m01:20:03.151723 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:20:03.152294 [debug] [MainThread]: On master: Close
[0m01:20:03.153320 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:20:03.154275 [info ] [MainThread]: 
[0m01:20:03.173150 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m01:20:03.173530 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m01:20:03.173865 [debug] [Thread-3 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m01:20:03.174733 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m01:20:03.176055 [info ] [Thread-2 (]: 2 of 4 START sql view model public.worldbank_api_metrics ....................... [RUN]
[0m01:20:03.177362 [info ] [Thread-3 (]: 3 of 4 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m01:20:03.179240 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m01:20:03.180336 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m01:20:03.181499 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m01:20:03.182152 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m01:20:03.182941 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m01:20:03.183578 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m01:20:03.187673 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m01:20:03.191523 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:20:03.195374 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m01:20:03.199435 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-30 01:20:03.184281 => 2023-07-30 01:20:03.199254
[0m01:20:03.200211 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 01:20:03.188390 => 2023-07-30 01:20:03.200081
[0m01:20:03.200755 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m01:20:03.202149 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 01:20:03.192653 => 2023-07-30 01:20:03.202036
[0m01:20:03.202551 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m01:20:03.225852 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m01:20:03.269986 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m01:20:03.280467 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:20:03.284938 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m01:20:03.287546 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:20:03.288274 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:20:03.288724 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m01:20:03.289123 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:20:03.289285 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m01:20:03.289685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:03.290226 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m01:20:03.290742 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:20:03.291812 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:20:03.302861 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:20:03.303517 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:20:03.304172 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m01:20:03.305591 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m01:20:03.306436 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:20:03.307060 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  create view "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        MIN(gdp) as min_gdp_growth_since_2000,
        MAX(gdp) as max_gdp_growth_since_2000
    from filtered_data
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
[0m01:20:03.308078 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m01:20:03.308846 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "worldbank_api_stg" does not exist
LINE 12:     from worldbank_api_stg
                  ^

[0m01:20:03.314453 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m01:20:03.316000 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:20:03.316831 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: ROLLBACK
[0m01:20:03.317737 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:20:03.318409 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m01:20:03.319492 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 01:20:03.252967 => 2023-07-30 01:20:03.319420
[0m01:20:03.319711 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

generate_surrogate_key as (

    select 
        worldbank_api_indicator.id as worldbank_api_indicator_id,
        worldbank_api_indicator.value as worldbank_api_indicator_value,
        worldbank_api_country.id as worldbank_api_country_id,
        worldbank_api_country.value as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
)

select *
from generate_surrogate_key
  );
  
[0m01:20:03.320963 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m01:20:03.321227 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:20:03.324162 [debug] [Thread-3 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "worldbank_api_indicator"
LINE 15:         worldbank_api_indicator.id as worldbank_api_indicato...
                 ^

[0m01:20:03.328023 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:20:03.329438 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: ROLLBACK
[0m01:20:03.331191 [debug] [Thread-2 (]: Database Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)
  relation "worldbank_api_stg" does not exist
  LINE 12:     from worldbank_api_stg
                    ^
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m01:20:03.331439 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:20:03.332468 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 01:20:03.280739 => 2023-07-30 01:20:03.332398
[0m01:20:03.332856 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29127431-2685-4d12-9210-8df5e3e7cbfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda44874c90>]}
[0m01:20:03.333833 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m01:20:03.334115 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:20:03.334895 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.worldbank_api_metrics .............. [[31mERROR[0m in 0.15s]
[0m01:20:03.338923 [debug] [Thread-3 (]: Database Error in model worldbank_api_stg (models/example/worldbank_api_stg.sql)
  missing FROM-clause entry for table "worldbank_api_indicator"
  LINE 15:         worldbank_api_indicator.id as worldbank_api_indicato...
                   ^
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_stg.sql
[0m01:20:03.363087 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m01:20:03.366891 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:20:03.367763 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29127431-2685-4d12-9210-8df5e3e7cbfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda448c3fd0>]}
[0m01:20:03.369546 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:20:03.370346 [error] [Thread-3 (]: 3 of 4 ERROR creating sql table model public.worldbank_api_stg ................. [[31mERROR[0m in 0.19s]
[0m01:20:03.371579 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:20:03.372499 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m01:20:03.374302 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m01:20:03.379889 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:20:03.380811 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m01:20:03.386835 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m01:20:03.389476 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-30 01:20:03.203310 => 2023-07-30 01:20:03.389360
[0m01:20:03.390330 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m01:20:03.391991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29127431-2685-4d12-9210-8df5e3e7cbfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda448c9590>]}
[0m01:20:03.392999 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.21s]
[0m01:20:03.394118 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m01:20:03.396114 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m01:20:03.397428 [info ] [Thread-4 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m01:20:03.399167 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m01:20:03.400149 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m01:20:03.404038 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m01:20:03.406234 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-30 01:20:03.400975 => 2023-07-30 01:20:03.406139
[0m01:20:03.406984 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m01:20:03.412371 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m01:20:03.414391 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:20:03.414993 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m01:20:03.415534 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:20:03.426733 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m01:20:03.427989 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:20:03.428916 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m01:20:03.432949 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m01:20:03.438177 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:20:03.439112 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m01:20:03.440885 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:20:03.443083 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:20:03.443699 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:20:03.444309 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:20:03.445568 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m01:20:03.448175 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:20:03.448868 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m01:20:03.449866 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m01:20:03.451529 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-30 01:20:03.408001 => 2023-07-30 01:20:03.451453
[0m01:20:03.452209 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m01:20:03.453306 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29127431-2685-4d12-9210-8df5e3e7cbfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda46972fd0>]}
[0m01:20:03.454206 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.05s]
[0m01:20:03.455232 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m01:20:03.458798 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:20:03.459455 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:03.460061 [debug] [MainThread]: On master: BEGIN
[0m01:20:03.460616 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:20:03.470616 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:20:03.471435 [debug] [MainThread]: On master: COMMIT
[0m01:20:03.472079 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:03.472634 [debug] [MainThread]: On master: COMMIT
[0m01:20:03.473473 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:20:03.474103 [debug] [MainThread]: On master: Close
[0m01:20:03.475028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:20:03.475628 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m01:20:03.476224 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m01:20:03.476770 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m01:20:03.477309 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m01:20:03.478023 [info ] [MainThread]: 
[0m01:20:03.479029 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m01:20:03.480207 [debug] [MainThread]: Command end result
[0m01:20:03.490679 [info ] [MainThread]: 
[0m01:20:03.491895 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:20:03.493438 [info ] [MainThread]: 
[0m01:20:03.494982 [error] [MainThread]: [33mDatabase Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)[0m
[0m01:20:03.496253 [error] [MainThread]:   relation "worldbank_api_stg" does not exist
[0m01:20:03.497749 [error] [MainThread]:   LINE 12:     from worldbank_api_stg
[0m01:20:03.500333 [error] [MainThread]:                     ^
[0m01:20:03.501735 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m01:20:03.503121 [info ] [MainThread]: 
[0m01:20:03.504497 [error] [MainThread]: [33mDatabase Error in model worldbank_api_stg (models/example/worldbank_api_stg.sql)[0m
[0m01:20:03.505864 [error] [MainThread]:   missing FROM-clause entry for table "worldbank_api_indicator"
[0m01:20:03.507399 [error] [MainThread]:   LINE 15:         worldbank_api_indicator.id as worldbank_api_indicato...
[0m01:20:03.509154 [error] [MainThread]:                    ^
[0m01:20:03.510885 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_stg.sql
[0m01:20:03.512388 [info ] [MainThread]: 
[0m01:20:03.514058 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m01:20:03.515629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda460aaed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4835a290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda46879490>]}
[0m01:20:03.516752 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 01:23:03.614995 | 49c3a678-e87e-4b87-a282-45a453465604 ==============================
[0m01:23:03.614995 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:23:03.618271 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:23:03.619301 [debug] [MainThread]: Tracking: tracking
[0m01:23:03.622939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1693d7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb168b3c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb168adf890>]}
[0m01:23:03.638574 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:23:03.693686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:23:03.695455 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_stg.sql
[0m01:23:03.712663 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_stg.sql
[0m01:23:03.739071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49c3a678-e87e-4b87-a282-45a453465604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb167394210>]}
[0m01:23:03.752767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49c3a678-e87e-4b87-a282-45a453465604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb167441090>]}
[0m01:23:03.753771 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:23:03.755144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49c3a678-e87e-4b87-a282-45a453465604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb168bb6a50>]}
[0m01:23:03.757982 [info ] [MainThread]: 
[0m01:23:03.762321 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:23:03.765039 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m01:23:03.777471 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m01:23:03.778418 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m01:23:03.779214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:03.792760 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:23:03.795017 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m01:23:03.798050 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m01:23:03.805312 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:23:03.806248 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m01:23:03.806946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:23:03.816767 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m01:23:03.818277 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:23:03.819085 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:23:03.827539 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m01:23:03.829917 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m01:23:03.831515 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m01:23:03.840012 [debug] [MainThread]: Using postgres connection "master"
[0m01:23:03.840827 [debug] [MainThread]: On master: BEGIN
[0m01:23:03.841510 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:23:03.853122 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:23:03.854253 [debug] [MainThread]: Using postgres connection "master"
[0m01:23:03.855371 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:23:03.870446 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m01:23:03.872740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49c3a678-e87e-4b87-a282-45a453465604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb168bb6a50>]}
[0m01:23:03.873969 [debug] [MainThread]: On master: ROLLBACK
[0m01:23:03.875540 [debug] [MainThread]: Using postgres connection "master"
[0m01:23:03.876764 [debug] [MainThread]: On master: BEGIN
[0m01:23:03.878385 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:23:03.879617 [debug] [MainThread]: On master: COMMIT
[0m01:23:03.880493 [debug] [MainThread]: Using postgres connection "master"
[0m01:23:03.881321 [debug] [MainThread]: On master: COMMIT
[0m01:23:03.882637 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:23:03.883807 [debug] [MainThread]: On master: Close
[0m01:23:03.885500 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:23:03.886751 [info ] [MainThread]: 
[0m01:23:03.916442 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m01:23:03.917220 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m01:23:03.917820 [debug] [Thread-3 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m01:23:03.920119 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m01:23:03.922437 [info ] [Thread-2 (]: 2 of 4 START sql view model public.worldbank_api_metrics ....................... [RUN]
[0m01:23:03.924558 [info ] [Thread-3 (]: 3 of 4 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m01:23:03.926849 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m01:23:03.928700 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m01:23:03.931107 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m01:23:03.933143 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m01:23:03.935148 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m01:23:03.936535 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m01:23:03.944134 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m01:23:03.947903 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:23:03.953252 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m01:23:03.960526 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-30 01:23:03.938048 => 2023-07-30 01:23:03.960383
[0m01:23:03.961009 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 01:23:03.945179 => 2023-07-30 01:23:03.960937
[0m01:23:03.961834 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 01:23:03.949266 => 2023-07-30 01:23:03.961740
[0m01:23:03.962240 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m01:23:03.963326 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m01:23:03.964245 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m01:23:04.048397 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:23:04.051864 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m01:23:04.054486 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m01:23:04.058198 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:23:04.058776 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:23:04.059051 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m01:23:04.059266 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:23:04.059907 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m01:23:04.060559 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:23:04.061195 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m01:23:04.061784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:04.063478 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:23:04.075677 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:23:04.076373 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m01:23:04.076619 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m01:23:04.077275 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:23:04.078247 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:23:04.079487 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:23:04.080208 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m01:23:04.080938 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  create view "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        MIN(gdp) as min_gdp_growth_since_2000,
        MAX(gdp) as max_gdp_growth_since_2000
    from filtered_data
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
[0m01:23:04.082064 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

generate_surrogate_key as (

    select 
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
)

select *
from generate_surrogate_key
  );
  
[0m01:23:04.086264 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m01:23:04.086552 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "worldbank_api_stg" does not exist
LINE 12:     from worldbank_api_stg
                  ^

[0m01:23:04.096260 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:23:04.097009 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: ROLLBACK
[0m01:23:04.097718 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m01:23:04.099077 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 01:23:03.987351 => 2023-07-30 01:23:04.098948
[0m01:23:04.100520 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m01:23:04.100837 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:23:04.107170 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:23:04.108682 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:23:04.112311 [debug] [Thread-2 (]: Database Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)
  relation "worldbank_api_stg" does not exist
  LINE 12:     from worldbank_api_stg
                    ^
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m01:23:04.112721 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:23:04.113706 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c3a678-e87e-4b87-a282-45a453465604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1673e0450>]}
[0m01:23:04.131805 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.worldbank_api_metrics .............. [[31mERROR[0m in 0.19s]
[0m01:23:04.143729 [debug] [Thread-3 (]: SQL status: SELECT 16758 in 0 seconds
[0m01:23:04.152850 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m01:23:04.154587 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:23:04.158411 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:23:04.160338 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:23:04.161366 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m01:23:04.162126 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:23:04.163591 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:23:04.167696 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m01:23:04.168008 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m01:23:04.168902 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:23:04.177513 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:23:04.178436 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m01:23:04.179846 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m01:23:04.182106 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m01:23:04.184920 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:23:04.185525 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m01:23:04.186638 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0 seconds
[0m01:23:04.186876 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m01:23:04.188926 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 01:23:04.042689 => 2023-07-30 01:23:04.188861
[0m01:23:04.191492 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-30 01:23:03.965143 => 2023-07-30 01:23:04.191435
[0m01:23:04.192580 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m01:23:04.193552 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m01:23:04.195202 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c3a678-e87e-4b87-a282-45a453465604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16416f750>]}
[0m01:23:04.196575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c3a678-e87e-4b87-a282-45a453465604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb167305bd0>]}
[0m01:23:04.197594 [info ] [Thread-3 (]: 3 of 4 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.26s]
[0m01:23:04.199104 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.27s]
[0m01:23:04.200430 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m01:23:04.201484 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m01:23:04.204634 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m01:23:04.205501 [info ] [Thread-4 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m01:23:04.207119 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m01:23:04.207888 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m01:23:04.212854 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m01:23:04.215142 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-30 01:23:04.208664 => 2023-07-30 01:23:04.215005
[0m01:23:04.215851 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m01:23:04.220797 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m01:23:04.223655 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:23:04.224582 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m01:23:04.225204 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:23:04.234659 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m01:23:04.235554 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:23:04.236221 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m01:23:04.239931 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m01:23:04.242972 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:23:04.243587 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m01:23:04.245143 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:23:04.247847 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:23:04.248644 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:23:04.249458 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:23:04.251607 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m01:23:04.254373 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:23:04.255104 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m01:23:04.256381 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m01:23:04.258365 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-30 01:23:04.216579 => 2023-07-30 01:23:04.258300
[0m01:23:04.259075 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m01:23:04.260320 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c3a678-e87e-4b87-a282-45a453465604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1693d6390>]}
[0m01:23:04.261264 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.05s]
[0m01:23:04.262271 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m01:23:04.265967 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:23:04.266675 [debug] [MainThread]: Using postgres connection "master"
[0m01:23:04.267285 [debug] [MainThread]: On master: BEGIN
[0m01:23:04.267854 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:23:04.276900 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:23:04.277748 [debug] [MainThread]: On master: COMMIT
[0m01:23:04.278429 [debug] [MainThread]: Using postgres connection "master"
[0m01:23:04.279056 [debug] [MainThread]: On master: COMMIT
[0m01:23:04.279902 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:23:04.280543 [debug] [MainThread]: On master: Close
[0m01:23:04.281437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:23:04.282218 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m01:23:04.282941 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m01:23:04.283837 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m01:23:04.284391 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m01:23:04.284909 [info ] [MainThread]: 
[0m01:23:04.285651 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m01:23:04.286787 [debug] [MainThread]: Command end result
[0m01:23:04.296530 [info ] [MainThread]: 
[0m01:23:04.298228 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:23:04.299677 [info ] [MainThread]: 
[0m01:23:04.301086 [error] [MainThread]: [33mDatabase Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)[0m
[0m01:23:04.302338 [error] [MainThread]:   relation "worldbank_api_stg" does not exist
[0m01:23:04.303374 [error] [MainThread]:   LINE 12:     from worldbank_api_stg
[0m01:23:04.304553 [error] [MainThread]:                     ^
[0m01:23:04.305636 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m01:23:04.306873 [info ] [MainThread]: 
[0m01:23:04.308166 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m01:23:04.309296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16b3027d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb168aff850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb168afc310>]}
[0m01:23:04.310442 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 01:24:21.906398 | 22cc21b2-547f-47c3-9287-ea529e6a7d28 ==============================
[0m01:24:21.906398 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:24:21.909152 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:24:21.910259 [debug] [MainThread]: Tracking: tracking
[0m01:24:21.913395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73480aca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734b563450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7347f7c8d0>]}
[0m01:24:21.929326 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:24:21.976481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:24:21.977789 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_stg.sql
[0m01:24:21.996021 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_stg.sql
[0m01:24:22.019527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22cc21b2-547f-47c3-9287-ea529e6a7d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73480acd90>]}
[0m01:24:22.035029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22cc21b2-547f-47c3-9287-ea529e6a7d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7346056dd0>]}
[0m01:24:22.036111 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:24:22.037210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22cc21b2-547f-47c3-9287-ea529e6a7d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7347fed110>]}
[0m01:24:22.039697 [info ] [MainThread]: 
[0m01:24:22.043687 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:24:22.046122 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m01:24:22.057967 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m01:24:22.058719 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m01:24:22.059265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:22.073139 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:24:22.075479 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m01:24:22.077873 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m01:24:22.084738 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:24:22.085550 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m01:24:22.086304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:24:22.096653 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m01:24:22.098160 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:24:22.098690 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:24:22.105703 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:24:22.107612 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m01:24:22.108588 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m01:24:22.116223 [debug] [MainThread]: Using postgres connection "master"
[0m01:24:22.117112 [debug] [MainThread]: On master: BEGIN
[0m01:24:22.117731 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:24:22.126785 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:24:22.127713 [debug] [MainThread]: Using postgres connection "master"
[0m01:24:22.128382 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:24:22.142157 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m01:24:22.144203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22cc21b2-547f-47c3-9287-ea529e6a7d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734779c290>]}
[0m01:24:22.145159 [debug] [MainThread]: On master: ROLLBACK
[0m01:24:22.146203 [debug] [MainThread]: Using postgres connection "master"
[0m01:24:22.146888 [debug] [MainThread]: On master: BEGIN
[0m01:24:22.148150 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:24:22.149238 [debug] [MainThread]: On master: COMMIT
[0m01:24:22.149930 [debug] [MainThread]: Using postgres connection "master"
[0m01:24:22.150441 [debug] [MainThread]: On master: COMMIT
[0m01:24:22.151180 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:24:22.151732 [debug] [MainThread]: On master: Close
[0m01:24:22.152648 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:24:22.153670 [info ] [MainThread]: 
[0m01:24:22.176789 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m01:24:22.177250 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m01:24:22.177652 [debug] [Thread-3 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m01:24:22.178463 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m01:24:22.179565 [info ] [Thread-2 (]: 2 of 4 START sql view model public.worldbank_api_metrics ....................... [RUN]
[0m01:24:22.180882 [info ] [Thread-3 (]: 3 of 4 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m01:24:22.182356 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m01:24:22.183471 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m01:24:22.184629 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m01:24:22.185291 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m01:24:22.186172 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m01:24:22.186848 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m01:24:22.191586 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m01:24:22.195199 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:24:22.199092 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m01:24:22.202407 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-30 01:24:22.187342 => 2023-07-30 01:24:22.202231
[0m01:24:22.203024 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 01:24:22.192532 => 2023-07-30 01:24:22.202957
[0m01:24:22.203480 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m01:24:22.203736 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 01:24:22.196368 => 2023-07-30 01:24:22.203685
[0m01:24:22.204273 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m01:24:22.227322 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m01:24:22.257016 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m01:24:22.272853 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:24:22.276866 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m01:24:22.280344 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:24:22.281707 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m01:24:22.282040 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:24:22.283188 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:24:22.283427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:22.284026 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m01:24:22.284667 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m01:24:22.285896 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:24:22.286704 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:24:22.298343 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m01:24:22.299061 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:24:22.299998 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:24:22.301165 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:24:22.301462 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m01:24:22.302377 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

generate_surrogate_key as (

    select 
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>"id" as worldbank_api_country_id,
        worldbank_api_country->>"value" as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
)

select *
from generate_surrogate_key
  );
  
[0m01:24:22.302968 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m01:24:22.303412 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:24:22.305045 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  create view "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        MIN(gdp) as min_gdp_growth_since_2000,
        MAX(gdp) as max_gdp_growth_since_2000
    from filtered_data
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
[0m01:24:22.306581 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "worldbank_api_country_value" does not exist
LINE 9:         worldbank_api_country_value as country,
                ^

[0m01:24:22.307497 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m01:24:22.307798 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 17:         worldbank_api_country->>"id" as worldbank_api_countr...
                                         ^

[0m01:24:22.308116 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: ROLLBACK
[0m01:24:22.314778 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:24:22.315417 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: ROLLBACK
[0m01:24:22.316674 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 01:24:22.249178 => 2023-07-30 01:24:22.316591
[0m01:24:22.316970 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m01:24:22.318235 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 01:24:22.273099 => 2023-07-30 01:24:22.318131
[0m01:24:22.318518 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m01:24:22.319811 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m01:24:22.320150 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:24:22.328581 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:24:22.329907 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:24:22.332544 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:24:22.335031 [debug] [Thread-3 (]: Database Error in model worldbank_api_stg (models/example/worldbank_api_stg.sql)
  column "id" does not exist
  LINE 17:         worldbank_api_country->>"id" as worldbank_api_countr...
                                           ^
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_stg.sql
[0m01:24:22.336351 [debug] [Thread-2 (]: Database Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)
  column "worldbank_api_country_value" does not exist
  LINE 9:         worldbank_api_country_value as country,
                  ^
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m01:24:22.354624 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22cc21b2-547f-47c3-9287-ea529e6a7d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73460fca50>]}
[0m01:24:22.363468 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:24:22.364398 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22cc21b2-547f-47c3-9287-ea529e6a7d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7345f97390>]}
[0m01:24:22.365542 [error] [Thread-3 (]: 3 of 4 ERROR creating sql table model public.worldbank_api_stg ................. [[31mERROR[0m in 0.17s]
[0m01:24:22.366872 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:24:22.368169 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.worldbank_api_metrics .............. [[31mERROR[0m in 0.18s]
[0m01:24:22.370590 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m01:24:22.371392 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:24:22.372245 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m01:24:22.374681 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m01:24:22.380230 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:24:22.381122 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m01:24:22.386013 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m01:24:22.387915 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-30 01:24:22.204828 => 2023-07-30 01:24:22.387858
[0m01:24:22.388747 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m01:24:22.390423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22cc21b2-547f-47c3-9287-ea529e6a7d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7346099c10>]}
[0m01:24:22.391466 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.21s]
[0m01:24:22.392410 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m01:24:22.394012 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m01:24:22.394652 [info ] [Thread-4 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m01:24:22.395737 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m01:24:22.396244 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m01:24:22.399105 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m01:24:22.400860 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-30 01:24:22.396597 => 2023-07-30 01:24:22.400759
[0m01:24:22.401665 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m01:24:22.407325 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m01:24:22.409477 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:24:22.410111 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m01:24:22.411045 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:24:22.421599 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m01:24:22.422687 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:24:22.423381 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m01:24:22.427881 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m01:24:22.434430 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:24:22.435142 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m01:24:22.436566 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:24:22.438589 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:24:22.439128 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:24:22.439707 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:24:22.441262 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m01:24:22.443559 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:24:22.444116 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m01:24:22.444906 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m01:24:22.446743 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-30 01:24:22.402459 => 2023-07-30 01:24:22.446679
[0m01:24:22.447554 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m01:24:22.448707 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22cc21b2-547f-47c3-9287-ea529e6a7d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7346023fd0>]}
[0m01:24:22.449688 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.05s]
[0m01:24:22.450751 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m01:24:22.453863 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:24:22.454474 [debug] [MainThread]: Using postgres connection "master"
[0m01:24:22.454924 [debug] [MainThread]: On master: BEGIN
[0m01:24:22.455494 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:24:22.465771 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:24:22.466673 [debug] [MainThread]: On master: COMMIT
[0m01:24:22.467287 [debug] [MainThread]: Using postgres connection "master"
[0m01:24:22.467826 [debug] [MainThread]: On master: COMMIT
[0m01:24:22.468410 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:24:22.468802 [debug] [MainThread]: On master: Close
[0m01:24:22.469733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:24:22.470282 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m01:24:22.470708 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m01:24:22.471213 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m01:24:22.471690 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m01:24:22.472318 [info ] [MainThread]: 
[0m01:24:22.473567 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m01:24:22.475189 [debug] [MainThread]: Command end result
[0m01:24:22.485060 [info ] [MainThread]: 
[0m01:24:22.486205 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:24:22.487486 [info ] [MainThread]: 
[0m01:24:22.489244 [error] [MainThread]: [33mDatabase Error in model worldbank_api_stg (models/example/worldbank_api_stg.sql)[0m
[0m01:24:22.490825 [error] [MainThread]:   column "id" does not exist
[0m01:24:22.492527 [error] [MainThread]:   LINE 17:         worldbank_api_country->>"id" as worldbank_api_countr...
[0m01:24:22.494024 [error] [MainThread]:                                            ^
[0m01:24:22.495772 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_stg.sql
[0m01:24:22.497417 [info ] [MainThread]: 
[0m01:24:22.498557 [error] [MainThread]: [33mDatabase Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)[0m
[0m01:24:22.499733 [error] [MainThread]:   column "worldbank_api_country_value" does not exist
[0m01:24:22.500944 [error] [MainThread]:   LINE 9:         worldbank_api_country_value as country,
[0m01:24:22.502450 [error] [MainThread]:                   ^
[0m01:24:22.503788 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m01:24:22.505469 [info ] [MainThread]: 
[0m01:24:22.507053 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m01:24:22.509259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7345f4fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734779d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734779c350>]}
[0m01:24:22.510812 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 01:26:14.142967 | 55f8a528-72ec-4521-90c8-ecad8342d39f ==============================
[0m01:26:14.142967 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:26:14.145982 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:26:14.147038 [debug] [MainThread]: Tracking: tracking
[0m01:26:14.151275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d5816390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d5816010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d5497590>]}
[0m01:26:14.164525 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:26:14.270387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:26:14.271551 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_stg.sql
[0m01:26:14.287980 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_stg.sql
[0m01:26:14.315419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55f8a528-72ec-4521-90c8-ecad8342d39f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d55a5190>]}
[0m01:26:14.334420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55f8a528-72ec-4521-90c8-ecad8342d39f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d5512c50>]}
[0m01:26:14.335729 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:26:14.337066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55f8a528-72ec-4521-90c8-ecad8342d39f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d5804dd0>]}
[0m01:26:14.339991 [info ] [MainThread]: 
[0m01:26:14.346059 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:26:14.348593 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m01:26:14.369514 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m01:26:14.370646 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m01:26:14.371481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:26:14.401376 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:26:14.404334 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m01:26:14.407167 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m01:26:14.414767 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:26:14.415953 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m01:26:14.416907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:26:14.426075 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m01:26:14.427065 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:26:14.427676 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:26:14.439110 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:26:14.441557 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m01:26:14.442960 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m01:26:14.451560 [debug] [MainThread]: Using postgres connection "master"
[0m01:26:14.452603 [debug] [MainThread]: On master: BEGIN
[0m01:26:14.453374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:26:14.479097 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:26:14.480221 [debug] [MainThread]: Using postgres connection "master"
[0m01:26:14.480932 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:26:14.541606 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m01:26:14.544525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55f8a528-72ec-4521-90c8-ecad8342d39f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d5805490>]}
[0m01:26:14.545947 [debug] [MainThread]: On master: ROLLBACK
[0m01:26:14.547063 [debug] [MainThread]: Using postgres connection "master"
[0m01:26:14.547738 [debug] [MainThread]: On master: BEGIN
[0m01:26:14.548811 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:26:14.549779 [debug] [MainThread]: On master: COMMIT
[0m01:26:14.550615 [debug] [MainThread]: Using postgres connection "master"
[0m01:26:14.551348 [debug] [MainThread]: On master: COMMIT
[0m01:26:14.552196 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:26:14.552776 [debug] [MainThread]: On master: Close
[0m01:26:14.553841 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:26:14.554768 [info ] [MainThread]: 
[0m01:26:14.574296 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m01:26:14.574781 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m01:26:14.575130 [debug] [Thread-3 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m01:26:14.576241 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m01:26:14.580033 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m01:26:14.578733 [info ] [Thread-3 (]: 3 of 4 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m01:26:14.577869 [info ] [Thread-2 (]: 2 of 4 START sql view model public.worldbank_api_metrics ....................... [RUN]
[0m01:26:14.580789 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m01:26:14.581807 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m01:26:14.582728 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m01:26:14.587052 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m01:26:14.587944 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m01:26:14.589020 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m01:26:14.593045 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m01:26:14.597088 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:26:14.599026 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-30 01:26:14.583342 => 2023-07-30 01:26:14.598873
[0m01:26:14.600387 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m01:26:14.600822 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 01:26:14.590471 => 2023-07-30 01:26:14.600736
[0m01:26:14.601395 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 01:26:14.593956 => 2023-07-30 01:26:14.601326
[0m01:26:14.623973 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m01:26:14.646135 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m01:26:14.648296 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m01:26:14.654195 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m01:26:14.675248 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:26:14.678126 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:26:14.679282 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m01:26:14.679784 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:26:14.680199 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:26:14.680539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:26:14.681096 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m01:26:14.681649 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m01:26:14.683251 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:26:14.683948 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:26:14.692682 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:26:14.694460 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:26:14.695293 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m01:26:14.697127 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m01:26:14.697914 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:26:14.698557 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  create view "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        MIN(gdp) as min_gdp_growth_since_2000,
        MAX(gdp) as max_gdp_growth_since_2000
    from filtered_data
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
[0m01:26:14.700227 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "worldbank_api_country_value" does not exist
LINE 9:         worldbank_api_country_value as country,
                ^

[0m01:26:14.700991 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m01:26:14.701780 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: ROLLBACK
[0m01:26:14.710342 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:26:14.710973 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m01:26:14.712876 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 01:26:14.655118 => 2023-07-30 01:26:14.712722
[0m01:26:14.713166 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m01:26:14.713962 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:26:14.714614 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m01:26:14.716034 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

generate_surrogate_key as (

    select 
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
)

select *
from generate_surrogate_key
  );
  
[0m01:26:14.716287 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:26:14.722830 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:26:14.724141 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:26:14.725755 [debug] [Thread-2 (]: Database Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)
  column "worldbank_api_country_value" does not exist
  LINE 9:         worldbank_api_country_value as country,
                  ^
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m01:26:14.732627 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55f8a528-72ec-4521-90c8-ecad8342d39f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d39acfd0>]}
[0m01:26:14.733083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:26:14.734050 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.worldbank_api_metrics .............. [[31mERROR[0m in 0.15s]
[0m01:26:14.753067 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m01:26:14.762363 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:26:14.763391 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:26:14.764055 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:26:14.767303 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m01:26:14.773950 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:26:14.775048 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m01:26:14.782154 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m01:26:14.784444 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-30 01:26:14.601628 => 2023-07-30 01:26:14.784377
[0m01:26:14.785304 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m01:26:14.787055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55f8a528-72ec-4521-90c8-ecad8342d39f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d385dc10>]}
[0m01:26:14.788179 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.21s]
[0m01:26:14.789222 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m01:26:14.790470 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m01:26:14.791265 [info ] [Thread-4 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m01:26:14.793066 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m01:26:14.794083 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m01:26:14.797966 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m01:26:14.800999 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-30 01:26:14.794878 => 2023-07-30 01:26:14.800851
[0m01:26:14.801840 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m01:26:14.807058 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m01:26:14.810001 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:26:14.812346 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m01:26:14.813270 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:26:14.820657 [debug] [Thread-3 (]: SQL status: SELECT 16758 in 0 seconds
[0m01:26:14.830212 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:26:14.831290 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m01:26:14.831985 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m01:26:14.833770 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:26:14.834291 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:26:14.835370 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m01:26:14.839820 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:26:14.841977 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m01:26:14.844181 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:26:14.850191 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m01:26:14.851055 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m01:26:14.852643 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:26:14.856495 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:26:14.857662 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m01:26:14.858812 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m01:26:14.861271 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:26:14.863729 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:26:14.864572 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:26:14.864863 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m01:26:14.865596 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:26:14.868383 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:26:14.869952 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m01:26:14.870237 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m01:26:14.873588 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:26:14.874797 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m01:26:14.875544 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0 seconds
[0m01:26:14.880229 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 01:26:14.650120 => 2023-07-30 01:26:14.880093
[0m01:26:14.880721 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m01:26:14.881879 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m01:26:14.885440 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-30 01:26:14.802454 => 2023-07-30 01:26:14.885348
[0m01:26:14.887831 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55f8a528-72ec-4521-90c8-ecad8342d39f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d2f5e510>]}
[0m01:26:14.888963 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m01:26:14.890909 [info ] [Thread-3 (]: 3 of 4 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.31s]
[0m01:26:14.893703 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55f8a528-72ec-4521-90c8-ecad8342d39f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d2f22150>]}
[0m01:26:14.894884 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m01:26:14.896892 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.10s]
[0m01:26:14.900087 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m01:26:14.904410 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:26:14.905191 [debug] [MainThread]: Using postgres connection "master"
[0m01:26:14.905773 [debug] [MainThread]: On master: BEGIN
[0m01:26:14.906359 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:26:14.919238 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:26:14.920277 [debug] [MainThread]: On master: COMMIT
[0m01:26:14.920871 [debug] [MainThread]: Using postgres connection "master"
[0m01:26:14.921425 [debug] [MainThread]: On master: COMMIT
[0m01:26:14.922326 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:26:14.922915 [debug] [MainThread]: On master: Close
[0m01:26:14.923949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:26:14.924636 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m01:26:14.925144 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m01:26:14.925567 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m01:26:14.926037 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m01:26:14.926755 [info ] [MainThread]: 
[0m01:26:14.928051 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m01:26:14.929385 [debug] [MainThread]: Command end result
[0m01:26:14.941702 [info ] [MainThread]: 
[0m01:26:14.944041 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:26:14.945849 [info ] [MainThread]: 
[0m01:26:14.948008 [error] [MainThread]: [33mDatabase Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)[0m
[0m01:26:14.950002 [error] [MainThread]:   column "worldbank_api_country_value" does not exist
[0m01:26:14.952822 [error] [MainThread]:   LINE 9:         worldbank_api_country_value as country,
[0m01:26:14.954696 [error] [MainThread]:                   ^
[0m01:26:14.956056 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m01:26:14.957462 [info ] [MainThread]: 
[0m01:26:14.958886 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m01:26:14.961238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d5771310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d57705d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d2f52b10>]}
[0m01:26:14.962856 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 01:32:17.870647 | bc2b0629-c212-44c6-8bc2-a59e9d66f766 ==============================
[0m01:32:17.870647 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:32:17.873511 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:32:17.874765 [debug] [MainThread]: Tracking: tracking
[0m01:32:17.878019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedab3f36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedaaef8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedaae7ae90>]}
[0m01:32:17.892724 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:32:17.962374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:32:17.963581 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:32:17.972914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc2b0629-c212-44c6-8bc2-a59e9d66f766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedab1b9a50>]}
[0m01:32:17.992513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc2b0629-c212-44c6-8bc2-a59e9d66f766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feda96ed710>]}
[0m01:32:17.993435 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:32:17.994614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc2b0629-c212-44c6-8bc2-a59e9d66f766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedab716f50>]}
[0m01:32:17.996663 [info ] [MainThread]: 
[0m01:32:18.000149 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:32:18.003361 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m01:32:18.021572 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m01:32:18.022619 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m01:32:18.023292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:32:18.037120 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:32:18.038781 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m01:32:18.041384 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m01:32:18.047933 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:32:18.048779 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m01:32:18.049541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:32:18.059420 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m01:32:18.061769 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:32:18.063271 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:32:18.077349 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:32:18.080034 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m01:32:18.081521 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m01:32:18.089502 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:18.090387 [debug] [MainThread]: On master: BEGIN
[0m01:32:18.091226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:32:18.111565 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:32:18.113608 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:18.115764 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:32:18.157560 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m01:32:18.159757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc2b0629-c212-44c6-8bc2-a59e9d66f766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feda96db450>]}
[0m01:32:18.160611 [debug] [MainThread]: On master: ROLLBACK
[0m01:32:18.161671 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:18.162411 [debug] [MainThread]: On master: BEGIN
[0m01:32:18.163851 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:32:18.165193 [debug] [MainThread]: On master: COMMIT
[0m01:32:18.165853 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:18.166445 [debug] [MainThread]: On master: COMMIT
[0m01:32:18.167291 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:32:18.167931 [debug] [MainThread]: On master: Close
[0m01:32:18.168946 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:32:18.170064 [info ] [MainThread]: 
[0m01:32:18.187791 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m01:32:18.188271 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m01:32:18.188608 [debug] [Thread-3 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m01:32:18.189606 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m01:32:18.190644 [info ] [Thread-2 (]: 2 of 4 START sql view model public.worldbank_api_metrics ....................... [RUN]
[0m01:32:18.191905 [info ] [Thread-3 (]: 3 of 4 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m01:32:18.193237 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m01:32:18.194225 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m01:32:18.195220 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m01:32:18.195944 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m01:32:18.196442 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m01:32:18.197041 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m01:32:18.200327 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m01:32:18.205404 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:32:18.208608 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m01:32:18.212238 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-30 01:32:18.197631 => 2023-07-30 01:32:18.212135
[0m01:32:18.212495 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 01:32:18.201085 => 2023-07-30 01:32:18.212425
[0m01:32:18.212984 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 01:32:18.206319 => 2023-07-30 01:32:18.212902
[0m01:32:18.213249 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m01:32:18.213882 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m01:32:18.214540 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m01:32:18.308757 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:32:18.319005 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m01:32:18.322499 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m01:32:18.327390 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:32:18.327842 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:32:18.328242 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m01:32:18.328874 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:32:18.329075 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m01:32:18.329684 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:32:18.330107 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m01:32:18.330783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:18.331781 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:32:18.345692 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:32:18.346641 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:32:18.347348 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m01:32:18.351429 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m01:32:18.351916 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m01:32:18.359387 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:32:18.359668 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m01:32:18.360376 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:32:18.361160 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m01:32:18.361651 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:32:18.362269 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  create view "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        MIN(gdp) as min_gdp_growth_since_2000,
        MAX(gdp) as max_gdp_growth_since_2000
    from filtered_data
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
[0m01:32:18.363294 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

generate_surrogate_key as (

    select 
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
)

select *
from generate_surrogate_key
  );
  
[0m01:32:18.364658 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:32:18.368658 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:32:18.368985 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "filtered_data.country" must appear in the GROUP BY clause or be used in an aggregate function
LINE 20:         country,
                 ^

[0m01:32:18.369566 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:32:18.370007 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: ROLLBACK
[0m01:32:18.371303 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 01:32:18.232173 => 2023-07-30 01:32:18.371225
[0m01:32:18.371595 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:32:18.373276 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m01:32:18.401285 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:32:18.403508 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:32:18.408560 [debug] [Thread-2 (]: Database Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)
  column "filtered_data.country" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 20:         country,
                   ^
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m01:32:18.408866 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:32:18.409735 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc2b0629-c212-44c6-8bc2-a59e9d66f766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedaaf01950>]}
[0m01:32:18.411162 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.worldbank_api_metrics .............. [[31mERROR[0m in 0.22s]
[0m01:32:18.413939 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m01:32:18.414186 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m01:32:18.420385 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:32:18.420924 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m01:32:18.426289 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m01:32:18.428351 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-30 01:32:18.215056 => 2023-07-30 01:32:18.428244
[0m01:32:18.429191 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m01:32:18.430411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc2b0629-c212-44c6-8bc2-a59e9d66f766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedab725510>]}
[0m01:32:18.431407 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.24s]
[0m01:32:18.432574 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m01:32:18.433815 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m01:32:18.434536 [info ] [Thread-4 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m01:32:18.436170 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m01:32:18.436788 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m01:32:18.440248 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m01:32:18.442517 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-30 01:32:18.437395 => 2023-07-30 01:32:18.442428
[0m01:32:18.443085 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m01:32:18.448142 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m01:32:18.450547 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:32:18.451224 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m01:32:18.451944 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:32:18.469849 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m01:32:18.470858 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:32:18.471480 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m01:32:18.478823 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m01:32:18.482110 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:32:18.482934 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m01:32:18.483836 [debug] [Thread-3 (]: SQL status: SELECT 16758 in 0 seconds
[0m01:32:18.486950 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:32:18.487293 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:32:18.488010 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m01:32:18.490015 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:32:18.491381 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:32:18.491698 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:32:18.492376 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:32:18.495136 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:32:18.496507 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m01:32:18.497692 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:32:18.500456 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m01:32:18.500688 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m01:32:18.501246 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:32:18.503822 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:32:18.504540 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m01:32:18.505273 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m01:32:18.506874 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m01:32:18.507156 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m01:32:18.508985 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-30 01:32:18.443613 => 2023-07-30 01:32:18.508910
[0m01:32:18.512280 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:32:18.513419 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m01:32:18.514202 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m01:32:18.515507 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc2b0629-c212-44c6-8bc2-a59e9d66f766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feda95ffb10>]}
[0m01:32:18.517014 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.08s]
[0m01:32:18.518253 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m01:32:18.520864 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0 seconds
[0m01:32:18.522697 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 01:32:18.277923 => 2023-07-30 01:32:18.522632
[0m01:32:18.523306 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m01:32:18.524333 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc2b0629-c212-44c6-8bc2-a59e9d66f766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feda9623e10>]}
[0m01:32:18.525089 [info ] [Thread-3 (]: 3 of 4 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.33s]
[0m01:32:18.526209 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m01:32:18.529428 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:32:18.530172 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:18.530707 [debug] [MainThread]: On master: BEGIN
[0m01:32:18.531329 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:32:18.540970 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:32:18.542104 [debug] [MainThread]: On master: COMMIT
[0m01:32:18.542726 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:18.543275 [debug] [MainThread]: On master: COMMIT
[0m01:32:18.544024 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:32:18.544647 [debug] [MainThread]: On master: Close
[0m01:32:18.545706 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:32:18.546396 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m01:32:18.547066 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m01:32:18.547685 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m01:32:18.548274 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m01:32:18.548860 [info ] [MainThread]: 
[0m01:32:18.549858 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m01:32:18.551767 [debug] [MainThread]: Command end result
[0m01:32:18.567472 [info ] [MainThread]: 
[0m01:32:18.568652 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:32:18.569835 [info ] [MainThread]: 
[0m01:32:18.570995 [error] [MainThread]: [33mDatabase Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)[0m
[0m01:32:18.572039 [error] [MainThread]:   column "filtered_data.country" must appear in the GROUP BY clause or be used in an aggregate function
[0m01:32:18.573769 [error] [MainThread]:   LINE 20:         country,
[0m01:32:18.576676 [error] [MainThread]:                    ^
[0m01:32:18.578763 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m01:32:18.580534 [info ] [MainThread]: 
[0m01:32:18.582283 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m01:32:18.585777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedaae0ef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedaaefa7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedaaefae90>]}
[0m01:32:18.587266 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 01:32:53.852577 | 20518b31-439f-4a04-aa06-5b18d17f8f83 ==============================
[0m01:32:53.852577 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:32:53.855271 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:32:53.856729 [debug] [MainThread]: Tracking: tracking
[0m01:32:53.859922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f32358310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f327d7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f32a99050>]}
[0m01:32:53.874656 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:32:53.927411 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:32:53.928450 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m01:32:53.944041 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m01:32:53.967448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20518b31-439f-4a04-aa06-5b18d17f8f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f326a7690>]}
[0m01:32:53.982062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20518b31-439f-4a04-aa06-5b18d17f8f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f32bd3d10>]}
[0m01:32:53.983176 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:32:53.984309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20518b31-439f-4a04-aa06-5b18d17f8f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f32cd3e90>]}
[0m01:32:53.987134 [info ] [MainThread]: 
[0m01:32:53.990452 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:32:53.992702 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m01:32:54.004181 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m01:32:54.004818 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m01:32:54.005382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:32:54.018658 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:32:54.021132 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m01:32:54.024044 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m01:32:54.031214 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:32:54.032085 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m01:32:54.032964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:32:54.055109 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m01:32:54.057987 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:32:54.059937 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:32:54.075936 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:32:54.078061 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m01:32:54.079106 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m01:32:54.086590 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:54.087674 [debug] [MainThread]: On master: BEGIN
[0m01:32:54.088490 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:32:54.099089 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:32:54.100202 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:54.100914 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:32:54.131083 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m01:32:54.133229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20518b31-439f-4a04-aa06-5b18d17f8f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f32adf850>]}
[0m01:32:54.134471 [debug] [MainThread]: On master: ROLLBACK
[0m01:32:54.135820 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:54.136785 [debug] [MainThread]: On master: BEGIN
[0m01:32:54.138081 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:32:54.139164 [debug] [MainThread]: On master: COMMIT
[0m01:32:54.139805 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:54.140342 [debug] [MainThread]: On master: COMMIT
[0m01:32:54.141176 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:32:54.141793 [debug] [MainThread]: On master: Close
[0m01:32:54.143149 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:32:54.144625 [info ] [MainThread]: 
[0m01:32:54.163670 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m01:32:54.164134 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m01:32:54.166403 [info ] [Thread-2 (]: 2 of 4 START sql view model public.worldbank_api_metrics ....................... [RUN]
[0m01:32:54.165406 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m01:32:54.164477 [debug] [Thread-3 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m01:32:54.168083 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m01:32:54.169202 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m01:32:54.170059 [info ] [Thread-3 (]: 3 of 4 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m01:32:54.170943 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m01:32:54.171804 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m01:32:54.173057 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m01:32:54.176992 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:32:54.180564 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m01:32:54.181679 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m01:32:54.186858 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m01:32:54.187610 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 01:32:54.173538 => 2023-07-30 01:32:54.187467
[0m01:32:54.188184 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-30 01:32:54.178003 => 2023-07-30 01:32:54.188119
[0m01:32:54.188920 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m01:32:54.189900 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m01:32:54.190139 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 01:32:54.183683 => 2023-07-30 01:32:54.190083
[0m01:32:54.250471 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:32:54.256743 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m01:32:54.262018 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m01:32:54.268173 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m01:32:54.270916 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:32:54.271668 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:32:54.272019 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m01:32:54.272853 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:32:54.273051 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m01:32:54.273683 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:32:54.274277 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m01:32:54.274832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:54.276453 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:32:54.284650 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m01:32:54.285598 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:32:54.286229 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  create view "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        MIN(gdp) as min_gdp_growth_since_2000,
        MAX(gdp) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
[0m01:32:54.293013 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m01:32:54.300194 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:32:54.301387 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m01:32:54.301871 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" rename to "worldbank_api_metrics"
[0m01:32:54.302220 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:32:54.303324 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:32:54.304888 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:32:54.305189 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:32:54.305783 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

generate_surrogate_key as (

    select 
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
)

select *
from generate_surrogate_key
  );
  
[0m01:32:54.306456 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m01:32:54.326359 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m01:32:54.328061 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:32:54.328894 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m01:32:54.330050 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m01:32:54.333308 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:32:54.333600 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m01:32:54.334153 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m01:32:54.339634 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:32:54.341264 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
drop view if exists "worldbank_api_db"."public"."worldbank_api_metrics__dbt_backup" cascade
[0m01:32:54.341468 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:32:54.342343 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m01:32:54.345139 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:32:54.346872 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 01:32:54.190564 => 2023-07-30 01:32:54.346812
[0m01:32:54.347465 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:32:54.348119 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m01:32:54.349733 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20518b31-439f-4a04-aa06-5b18d17f8f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f328ea890>]}
[0m01:32:54.349943 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:32:54.350686 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.worldbank_api_metrics .................. [[32mCREATE VIEW[0m in 0.18s]
[0m01:32:54.359247 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:32:54.361814 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m01:32:54.362560 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:32:54.364154 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:32:54.366375 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m01:32:54.369135 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:32:54.369800 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m01:32:54.374709 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m01:32:54.376515 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-30 01:32:54.213082 => 2023-07-30 01:32:54.376458
[0m01:32:54.377177 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m01:32:54.378233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20518b31-439f-4a04-aa06-5b18d17f8f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f30b8d410>]}
[0m01:32:54.379021 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.21s]
[0m01:32:54.380505 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m01:32:54.381771 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m01:32:54.382567 [info ] [Thread-4 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m01:32:54.384001 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m01:32:54.384663 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m01:32:54.390621 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m01:32:54.393961 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-30 01:32:54.385107 => 2023-07-30 01:32:54.393853
[0m01:32:54.394614 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m01:32:54.399989 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m01:32:54.402255 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:32:54.403036 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m01:32:54.404072 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:32:54.427695 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m01:32:54.429044 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:32:54.429422 [debug] [Thread-3 (]: SQL status: SELECT 16758 in 0 seconds
[0m01:32:54.430077 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m01:32:54.433038 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:32:54.434607 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m01:32:54.436779 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:32:54.439892 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:32:54.440161 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m01:32:54.440805 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m01:32:54.443728 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:32:54.444986 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m01:32:54.445167 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:32:54.448084 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m01:32:54.448298 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:32:54.448858 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:32:54.450797 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:32:54.451436 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m01:32:54.452063 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:32:54.453193 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:32:54.455031 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m01:32:54.455470 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m01:32:54.457472 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:32:54.459987 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:32:54.460776 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m01:32:54.461383 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m01:32:54.462867 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m01:32:54.464924 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-30 01:32:54.395114 => 2023-07-30 01:32:54.464855
[0m01:32:54.465685 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m01:32:54.467119 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20518b31-439f-4a04-aa06-5b18d17f8f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f30af9550>]}
[0m01:32:54.468096 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.08s]
[0m01:32:54.468722 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0 seconds
[0m01:32:54.469878 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m01:32:54.471725 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 01:32:54.264184 => 2023-07-30 01:32:54.471629
[0m01:32:54.473559 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m01:32:54.475203 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20518b31-439f-4a04-aa06-5b18d17f8f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f30b00c10>]}
[0m01:32:54.476687 [info ] [Thread-3 (]: 3 of 4 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.30s]
[0m01:32:54.478076 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m01:32:54.482110 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:32:54.482851 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:54.483404 [debug] [MainThread]: On master: BEGIN
[0m01:32:54.484055 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:32:54.495656 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:32:54.496855 [debug] [MainThread]: On master: COMMIT
[0m01:32:54.497903 [debug] [MainThread]: Using postgres connection "master"
[0m01:32:54.498705 [debug] [MainThread]: On master: COMMIT
[0m01:32:54.499930 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:32:54.500816 [debug] [MainThread]: On master: Close
[0m01:32:54.502161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:32:54.503172 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m01:32:54.504096 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m01:32:54.505032 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m01:32:54.505941 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m01:32:54.507258 [info ] [MainThread]: 
[0m01:32:54.508968 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m01:32:54.511188 [debug] [MainThread]: Command end result
[0m01:32:54.524830 [info ] [MainThread]: 
[0m01:32:54.526305 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:32:54.528013 [info ] [MainThread]: 
[0m01:32:54.529927 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:32:54.532330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f30b7c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f32b64c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f30badd10>]}
[0m01:32:54.536645 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 01:39:12.480166 | 46f23293-d83b-4032-bd6c-342ece415579 ==============================
[0m01:39:12.480166 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:39:12.483117 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:39:12.484355 [debug] [MainThread]: Tracking: tracking
[0m01:39:12.487633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe75943e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe759380bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe759748e50>]}
[0m01:39:12.500229 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:39:12.545308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:39:12.546420 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m01:39:12.564036 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m01:39:12.592142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46f23293-d83b-4032-bd6c-342ece415579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe758eb9210>]}
[0m01:39:12.608657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46f23293-d83b-4032-bd6c-342ece415579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe757786850>]}
[0m01:39:12.609482 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:39:12.610621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46f23293-d83b-4032-bd6c-342ece415579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7577083d0>]}
[0m01:39:12.612753 [info ] [MainThread]: 
[0m01:39:12.616512 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:39:12.619002 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m01:39:12.634306 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m01:39:12.635208 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m01:39:12.636027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:39:12.649848 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:39:12.652186 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m01:39:12.654977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m01:39:12.662661 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:39:12.663449 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m01:39:12.664139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:39:12.683007 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m01:39:12.684150 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:39:12.684781 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:39:12.699840 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:39:12.702117 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m01:39:12.703357 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m01:39:12.710993 [debug] [MainThread]: Using postgres connection "master"
[0m01:39:12.711825 [debug] [MainThread]: On master: BEGIN
[0m01:39:12.712632 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:39:12.722783 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:39:12.723838 [debug] [MainThread]: Using postgres connection "master"
[0m01:39:12.724651 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:39:12.745777 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m01:39:12.748020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46f23293-d83b-4032-bd6c-342ece415579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7577b8050>]}
[0m01:39:12.749020 [debug] [MainThread]: On master: ROLLBACK
[0m01:39:12.750701 [debug] [MainThread]: Using postgres connection "master"
[0m01:39:12.751547 [debug] [MainThread]: On master: BEGIN
[0m01:39:12.752642 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:39:12.753585 [debug] [MainThread]: On master: COMMIT
[0m01:39:12.754277 [debug] [MainThread]: Using postgres connection "master"
[0m01:39:12.754923 [debug] [MainThread]: On master: COMMIT
[0m01:39:12.755786 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:39:12.756411 [debug] [MainThread]: On master: Close
[0m01:39:12.757705 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:39:12.758569 [info ] [MainThread]: 
[0m01:39:12.778084 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m01:39:12.778543 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m01:39:12.778848 [debug] [Thread-3 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m01:39:12.779689 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m01:39:12.781029 [info ] [Thread-2 (]: 2 of 4 START sql view model public.worldbank_api_metrics ....................... [RUN]
[0m01:39:12.782882 [info ] [Thread-3 (]: 3 of 4 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m01:39:12.784394 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m01:39:12.786886 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m01:39:12.788186 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m01:39:12.788904 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m01:39:12.789582 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m01:39:12.790196 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m01:39:12.794029 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m01:39:12.799222 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:39:12.802712 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m01:39:12.806249 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-30 01:39:12.790652 => 2023-07-30 01:39:12.806159
[0m01:39:12.806553 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 01:39:12.795056 => 2023-07-30 01:39:12.806423
[0m01:39:12.806957 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 01:39:12.800154 => 2023-07-30 01:39:12.806907
[0m01:39:12.807171 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m01:39:12.807792 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m01:39:12.808398 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m01:39:12.924684 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:39:12.927149 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m01:39:12.930262 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m01:39:12.933873 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:39:12.934447 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:39:12.934745 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:39:12.934979 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m01:39:12.935981 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m01:39:12.936790 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m01:39:12.937602 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:39:12.938554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:12.939664 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:39:12.953231 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m01:39:12.954072 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:39:12.954639 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  create view "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        LAG(gdp,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date DESC) as previous_year_gdb
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        previous_year_gdb,
        MIN(gdp) as min_gdp_growth_since_2000,
        MAX(gdp) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
[0m01:39:12.956268 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "gdp" does not exist
LINE 12:         LAG(gdp,1) OVER (
                     ^

[0m01:39:12.957183 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: ROLLBACK
[0m01:39:12.958968 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 01:39:12.830933 => 2023-07-30 01:39:12.958870
[0m01:39:12.959591 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m01:39:12.963106 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:39:12.964934 [debug] [Thread-2 (]: Database Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)
  column "gdp" does not exist
  LINE 12:         LAG(gdp,1) OVER (
                       ^
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m01:39:12.965235 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:39:12.965521 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m01:39:12.966232 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46f23293-d83b-4032-bd6c-342ece415579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7577c2a90>]}
[0m01:39:12.967025 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m01:39:12.967585 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:39:12.968370 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.worldbank_api_metrics .............. [[31mERROR[0m in 0.18s]
[0m01:39:12.970352 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

generate_surrogate_key as (

    select 
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
)

select *
from generate_surrogate_key
  );
  
[0m01:39:12.972335 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m01:39:12.973283 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m01:39:12.981141 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:39:12.981728 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m01:39:12.983598 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:39:12.987035 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:39:12.988243 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:39:12.989774 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:39:13.020107 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:39:13.021334 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:39:13.022296 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:39:13.025361 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m01:39:13.035058 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:39:13.036234 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m01:39:13.043059 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m01:39:13.045044 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-30 01:39:12.808980 => 2023-07-30 01:39:13.044983
[0m01:39:13.045797 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m01:39:13.046986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46f23293-d83b-4032-bd6c-342ece415579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe757667710>]}
[0m01:39:13.048654 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.26s]
[0m01:39:13.050650 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m01:39:13.052636 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m01:39:13.053789 [info ] [Thread-4 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m01:39:13.055750 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m01:39:13.056660 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m01:39:13.060760 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m01:39:13.063221 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-30 01:39:13.057365 => 2023-07-30 01:39:13.063105
[0m01:39:13.064025 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m01:39:13.070604 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m01:39:13.070974 [debug] [Thread-3 (]: SQL status: SELECT 16758 in 0 seconds
[0m01:39:13.075307 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:39:13.076513 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m01:39:13.076886 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:39:13.077923 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m01:39:13.078421 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:39:13.079027 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:39:13.081905 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:39:13.083729 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m01:39:13.085912 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:39:13.089970 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m01:39:13.090902 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:39:13.091668 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m01:39:13.093860 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m01:39:13.095000 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:39:13.095355 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m01:39:13.096210 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m01:39:13.100703 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:39:13.103008 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m01:39:13.107265 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m01:39:13.111955 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:39:13.112324 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0 seconds
[0m01:39:13.113002 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m01:39:13.114816 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 01:39:12.877206 => 2023-07-30 01:39:13.114744
[0m01:39:13.116389 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m01:39:13.117208 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:39:13.118954 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46f23293-d83b-4032-bd6c-342ece415579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7576c5750>]}
[0m01:39:13.120946 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:39:13.121926 [info ] [Thread-3 (]: 3 of 4 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.33s]
[0m01:39:13.123136 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:39:13.124168 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m01:39:13.125023 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:39:13.127396 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m01:39:13.130936 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:39:13.131896 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m01:39:13.132888 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m01:39:13.134765 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-30 01:39:13.064709 => 2023-07-30 01:39:13.134700
[0m01:39:13.135599 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m01:39:13.136790 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46f23293-d83b-4032-bd6c-342ece415579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe75768f090>]}
[0m01:39:13.137559 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.08s]
[0m01:39:13.138732 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m01:39:13.142302 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:39:13.142926 [debug] [MainThread]: Using postgres connection "master"
[0m01:39:13.143389 [debug] [MainThread]: On master: BEGIN
[0m01:39:13.143955 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:39:13.153851 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:39:13.154816 [debug] [MainThread]: On master: COMMIT
[0m01:39:13.155418 [debug] [MainThread]: Using postgres connection "master"
[0m01:39:13.156016 [debug] [MainThread]: On master: COMMIT
[0m01:39:13.156770 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:39:13.157404 [debug] [MainThread]: On master: Close
[0m01:39:13.158836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:39:13.159676 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m01:39:13.160243 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m01:39:13.160786 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m01:39:13.161288 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m01:39:13.161961 [info ] [MainThread]: 
[0m01:39:13.162780 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m01:39:13.164184 [debug] [MainThread]: Command end result
[0m01:39:13.174574 [info ] [MainThread]: 
[0m01:39:13.175598 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:39:13.176459 [info ] [MainThread]: 
[0m01:39:13.177539 [error] [MainThread]: [33mDatabase Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)[0m
[0m01:39:13.178520 [error] [MainThread]:   column "gdp" does not exist
[0m01:39:13.179258 [error] [MainThread]:   LINE 12:         LAG(gdp,1) OVER (
[0m01:39:13.180193 [error] [MainThread]:                        ^
[0m01:39:13.180991 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m01:39:13.181881 [info ] [MainThread]: 
[0m01:39:13.183600 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m01:39:13.185352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe758f23c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe75763b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7577098d0>]}
[0m01:39:13.187176 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 01:39:31.840072 | 50bbac9c-f0aa-4c6a-826c-ad37a6e16ace ==============================
[0m01:39:31.840072 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:39:31.842803 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:39:31.843846 [debug] [MainThread]: Tracking: tracking
[0m01:39:31.846414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f254b9fcd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f254bacde10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f254ba34990>]}
[0m01:39:31.860414 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:39:31.917472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:39:31.919532 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m01:39:31.937116 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m01:39:31.963956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50bbac9c-f0aa-4c6a-826c-ad37a6e16ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2549ccae10>]}
[0m01:39:31.980391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50bbac9c-f0aa-4c6a-826c-ad37a6e16ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2549d4ad90>]}
[0m01:39:31.981518 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:39:31.983153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50bbac9c-f0aa-4c6a-826c-ad37a6e16ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f254b464590>]}
[0m01:39:31.987423 [info ] [MainThread]: 
[0m01:39:31.993134 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:39:31.996454 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m01:39:32.017440 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m01:39:32.018928 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m01:39:32.020352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:39:32.053814 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:39:32.056094 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m01:39:32.059372 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m01:39:32.067511 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:39:32.068113 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m01:39:32.068593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:39:32.080118 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m01:39:32.081266 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:39:32.082893 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:39:32.091601 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:39:32.093703 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m01:39:32.094836 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m01:39:32.103747 [debug] [MainThread]: Using postgres connection "master"
[0m01:39:32.104641 [debug] [MainThread]: On master: BEGIN
[0m01:39:32.105503 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:39:32.119666 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:39:32.120725 [debug] [MainThread]: Using postgres connection "master"
[0m01:39:32.121686 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:39:32.137090 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m01:39:32.139389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50bbac9c-f0aa-4c6a-826c-ad37a6e16ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f254b96d910>]}
[0m01:39:32.140432 [debug] [MainThread]: On master: ROLLBACK
[0m01:39:32.141577 [debug] [MainThread]: Using postgres connection "master"
[0m01:39:32.142408 [debug] [MainThread]: On master: BEGIN
[0m01:39:32.143649 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:39:32.144480 [debug] [MainThread]: On master: COMMIT
[0m01:39:32.145194 [debug] [MainThread]: Using postgres connection "master"
[0m01:39:32.145815 [debug] [MainThread]: On master: COMMIT
[0m01:39:32.146799 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:39:32.147509 [debug] [MainThread]: On master: Close
[0m01:39:32.148583 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:39:32.149410 [info ] [MainThread]: 
[0m01:39:32.169075 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m01:39:32.169561 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m01:39:32.169951 [debug] [Thread-3 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m01:39:32.171013 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m01:39:32.171941 [info ] [Thread-2 (]: 2 of 4 START sql view model public.worldbank_api_metrics ....................... [RUN]
[0m01:39:32.173213 [info ] [Thread-3 (]: 3 of 4 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m01:39:32.174816 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m01:39:32.176069 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m01:39:32.177126 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m01:39:32.177922 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m01:39:32.178497 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m01:39:32.179261 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m01:39:32.183346 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m01:39:32.189477 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:39:32.193093 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m01:39:32.196708 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-30 01:39:32.179945 => 2023-07-30 01:39:32.196599
[0m01:39:32.197273 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 01:39:32.184337 => 2023-07-30 01:39:32.197207
[0m01:39:32.197554 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m01:39:32.198100 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 01:39:32.190447 => 2023-07-30 01:39:32.197936
[0m01:39:32.198741 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m01:39:32.216181 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m01:39:32.252854 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m01:39:32.277644 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:39:32.278718 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m01:39:32.282965 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:39:32.283460 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:39:32.283779 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:39:32.284905 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m01:39:32.285983 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m01:39:32.287506 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m01:39:32.288836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:32.289921 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:39:32.291052 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:39:32.307143 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:39:32.308099 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:39:32.308893 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m01:39:32.311816 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m01:39:32.313025 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:39:32.313841 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  create view "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        LAG(worldbank_api_indicator_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date DESC) as previous_year_gdb
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        previous_year_gdb,
        MIN(gdp) as min_gdp_growth_since_2000,
        MAX(gdp) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
[0m01:39:32.317482 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m01:39:32.319205 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:39:32.319904 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

generate_surrogate_key as (

    select 
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
)

select *
from generate_surrogate_key
  );
  
[0m01:39:32.321100 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m01:39:32.329854 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m01:39:32.332491 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:39:32.337169 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:39:32.338095 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m01:39:32.339287 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" rename to "worldbank_api_metrics"
[0m01:39:32.341255 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:39:32.345917 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:39:32.346281 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:39:32.347089 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:39:32.371234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:39:32.371111 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m01:39:32.379945 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:39:32.380764 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:39:32.381568 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:39:32.382618 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m01:39:32.383572 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:39:32.387342 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m01:39:32.387940 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m01:39:32.393144 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:39:32.395909 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:39:32.396829 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
drop view if exists "worldbank_api_db"."public"."worldbank_api_metrics__dbt_backup" cascade
[0m01:39:32.397623 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m01:39:32.399020 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m01:39:32.401214 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 01:39:32.243223 => 2023-07-30 01:39:32.401154
[0m01:39:32.402204 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m01:39:32.403426 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50bbac9c-f0aa-4c6a-826c-ad37a6e16ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2549c04190>]}
[0m01:39:32.404489 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.worldbank_api_metrics .................. [[32mCREATE VIEW[0m in 0.23s]
[0m01:39:32.405376 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m01:39:32.407629 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m01:39:32.409549 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-30 01:39:32.199507 => 2023-07-30 01:39:32.409497
[0m01:39:32.411136 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m01:39:32.412198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50bbac9c-f0aa-4c6a-826c-ad37a6e16ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2549c05050>]}
[0m01:39:32.413019 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.24s]
[0m01:39:32.414254 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m01:39:32.415666 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m01:39:32.416541 [info ] [Thread-4 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m01:39:32.418075 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m01:39:32.418328 [debug] [Thread-3 (]: SQL status: SELECT 16758 in 0 seconds
[0m01:39:32.419069 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m01:39:32.423737 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:39:32.426659 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m01:39:32.427501 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m01:39:32.429316 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-30 01:39:32.424360 => 2023-07-30 01:39:32.429236
[0m01:39:32.429632 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:39:32.429896 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m01:39:32.433054 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:39:32.437477 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m01:39:32.438226 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m01:39:32.441303 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:39:32.441729 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:39:32.444663 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m01:39:32.445500 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m01:39:32.446121 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:39:32.447032 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:39:32.447903 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m01:39:32.451973 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m01:39:32.455562 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:39:32.456464 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m01:39:32.459192 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m01:39:32.459982 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:39:32.460574 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m01:39:32.463172 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0 seconds
[0m01:39:32.465064 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 01:39:32.270006 => 2023-07-30 01:39:32.465003
[0m01:39:32.465377 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m01:39:32.466117 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m01:39:32.470527 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:39:32.472477 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50bbac9c-f0aa-4c6a-826c-ad37a6e16ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2549c334d0>]}
[0m01:39:32.472847 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m01:39:32.474097 [info ] [Thread-3 (]: 3 of 4 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.30s]
[0m01:39:32.476266 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m01:39:32.476547 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:39:32.480145 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:39:32.480758 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:39:32.481670 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:39:32.483551 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m01:39:32.486962 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:39:32.487727 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m01:39:32.488952 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m01:39:32.491160 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-30 01:39:32.433540 => 2023-07-30 01:39:32.491091
[0m01:39:32.491794 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m01:39:32.493192 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50bbac9c-f0aa-4c6a-826c-ad37a6e16ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2548289bd0>]}
[0m01:39:32.494233 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.08s]
[0m01:39:32.495337 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m01:39:32.499259 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:39:32.499865 [debug] [MainThread]: Using postgres connection "master"
[0m01:39:32.500548 [debug] [MainThread]: On master: BEGIN
[0m01:39:32.501109 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:39:32.512556 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:39:32.513771 [debug] [MainThread]: On master: COMMIT
[0m01:39:32.514615 [debug] [MainThread]: Using postgres connection "master"
[0m01:39:32.515433 [debug] [MainThread]: On master: COMMIT
[0m01:39:32.516733 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:39:32.518091 [debug] [MainThread]: On master: Close
[0m01:39:32.519836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:39:32.520955 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m01:39:32.522171 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m01:39:32.523199 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m01:39:32.524216 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m01:39:32.525315 [info ] [MainThread]: 
[0m01:39:32.526404 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m01:39:32.527952 [debug] [MainThread]: Command end result
[0m01:39:32.539240 [info ] [MainThread]: 
[0m01:39:32.540574 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:39:32.541867 [info ] [MainThread]: 
[0m01:39:32.543160 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:39:32.544485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f254b940490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f254b8ef010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2549be9dd0>]}
[0m01:39:32.545322 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 01:42:27.991073 | 926443b8-936d-4a7a-a5ae-0ff3f97b1996 ==============================
[0m01:42:27.991073 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:42:27.993836 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:42:27.994980 [debug] [MainThread]: Tracking: tracking
[0m01:42:27.998632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff800e5f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff800d16910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff800db9c10>]}
[0m01:42:28.012259 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:42:28.059889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:42:28.060835 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m01:42:28.076230 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m01:42:28.102750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '926443b8-936d-4a7a-a5ae-0ff3f97b1996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80110d910>]}
[0m01:42:28.117221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '926443b8-936d-4a7a-a5ae-0ff3f97b1996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80110f390>]}
[0m01:42:28.118354 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:42:28.119682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '926443b8-936d-4a7a-a5ae-0ff3f97b1996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8010839d0>]}
[0m01:42:28.122129 [info ] [MainThread]: 
[0m01:42:28.125555 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:42:28.128126 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m01:42:28.142576 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m01:42:28.143566 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m01:42:28.144327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:42:28.157697 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:42:28.159693 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m01:42:28.162340 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m01:42:28.169874 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:42:28.171012 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m01:42:28.171740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:42:28.181192 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m01:42:28.182949 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:42:28.183624 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:42:28.190244 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:42:28.192187 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m01:42:28.193032 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m01:42:28.199974 [debug] [MainThread]: Using postgres connection "master"
[0m01:42:28.200673 [debug] [MainThread]: On master: BEGIN
[0m01:42:28.201255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:42:28.213635 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:42:28.214571 [debug] [MainThread]: Using postgres connection "master"
[0m01:42:28.215346 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:42:28.247250 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m01:42:28.249918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '926443b8-936d-4a7a-a5ae-0ff3f97b1996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8017ca490>]}
[0m01:42:28.250881 [debug] [MainThread]: On master: ROLLBACK
[0m01:42:28.251982 [debug] [MainThread]: Using postgres connection "master"
[0m01:42:28.252758 [debug] [MainThread]: On master: BEGIN
[0m01:42:28.253810 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:42:28.254813 [debug] [MainThread]: On master: COMMIT
[0m01:42:28.255585 [debug] [MainThread]: Using postgres connection "master"
[0m01:42:28.256147 [debug] [MainThread]: On master: COMMIT
[0m01:42:28.256961 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:42:28.257525 [debug] [MainThread]: On master: Close
[0m01:42:28.258576 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:42:28.259856 [info ] [MainThread]: 
[0m01:42:28.279012 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m01:42:28.279469 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m01:42:28.279886 [debug] [Thread-3 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m01:42:28.280767 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m01:42:28.282641 [info ] [Thread-2 (]: 2 of 4 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m01:42:28.283819 [info ] [Thread-3 (]: 3 of 4 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m01:42:28.285201 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m01:42:28.286097 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m01:42:28.287023 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m01:42:28.287711 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m01:42:28.288185 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m01:42:28.288896 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m01:42:28.292968 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m01:42:28.296310 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:42:28.300087 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m01:42:28.304693 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 01:42:28.293783 => 2023-07-30 01:42:28.304308
[0m01:42:28.305262 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-30 01:42:28.289492 => 2023-07-30 01:42:28.305174
[0m01:42:28.305651 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m01:42:28.305865 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 01:42:28.297379 => 2023-07-30 01:42:28.305805
[0m01:42:28.306785 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m01:42:28.324440 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m01:42:28.361429 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m01:42:28.363876 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:42:28.371037 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m01:42:28.374933 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:42:28.375226 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:42:28.376006 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m01:42:28.376277 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:42:28.376714 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m01:42:28.377248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:42:28.377803 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m01:42:28.378193 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:42:28.379968 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:42:28.391927 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:42:28.392322 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m01:42:28.393375 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:42:28.394518 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:42:28.395609 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m01:42:28.396725 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m01:42:28.396931 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

generate_surrogate_key as (

    select 
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
)

select *
from generate_surrogate_key
  );
  
[0m01:42:28.398187 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:42:28.399283 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        LAG(worldbank_api_indicator_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date DESC) as previous_year_gdb
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        previous_year_gdb,
        MIN(gdp) as min_gdp_growth_since_2000,
        MAX(gdp) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
  
[0m01:42:28.402472 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m01:42:28.410327 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:42:28.411127 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m01:42:28.412869 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:42:28.416481 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:42:28.417360 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:42:28.418831 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:42:28.446429 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:42:28.448888 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:42:28.450330 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:42:28.455766 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m01:42:28.461883 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:42:28.462816 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m01:42:28.468111 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m01:42:28.470042 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-30 01:42:28.346826 => 2023-07-30 01:42:28.469966
[0m01:42:28.470772 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m01:42:28.472156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '926443b8-936d-4a7a-a5ae-0ff3f97b1996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff801093710>]}
[0m01:42:28.474176 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.19s]
[0m01:42:28.477251 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m01:42:28.478661 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m01:42:28.479627 [info ] [Thread-4 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m01:42:28.482737 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m01:42:28.483699 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m01:42:28.487756 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m01:42:28.488343 [debug] [Thread-3 (]: SQL status: SELECT 16758 in 0 seconds
[0m01:42:28.491679 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:42:28.492575 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-30 01:42:28.484272 => 2023-07-30 01:42:28.492496
[0m01:42:28.493001 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m01:42:28.493667 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m01:42:28.522962 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m01:42:28.525692 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:42:28.526492 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m01:42:28.527087 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:42:28.543444 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m01:42:28.544519 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:42:28.545136 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m01:42:28.551015 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m01:42:28.554381 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:42:28.555049 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m01:42:28.556274 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:42:28.558203 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:42:28.558766 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:42:28.559271 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:42:28.563555 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m01:42:28.566343 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:42:28.567000 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m01:42:28.568003 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m01:42:28.569591 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-30 01:42:28.494779 => 2023-07-30 01:42:28.569482
[0m01:42:28.570184 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m01:42:28.571199 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '926443b8-936d-4a7a-a5ae-0ff3f97b1996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7ff052110>]}
[0m01:42:28.572181 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.09s]
[0m01:42:28.573569 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m01:42:28.575256 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m01:42:28.578447 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:42:28.578912 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" rename to "worldbank_api_metrics"
[0m01:42:28.580141 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:42:28.583033 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m01:42:28.583579 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:42:28.584041 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m01:42:28.586353 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m01:42:28.586961 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:42:28.589172 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:42:28.592375 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:42:28.593116 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_metrics__dbt_backup" cascade
[0m01:42:28.593743 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m01:42:28.594724 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m01:42:28.596387 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 01:42:28.307321 => 2023-07-30 01:42:28.596333
[0m01:42:28.596679 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:42:28.597234 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m01:42:28.599953 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m01:42:28.601975 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '926443b8-936d-4a7a-a5ae-0ff3f97b1996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff800be1e50>]}
[0m01:42:28.602288 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:42:28.603371 [info ] [Thread-2 (]: 2 of 4 OK created sql table model public.worldbank_api_metrics ................. [[32mSELECT 16758[0m in 0.32s]
[0m01:42:28.604087 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m01:42:28.605026 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m01:42:28.606479 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m01:42:28.611556 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:42:28.612346 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m01:42:28.619913 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0 seconds
[0m01:42:28.622535 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 01:42:28.364606 => 2023-07-30 01:42:28.622462
[0m01:42:28.623418 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m01:42:28.625009 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '926443b8-936d-4a7a-a5ae-0ff3f97b1996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7ff05efd0>]}
[0m01:42:28.626151 [info ] [Thread-3 (]: 3 of 4 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.34s]
[0m01:42:28.627644 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m01:42:28.632371 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:42:28.633788 [debug] [MainThread]: Using postgres connection "master"
[0m01:42:28.635016 [debug] [MainThread]: On master: BEGIN
[0m01:42:28.636581 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:42:28.648103 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:42:28.649604 [debug] [MainThread]: On master: COMMIT
[0m01:42:28.650633 [debug] [MainThread]: Using postgres connection "master"
[0m01:42:28.651555 [debug] [MainThread]: On master: COMMIT
[0m01:42:28.652706 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:42:28.653548 [debug] [MainThread]: On master: Close
[0m01:42:28.654769 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:42:28.655582 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m01:42:28.656235 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m01:42:28.656831 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m01:42:28.657482 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m01:42:28.658147 [info ] [MainThread]: 
[0m01:42:28.659258 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m01:42:28.660490 [debug] [MainThread]: Command end result
[0m01:42:28.675795 [info ] [MainThread]: 
[0m01:42:28.677519 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:42:28.679272 [info ] [MainThread]: 
[0m01:42:28.680793 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:42:28.682625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff800d17750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff801014110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7ff0d3390>]}
[0m01:42:28.687635 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 01:46:53.236990 | 5eb9557b-5780-455c-9464-a72f6321719f ==============================
[0m01:46:53.236990 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:46:53.240278 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:46:53.241905 [debug] [MainThread]: Tracking: tracking
[0m01:46:53.244945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68de6b0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68de6b1090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e05d60d0>]}
[0m01:46:53.259132 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:46:53.313083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:46:53.314246 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m01:46:53.330000 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m01:46:53.354342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5eb9557b-5780-455c-9464-a72f6321719f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68dddc3590>]}
[0m01:46:53.369942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5eb9557b-5780-455c-9464-a72f6321719f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68dc67a450>]}
[0m01:46:53.370852 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:46:53.372037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5eb9557b-5780-455c-9464-a72f6321719f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68de6eb850>]}
[0m01:46:53.374474 [info ] [MainThread]: 
[0m01:46:53.377889 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:46:53.380008 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m01:46:53.391778 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m01:46:53.392693 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m01:46:53.393470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:46:53.408277 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:46:53.410471 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m01:46:53.413547 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m01:46:53.420648 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:46:53.421570 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m01:46:53.422359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:46:53.431345 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m01:46:53.432381 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:46:53.433051 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:46:53.444693 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m01:46:53.448842 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m01:46:53.449717 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m01:46:53.458503 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:53.459491 [debug] [MainThread]: On master: BEGIN
[0m01:46:53.460316 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:46:53.473996 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:46:53.475149 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:53.475873 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:46:53.492494 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m01:46:53.494924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5eb9557b-5780-455c-9464-a72f6321719f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68dc67b110>]}
[0m01:46:53.495801 [debug] [MainThread]: On master: ROLLBACK
[0m01:46:53.496931 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:53.497762 [debug] [MainThread]: On master: BEGIN
[0m01:46:53.498776 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:46:53.499541 [debug] [MainThread]: On master: COMMIT
[0m01:46:53.500191 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:53.500744 [debug] [MainThread]: On master: COMMIT
[0m01:46:53.501539 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:46:53.502102 [debug] [MainThread]: On master: Close
[0m01:46:53.503220 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:46:53.504248 [info ] [MainThread]: 
[0m01:46:53.528006 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m01:46:53.528470 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m01:46:53.528885 [debug] [Thread-3 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m01:46:53.529989 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m01:46:53.531423 [info ] [Thread-2 (]: 2 of 4 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m01:46:53.532349 [info ] [Thread-3 (]: 3 of 4 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m01:46:53.533606 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m01:46:53.534512 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m01:46:53.536448 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m01:46:53.537162 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m01:46:53.537671 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m01:46:53.538345 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m01:46:53.544993 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m01:46:53.549261 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:46:53.554255 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m01:46:53.559290 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 01:46:53.545807 => 2023-07-30 01:46:53.559034
[0m01:46:53.560017 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-30 01:46:53.539050 => 2023-07-30 01:46:53.559950
[0m01:46:53.560475 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m01:46:53.560829 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 01:46:53.550946 => 2023-07-30 01:46:53.560666
[0m01:46:53.561392 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m01:46:53.594952 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m01:46:53.624416 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:46:53.626303 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m01:46:53.631222 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m01:46:53.636349 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:46:53.636854 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:46:53.637068 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:46:53.637287 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m01:46:53.637919 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m01:46:53.638479 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m01:46:53.639137 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:46:53.639701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:46:53.640329 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:46:53.655045 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m01:46:53.655634 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:46:53.656773 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:46:53.657463 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:46:53.658197 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        worldbank_api_value as gdp_value
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date DESC) as previous_year_gdb_value
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        gdp_value,
        previous_year_gdb_value,
        MIN(gdp) as min_gdp_growth_since_2000,
        MAX(gdp) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
  
[0m01:46:53.658738 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m01:46:53.660093 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "LAG"
LINE 17:         LAG(worldbank_api_value,1) OVER (
                 ^

[0m01:46:53.660677 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: ROLLBACK
[0m01:46:53.661668 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 01:46:53.561939 => 2023-07-30 01:46:53.661589
[0m01:46:53.662356 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m01:46:53.664933 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m01:46:53.672481 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m01:46:53.674467 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:46:53.674884 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:46:53.676232 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m01:46:53.677630 [debug] [Thread-2 (]: Database Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)
  syntax error at or near "LAG"
  LINE 17:         LAG(worldbank_api_value,1) OVER (
                   ^
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m01:46:53.678114 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

generate_surrogate_key as (

    select 
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
)

select *
from generate_surrogate_key
  );
  
[0m01:46:53.679389 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5eb9557b-5780-455c-9464-a72f6321719f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68de78e550>]}
[0m01:46:53.679640 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:46:53.684929 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:46:53.681139 [error] [Thread-2 (]: 2 of 4 ERROR creating sql table model public.worldbank_api_metrics ............. [[31mERROR[0m in 0.15s]
[0m01:46:53.685804 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:46:53.688438 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m01:46:53.690946 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:46:53.725186 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:46:53.726437 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:46:53.727480 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:46:53.730875 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m01:46:53.737428 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:46:53.738257 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m01:46:53.744585 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m01:46:53.746706 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-30 01:46:53.616636 => 2023-07-30 01:46:53.746640
[0m01:46:53.747460 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m01:46:53.748983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5eb9557b-5780-455c-9464-a72f6321719f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68dc6b3690>]}
[0m01:46:53.750403 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.22s]
[0m01:46:53.751668 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m01:46:53.753163 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m01:46:53.753906 [info ] [Thread-4 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m01:46:53.755465 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m01:46:53.756838 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m01:46:53.761448 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m01:46:53.763504 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-30 01:46:53.757351 => 2023-07-30 01:46:53.763413
[0m01:46:53.764340 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m01:46:53.774392 [debug] [Thread-3 (]: SQL status: SELECT 16758 in 0 seconds
[0m01:46:53.789667 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m01:46:53.792969 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:46:53.794842 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m01:46:53.796061 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:46:53.796424 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:46:53.796780 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m01:46:53.800199 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:46:53.801051 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:46:53.801770 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m01:46:53.804374 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:46:53.807538 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m01:46:53.808165 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:46:53.808636 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m01:46:53.811093 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m01:46:53.814858 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:46:53.815130 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m01:46:53.815806 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m01:46:53.816520 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:46:53.817757 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m01:46:53.822101 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m01:46:53.822319 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0 seconds
[0m01:46:53.825459 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:46:53.827121 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 01:46:53.627080 => 2023-07-30 01:46:53.827065
[0m01:46:53.827817 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m01:46:53.828460 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m01:46:53.830087 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5eb9557b-5780-455c-9464-a72f6321719f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68d849dc10>]}
[0m01:46:53.830318 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:46:53.831124 [info ] [Thread-3 (]: 3 of 4 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.29s]
[0m01:46:53.833597 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:46:53.834478 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m01:46:53.835093 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:46:53.836108 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:46:53.837261 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m01:46:53.839497 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:46:53.839917 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m01:46:53.840608 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m01:46:53.841955 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-30 01:46:53.764951 => 2023-07-30 01:46:53.841898
[0m01:46:53.842306 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m01:46:53.843132 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5eb9557b-5780-455c-9464-a72f6321719f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68de3a70d0>]}
[0m01:46:53.843700 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.09s]
[0m01:46:53.844328 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m01:46:53.847975 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:46:53.848795 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:53.849349 [debug] [MainThread]: On master: BEGIN
[0m01:46:53.849901 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:46:53.863540 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:46:53.864513 [debug] [MainThread]: On master: COMMIT
[0m01:46:53.865564 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:53.866878 [debug] [MainThread]: On master: COMMIT
[0m01:46:53.868467 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:46:53.870401 [debug] [MainThread]: On master: Close
[0m01:46:53.872991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:46:53.874817 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m01:46:53.876659 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m01:46:53.880292 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m01:46:53.881361 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m01:46:53.882721 [info ] [MainThread]: 
[0m01:46:53.884535 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m01:46:53.886818 [debug] [MainThread]: Command end result
[0m01:46:53.905382 [info ] [MainThread]: 
[0m01:46:53.909068 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:46:53.912328 [info ] [MainThread]: 
[0m01:46:53.915006 [error] [MainThread]: [33mDatabase Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)[0m
[0m01:46:53.916728 [error] [MainThread]:   syntax error at or near "LAG"
[0m01:46:53.918599 [error] [MainThread]:   LINE 17:         LAG(worldbank_api_value,1) OVER (
[0m01:46:53.920220 [error] [MainThread]:                    ^
[0m01:46:53.922004 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m01:46:53.923783 [info ] [MainThread]: 
[0m01:46:53.925550 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m01:46:53.927681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68dc695590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68de3a4450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68de3a5bd0>]}
[0m01:46:53.929232 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 01:47:18.683573 | 920c5de5-bb2f-4a78-854f-3ab5769a1ff9 ==============================
[0m01:47:18.683573 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:47:18.687183 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:47:18.688225 [debug] [MainThread]: Tracking: tracking
[0m01:47:18.691526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2520697950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2520695410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25205ecd50>]}
[0m01:47:18.710769 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:47:18.785876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:47:18.787305 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m01:47:18.808210 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m01:47:18.836008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '920c5de5-bb2f-4a78-854f-3ab5769a1ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251fe048d0>]}
[0m01:47:18.848919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '920c5de5-bb2f-4a78-854f-3ab5769a1ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251e709250>]}
[0m01:47:18.849685 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:47:18.850679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '920c5de5-bb2f-4a78-854f-3ab5769a1ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f252069b3d0>]}
[0m01:47:18.852767 [info ] [MainThread]: 
[0m01:47:18.855686 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:47:18.858089 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m01:47:18.870596 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m01:47:18.871622 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m01:47:18.872466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:47:18.887344 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:47:18.889099 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m01:47:18.891455 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m01:47:18.898685 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:47:18.899482 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m01:47:18.900373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:47:18.909468 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m01:47:18.910134 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:47:18.910653 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:47:18.918020 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m01:47:18.919931 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m01:47:18.921004 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m01:47:18.928746 [debug] [MainThread]: Using postgres connection "master"
[0m01:47:18.929567 [debug] [MainThread]: On master: BEGIN
[0m01:47:18.930544 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:47:18.940034 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:47:18.941110 [debug] [MainThread]: Using postgres connection "master"
[0m01:47:18.941834 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:47:18.956528 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m01:47:18.958541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '920c5de5-bb2f-4a78-854f-3ab5769a1ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251e702b10>]}
[0m01:47:18.959758 [debug] [MainThread]: On master: ROLLBACK
[0m01:47:18.960813 [debug] [MainThread]: Using postgres connection "master"
[0m01:47:18.961528 [debug] [MainThread]: On master: BEGIN
[0m01:47:18.962625 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:47:18.963503 [debug] [MainThread]: On master: COMMIT
[0m01:47:18.964134 [debug] [MainThread]: Using postgres connection "master"
[0m01:47:18.964768 [debug] [MainThread]: On master: COMMIT
[0m01:47:18.965602 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:47:18.966176 [debug] [MainThread]: On master: Close
[0m01:47:18.967149 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:47:18.968304 [info ] [MainThread]: 
[0m01:47:18.987482 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m01:47:18.988050 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m01:47:18.988387 [debug] [Thread-3 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m01:47:18.989320 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m01:47:18.990869 [info ] [Thread-2 (]: 2 of 4 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m01:47:18.991885 [info ] [Thread-3 (]: 3 of 4 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m01:47:18.993553 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m01:47:18.994831 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m01:47:18.995783 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m01:47:18.996568 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m01:47:18.997293 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m01:47:18.997899 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m01:47:19.002054 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m01:47:19.005457 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:47:19.008971 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m01:47:19.012737 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-30 01:47:18.998521 => 2023-07-30 01:47:19.012588
[0m01:47:19.013639 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 01:47:19.002928 => 2023-07-30 01:47:19.013562
[0m01:47:19.014012 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m01:47:19.014329 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 01:47:19.006259 => 2023-07-30 01:47:19.014215
[0m01:47:19.014948 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m01:47:19.032925 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m01:47:19.070703 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:47:19.075569 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m01:47:19.081354 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m01:47:19.085250 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:47:19.086079 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:47:19.086446 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m01:47:19.086910 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:47:19.087463 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m01:47:19.088185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:47:19.088845 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m01:47:19.089472 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:47:19.090649 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:47:19.102749 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m01:47:19.103524 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:47:19.104126 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:47:19.104797 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        worldbank_api_value as gdp_value,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date DESC) as previous_year_gdb_value
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        gdp_value,
        previous_year_gdb_value,
        MIN(gdp) as min_gdp_growth_since_2000,
        MAX(gdp) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
  
[0m01:47:19.105888 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:47:19.108038 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m01:47:19.113553 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m01:47:19.123156 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:47:19.123429 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m01:47:19.124468 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m01:47:19.125503 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:47:19.127035 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

generate_surrogate_key as (

    select 
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
)

select *
from generate_surrogate_key
  );
  
[0m01:47:19.127346 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:47:19.131472 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:47:19.132316 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:47:19.133775 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:47:19.167353 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:47:19.168325 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:47:19.169143 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:47:19.171817 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m01:47:19.177988 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:47:19.178832 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m01:47:19.185699 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m01:47:19.189587 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-30 01:47:19.015552 => 2023-07-30 01:47:19.189495
[0m01:47:19.190520 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m01:47:19.192095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '920c5de5-bb2f-4a78-854f-3ab5769a1ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25205ec8d0>]}
[0m01:47:19.193234 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.20s]
[0m01:47:19.196564 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m01:47:19.198867 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m01:47:19.200452 [info ] [Thread-4 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m01:47:19.203002 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m01:47:19.203851 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m01:47:19.208078 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m01:47:19.210534 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-30 01:47:19.205154 => 2023-07-30 01:47:19.210401
[0m01:47:19.211329 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m01:47:19.238110 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m01:47:19.240432 [debug] [Thread-3 (]: SQL status: SELECT 16758 in 0 seconds
[0m01:47:19.245670 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:47:19.246502 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:47:19.246814 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m01:47:19.247764 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m01:47:19.250289 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:47:19.269438 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m01:47:19.269821 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m01:47:19.270597 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:47:19.273961 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:47:19.274785 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m01:47:19.275480 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics" rename to "worldbank_api_metrics__dbt_backup"
[0m01:47:19.277408 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:47:19.280521 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:47:19.280964 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m01:47:19.281576 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" rename to "worldbank_api_metrics"
[0m01:47:19.284594 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:47:19.286105 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m01:47:19.286371 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:47:19.289968 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m01:47:19.290236 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:47:19.290896 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:47:19.293149 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:47:19.293937 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m01:47:19.294774 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:47:19.296095 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:47:19.302219 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m01:47:19.302685 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:47:19.302918 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m01:47:19.305210 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:47:19.308709 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:47:19.311429 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:47:19.312338 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_metrics__dbt_backup" cascade
[0m01:47:19.313187 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m01:47:19.313781 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m01:47:19.316295 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:47:19.316575 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m01:47:19.320793 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m01:47:19.321152 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m01:47:19.322829 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-30 01:47:19.212051 => 2023-07-30 01:47:19.322710
[0m01:47:19.323625 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:47:19.325572 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 01:47:19.050071 => 2023-07-30 01:47:19.325488
[0m01:47:19.326457 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m01:47:19.327285 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m01:47:19.328108 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m01:47:19.329596 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '920c5de5-bb2f-4a78-854f-3ab5769a1ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251e61d990>]}
[0m01:47:19.331511 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '920c5de5-bb2f-4a78-854f-3ab5769a1ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251e5b8290>]}
[0m01:47:19.331920 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m01:47:19.332497 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.13s]
[0m01:47:19.333772 [info ] [Thread-2 (]: 2 of 4 OK created sql table model public.worldbank_api_metrics ................. [[32mSELECT 16758[0m in 0.34s]
[0m01:47:19.337786 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:47:19.338935 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m01:47:19.339911 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m01:47:19.340874 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m01:47:19.348110 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0 seconds
[0m01:47:19.350060 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 01:47:19.076426 => 2023-07-30 01:47:19.350000
[0m01:47:19.350781 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m01:47:19.352022 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '920c5de5-bb2f-4a78-854f-3ab5769a1ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251e5e9950>]}
[0m01:47:19.352899 [info ] [Thread-3 (]: 3 of 4 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.36s]
[0m01:47:19.353843 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m01:47:19.357225 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:47:19.357988 [debug] [MainThread]: Using postgres connection "master"
[0m01:47:19.358618 [debug] [MainThread]: On master: BEGIN
[0m01:47:19.359276 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:47:19.368646 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:47:19.370002 [debug] [MainThread]: On master: COMMIT
[0m01:47:19.370786 [debug] [MainThread]: Using postgres connection "master"
[0m01:47:19.371523 [debug] [MainThread]: On master: COMMIT
[0m01:47:19.372751 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:47:19.373606 [debug] [MainThread]: On master: Close
[0m01:47:19.374892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:47:19.375742 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m01:47:19.376499 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m01:47:19.377180 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m01:47:19.377864 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m01:47:19.378898 [info ] [MainThread]: 
[0m01:47:19.380147 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m01:47:19.382217 [debug] [MainThread]: Command end result
[0m01:47:19.396618 [info ] [MainThread]: 
[0m01:47:19.398590 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:47:19.399841 [info ] [MainThread]: 
[0m01:47:19.401039 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:47:19.402563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25203c10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25203c0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25202c9090>]}
[0m01:47:19.403913 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 01:49:08.515586 | 8d80ec5d-c1ad-4db2-b498-00fb2993ca25 ==============================
[0m01:49:08.515586 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:49:08.518369 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:49:08.519648 [debug] [MainThread]: Tracking: tracking
[0m01:49:08.523002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145d498250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145d9ebd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145d8abf50>]}
[0m01:49:08.537449 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:49:08.595920 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:49:08.599526 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m01:49:08.616448 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m01:49:08.640518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d80ec5d-c1ad-4db2-b498-00fb2993ca25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145bc7bfd0>]}
[0m01:49:08.656764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d80ec5d-c1ad-4db2-b498-00fb2993ca25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145d8eced0>]}
[0m01:49:08.657782 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:49:08.659371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d80ec5d-c1ad-4db2-b498-00fb2993ca25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145d3fb350>]}
[0m01:49:08.662492 [info ] [MainThread]: 
[0m01:49:08.666087 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:49:08.668394 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m01:49:08.680249 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m01:49:08.681236 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m01:49:08.681927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:49:08.706125 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:49:08.708602 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m01:49:08.711882 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m01:49:08.720327 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:49:08.722483 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m01:49:08.724269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:49:08.738007 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m01:49:08.739021 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:49:08.739763 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:49:08.746441 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m01:49:08.748638 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m01:49:08.749880 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m01:49:08.758148 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:08.759109 [debug] [MainThread]: On master: BEGIN
[0m01:49:08.759952 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:49:08.770138 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:49:08.771190 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:08.771842 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:49:08.787501 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m01:49:08.793040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d80ec5d-c1ad-4db2-b498-00fb2993ca25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145bd00150>]}
[0m01:49:08.794313 [debug] [MainThread]: On master: ROLLBACK
[0m01:49:08.795283 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:08.795937 [debug] [MainThread]: On master: BEGIN
[0m01:49:08.797045 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:49:08.798145 [debug] [MainThread]: On master: COMMIT
[0m01:49:08.799068 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:08.799843 [debug] [MainThread]: On master: COMMIT
[0m01:49:08.800917 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:49:08.801579 [debug] [MainThread]: On master: Close
[0m01:49:08.802669 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:49:08.803647 [info ] [MainThread]: 
[0m01:49:08.822938 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m01:49:08.823389 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m01:49:08.823708 [debug] [Thread-3 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m01:49:08.826894 [info ] [Thread-3 (]: 3 of 4 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m01:49:08.825698 [info ] [Thread-2 (]: 2 of 4 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m01:49:08.824736 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m01:49:08.828382 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m01:49:08.829511 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m01:49:08.830302 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m01:49:08.830922 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m01:49:08.831455 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m01:49:08.832236 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m01:49:08.836905 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m01:49:08.840778 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:49:08.844563 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m01:49:08.848144 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 01:49:08.837891 => 2023-07-30 01:49:08.848035
[0m01:49:08.848451 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 01:49:08.832884 => 2023-07-30 01:49:08.848392
[0m01:49:08.848863 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-30 01:49:08.842019 => 2023-07-30 01:49:08.848809
[0m01:49:08.849121 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m01:49:08.849785 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m01:49:08.850369 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m01:49:08.938162 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m01:49:08.939225 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:49:08.941502 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m01:49:08.945710 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:49:08.946076 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:49:08.946489 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:49:08.946697 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m01:49:08.947281 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m01:49:08.947818 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m01:49:08.948226 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:49:08.948818 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:49:08.949374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:08.960709 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m01:49:08.962088 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:49:08.962760 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m01:49:08.963421 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:49:08.963855 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        worldbank_api_value as gdp_value,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date DESC) as previous_year_gdb,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date DESC) as previous_year_gdb_value
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        gdp_value,
        previous_year_gdb,
        previous_year_gdb_value,
        MIN(gdp) as min_gdp_growth_since_2000,
        MAX(gdp) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
  
[0m01:49:08.964653 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:49:08.965488 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:49:08.966399 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

generate_surrogate_key as (

    select 
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
)

select *
from generate_surrogate_key
  );
  
[0m01:49:08.967066 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m01:49:08.971325 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m01:49:08.979758 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:49:08.980613 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m01:49:08.981915 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:49:08.984919 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:49:08.985668 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:49:08.987247 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:49:09.013831 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:49:09.015031 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:49:09.016010 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:49:09.019711 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m01:49:09.025766 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:49:09.026663 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m01:49:09.032635 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m01:49:09.034688 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-30 01:49:08.902097 => 2023-07-30 01:49:09.034627
[0m01:49:09.035431 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m01:49:09.036664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d80ec5d-c1ad-4db2-b498-00fb2993ca25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145d498210>]}
[0m01:49:09.037639 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.21s]
[0m01:49:09.040086 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m01:49:09.041331 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m01:49:09.042227 [info ] [Thread-4 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m01:49:09.043782 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m01:49:09.044651 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m01:49:09.047806 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m01:49:09.049922 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-30 01:49:09.045251 => 2023-07-30 01:49:09.049834
[0m01:49:09.050585 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m01:49:09.059331 [debug] [Thread-3 (]: SQL status: SELECT 16758 in 0 seconds
[0m01:49:09.074099 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:49:09.078997 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m01:49:09.080237 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m01:49:09.083572 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:49:09.084402 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m01:49:09.085085 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:49:09.085442 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m01:49:09.090613 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:49:09.091233 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics" rename to "worldbank_api_metrics__dbt_backup"
[0m01:49:09.092646 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:49:09.097245 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:49:09.098234 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" rename to "worldbank_api_metrics"
[0m01:49:09.099053 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m01:49:09.100090 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:49:09.100401 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:49:09.100904 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m01:49:09.103634 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m01:49:09.105083 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:49:09.105868 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m01:49:09.108048 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m01:49:09.111328 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:49:09.111589 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m01:49:09.111815 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:49:09.112316 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m01:49:09.114590 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:49:09.117675 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:49:09.118752 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_metrics__dbt_backup" cascade
[0m01:49:09.119059 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:49:09.119593 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m01:49:09.121886 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:49:09.122913 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:49:09.123204 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:49:09.123344 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:49:09.125916 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m01:49:09.126229 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m01:49:09.127303 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:49:09.127597 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m01:49:09.129412 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 01:49:08.850744 => 2023-07-30 01:49:09.129354
[0m01:49:09.130046 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m01:49:09.132141 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:49:09.132846 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m01:49:09.133786 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m01:49:09.134454 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m01:49:09.135588 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d80ec5d-c1ad-4db2-b498-00fb2993ca25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145d8ede10>]}
[0m01:49:09.136383 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m01:49:09.138724 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:49:09.139922 [info ] [Thread-2 (]: 2 of 4 OK created sql table model public.worldbank_api_metrics ................. [[32mSELECT 16758[0m in 0.31s]
[0m01:49:09.142013 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-30 01:49:09.051072 => 2023-07-30 01:49:09.141954
[0m01:49:09.143064 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m01:49:09.144246 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m01:49:09.145102 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m01:49:09.148548 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d80ec5d-c1ad-4db2-b498-00fb2993ca25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145bbc14d0>]}
[0m01:49:09.149710 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.11s]
[0m01:49:09.151291 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m01:49:09.152736 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0 seconds
[0m01:49:09.155402 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 01:49:08.868034 => 2023-07-30 01:49:09.155264
[0m01:49:09.156502 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m01:49:09.158106 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d80ec5d-c1ad-4db2-b498-00fb2993ca25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145bc10590>]}
[0m01:49:09.159448 [info ] [Thread-3 (]: 3 of 4 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.33s]
[0m01:49:09.161071 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m01:49:09.165916 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:49:09.166868 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:09.167755 [debug] [MainThread]: On master: BEGIN
[0m01:49:09.168695 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:49:09.182041 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:49:09.183542 [debug] [MainThread]: On master: COMMIT
[0m01:49:09.184420 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:09.185133 [debug] [MainThread]: On master: COMMIT
[0m01:49:09.186321 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:49:09.187132 [debug] [MainThread]: On master: Close
[0m01:49:09.188381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:49:09.189076 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m01:49:09.189818 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m01:49:09.190719 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m01:49:09.191422 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m01:49:09.192062 [info ] [MainThread]: 
[0m01:49:09.193014 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m01:49:09.194725 [debug] [MainThread]: Command end result
[0m01:49:09.210735 [info ] [MainThread]: 
[0m01:49:09.212737 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:49:09.215137 [info ] [MainThread]: 
[0m01:49:09.217312 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:49:09.219021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145d3d0710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145d9b11d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145bb8d4d0>]}
[0m01:49:09.220838 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 01:50:06.816298 | c4405347-2e00-4167-a49b-2b4d1486ccea ==============================
[0m01:50:06.816298 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:50:06.818857 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:50:06.819779 [debug] [MainThread]: Tracking: tracking
[0m01:50:06.824146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f467a1c3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f467850e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4679c70810>]}
[0m01:50:06.837881 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:50:06.886567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:50:06.889007 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m01:50:06.918898 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m01:50:06.946038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4405347-2e00-4167-a49b-2b4d1486ccea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4678507190>]}
[0m01:50:06.962744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4405347-2e00-4167-a49b-2b4d1486ccea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f467854cd90>]}
[0m01:50:06.963607 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:50:06.964615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4405347-2e00-4167-a49b-2b4d1486ccea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f467a12e490>]}
[0m01:50:06.966842 [info ] [MainThread]: 
[0m01:50:06.971483 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:50:06.973656 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m01:50:06.985230 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m01:50:06.986229 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m01:50:06.986976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:50:07.001314 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:50:07.003833 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m01:50:07.007470 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m01:50:07.014776 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:50:07.015639 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m01:50:07.016268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:50:07.026819 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m01:50:07.027726 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m01:50:07.028277 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:50:07.035628 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m01:50:07.037537 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m01:50:07.038516 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m01:50:07.045854 [debug] [MainThread]: Using postgres connection "master"
[0m01:50:07.046651 [debug] [MainThread]: On master: BEGIN
[0m01:50:07.047249 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:50:07.056005 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:50:07.056813 [debug] [MainThread]: Using postgres connection "master"
[0m01:50:07.057385 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:50:07.071830 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m01:50:07.073921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4405347-2e00-4167-a49b-2b4d1486ccea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4679c20950>]}
[0m01:50:07.075016 [debug] [MainThread]: On master: ROLLBACK
[0m01:50:07.076205 [debug] [MainThread]: Using postgres connection "master"
[0m01:50:07.077339 [debug] [MainThread]: On master: BEGIN
[0m01:50:07.079833 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:50:07.081481 [debug] [MainThread]: On master: COMMIT
[0m01:50:07.082348 [debug] [MainThread]: Using postgres connection "master"
[0m01:50:07.082923 [debug] [MainThread]: On master: COMMIT
[0m01:50:07.083802 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:50:07.084368 [debug] [MainThread]: On master: Close
[0m01:50:07.085400 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:50:07.086478 [info ] [MainThread]: 
[0m01:50:07.105684 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m01:50:07.106152 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m01:50:07.106608 [debug] [Thread-3 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m01:50:07.107604 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m01:50:07.108948 [info ] [Thread-2 (]: 2 of 4 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m01:50:07.110482 [info ] [Thread-3 (]: 3 of 4 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m01:50:07.112432 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m01:50:07.113571 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m01:50:07.114762 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m01:50:07.115471 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m01:50:07.116288 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m01:50:07.117043 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m01:50:07.121030 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m01:50:07.124477 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:50:07.127751 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m01:50:07.130725 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-30 01:50:07.117586 => 2023-07-30 01:50:07.130634
[0m01:50:07.131131 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 01:50:07.121895 => 2023-07-30 01:50:07.131075
[0m01:50:07.131499 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 01:50:07.125284 => 2023-07-30 01:50:07.131445
[0m01:50:07.131825 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m01:50:07.132466 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m01:50:07.133065 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m01:50:07.199188 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m01:50:07.200516 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m01:50:07.202907 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m01:50:07.205647 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:50:07.205939 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:50:07.206609 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m01:50:07.206862 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:50:07.207253 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m01:50:07.207782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:50:07.208348 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m01:50:07.208768 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:50:07.209924 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:50:07.220838 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:50:07.221851 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:50:07.222621 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m01:50:07.224526 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m01:50:07.225400 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m01:50:07.225816 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:50:07.226680 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:50:07.227817 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        worldbank_api_value as gdp_value,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_value
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        gdp_value,
        previous_year_gdb,
        previous_year_gdb_value,
        MIN(gdp) as min_gdp_growth_since_2000,
        MAX(gdp) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
  
[0m01:50:07.228436 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m01:50:07.229466 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

generate_surrogate_key as (

    select 
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
)

select *
from generate_surrogate_key
  );
  
[0m01:50:07.237306 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:50:07.239686 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m01:50:07.244790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:50:07.250090 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:50:07.251072 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:50:07.252782 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:50:07.282603 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:50:07.283458 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:50:07.284141 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m01:50:07.287919 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m01:50:07.294905 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m01:50:07.295922 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m01:50:07.302394 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m01:50:07.304605 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-30 01:50:07.133719 => 2023-07-30 01:50:07.304543
[0m01:50:07.305457 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m01:50:07.306848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4405347-2e00-4167-a49b-2b4d1486ccea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f467a1741d0>]}
[0m01:50:07.307825 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.19s]
[0m01:50:07.310489 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m01:50:07.312202 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m01:50:07.313368 [info ] [Thread-4 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m01:50:07.315321 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m01:50:07.316449 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m01:50:07.320211 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m01:50:07.323079 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-30 01:50:07.317336 => 2023-07-30 01:50:07.322963
[0m01:50:07.324018 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m01:50:07.338478 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m01:50:07.353289 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m01:50:07.353656 [debug] [Thread-3 (]: SQL status: SELECT 16758 in 0 seconds
[0m01:50:07.357901 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:50:07.362047 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:50:07.363273 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics" rename to "worldbank_api_metrics__dbt_backup"
[0m01:50:07.363809 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:50:07.364044 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m01:50:07.366227 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m01:50:07.366752 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:50:07.368030 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:50:07.371389 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:50:07.373827 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" rename to "worldbank_api_metrics"
[0m01:50:07.375794 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:50:07.378717 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m01:50:07.379384 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:50:07.379878 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m01:50:07.382688 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m01:50:07.383685 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:50:07.384489 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m01:50:07.385277 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m01:50:07.385798 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:50:07.388094 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m01:50:07.388384 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m01:50:07.391124 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:50:07.391799 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_metrics__dbt_backup" cascade
[0m01:50:07.394561 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:50:07.395228 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m01:50:07.396288 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m01:50:07.397470 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:50:07.397877 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:50:07.400067 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m01:50:07.400605 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m01:50:07.402057 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:50:07.402767 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:50:07.404370 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 01:50:07.161073 => 2023-07-30 01:50:07.404265
[0m01:50:07.405003 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:50:07.405593 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m01:50:07.406038 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m01:50:07.406530 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m01:50:07.407895 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4405347-2e00-4167-a49b-2b4d1486ccea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4677adcc10>]}
[0m01:50:07.408220 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m01:50:07.409435 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m01:50:07.409113 [info ] [Thread-2 (]: 2 of 4 OK created sql table model public.worldbank_api_metrics ................. [[32mSELECT 16758[0m in 0.29s]
[0m01:50:07.412690 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m01:50:07.415073 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m01:50:07.415917 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m01:50:07.416451 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m01:50:07.417013 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m01:50:07.419204 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m01:50:07.421013 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-30 01:50:07.324669 => 2023-07-30 01:50:07.420951
[0m01:50:07.421810 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m01:50:07.423179 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4405347-2e00-4167-a49b-2b4d1486ccea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f467854d950>]}
[0m01:50:07.423685 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0 seconds
[0m01:50:07.424718 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.11s]
[0m01:50:07.426640 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 01:50:07.189234 => 2023-07-30 01:50:07.426576
[0m01:50:07.427465 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m01:50:07.428021 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m01:50:07.429725 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4405347-2e00-4167-a49b-2b4d1486ccea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4678449350>]}
[0m01:50:07.430388 [info ] [Thread-3 (]: 3 of 4 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.32s]
[0m01:50:07.431352 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m01:50:07.434420 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:50:07.435276 [debug] [MainThread]: Using postgres connection "master"
[0m01:50:07.435932 [debug] [MainThread]: On master: BEGIN
[0m01:50:07.436516 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:50:07.445445 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:50:07.446624 [debug] [MainThread]: On master: COMMIT
[0m01:50:07.447408 [debug] [MainThread]: Using postgres connection "master"
[0m01:50:07.448201 [debug] [MainThread]: On master: COMMIT
[0m01:50:07.449860 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:50:07.451167 [debug] [MainThread]: On master: Close
[0m01:50:07.453403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:50:07.454454 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m01:50:07.455374 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m01:50:07.456148 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m01:50:07.457277 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m01:50:07.458322 [info ] [MainThread]: 
[0m01:50:07.459456 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m01:50:07.461483 [debug] [MainThread]: Command end result
[0m01:50:07.478144 [info ] [MainThread]: 
[0m01:50:07.481056 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:50:07.482606 [info ] [MainThread]: 
[0m01:50:07.484306 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:50:07.485830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4677affb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f467a4629d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f467a119910>]}
[0m01:50:07.486746 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:00:12.828639 | bdf08d55-8e25-4cf4-853d-48963c2672ac ==============================
[0m02:00:12.828639 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:00:12.831697 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:00:12.832917 [debug] [MainThread]: Tracking: tracking
[0m02:00:12.837505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4151d27810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f415204cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4152078e10>]}
[0m02:00:12.850973 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:00:12.917274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:00:12.918493 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m02:00:12.933697 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m02:00:12.963290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdf08d55-8e25-4cf4-853d-48963c2672ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f415205d3d0>]}
[0m02:00:12.978631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdf08d55-8e25-4cf4-853d-48963c2672ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4151d586d0>]}
[0m02:00:12.979598 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:00:12.980674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdf08d55-8e25-4cf4-853d-48963c2672ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f415587b290>]}
[0m02:00:12.982742 [info ] [MainThread]: 
[0m02:00:12.986464 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:00:12.988420 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:00:13.000183 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:00:13.001012 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:00:13.001697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:13.015428 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:00:13.017941 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:00:13.020607 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:00:13.027653 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:00:13.028530 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:00:13.029336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:00:13.038249 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:00:13.039186 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:00:13.039771 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:00:13.046409 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:00:13.048732 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:00:13.049883 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:00:13.057670 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:13.058416 [debug] [MainThread]: On master: BEGIN
[0m02:00:13.059090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:00:13.071543 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:00:13.072922 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:13.073872 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:00:13.144084 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:00:13.146177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdf08d55-8e25-4cf4-853d-48963c2672ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4151d5b690>]}
[0m02:00:13.147150 [debug] [MainThread]: On master: ROLLBACK
[0m02:00:13.148175 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:13.148787 [debug] [MainThread]: On master: BEGIN
[0m02:00:13.150168 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:00:13.151177 [debug] [MainThread]: On master: COMMIT
[0m02:00:13.151801 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:13.152356 [debug] [MainThread]: On master: COMMIT
[0m02:00:13.153153 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:00:13.153724 [debug] [MainThread]: On master: Close
[0m02:00:13.154716 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:00:13.155794 [info ] [MainThread]: 
[0m02:00:13.174903 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m02:00:13.175319 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:00:13.175618 [debug] [Thread-3 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:00:13.176448 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m02:00:13.177500 [info ] [Thread-2 (]: 2 of 4 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:00:13.178844 [info ] [Thread-3 (]: 3 of 4 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:00:13.180624 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m02:00:13.181818 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:00:13.182741 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:00:13.183309 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m02:00:13.183940 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:00:13.184598 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:00:13.188839 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m02:00:13.192225 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:00:13.195895 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m02:00:13.199907 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:00:13.189508 => 2023-07-30 02:00:13.199706
[0m02:00:13.200220 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-30 02:00:13.185195 => 2023-07-30 02:00:13.200097
[0m02:00:13.200909 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:00:13.201196 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:00:13.193413 => 2023-07-30 02:00:13.201096
[0m02:00:13.201661 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m02:00:13.223788 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m02:00:13.268220 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m02:00:13.269785 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:00:13.273852 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m02:00:13.278556 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m02:00:13.278820 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:00:13.279294 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:00:13.279504 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m02:00:13.280148 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:00:13.280722 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m02:00:13.281362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:13.281950 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:00:13.282487 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:00:13.294457 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:00:13.295273 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:00:13.295659 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:00:13.297344 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m02:00:13.298876 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        worldbank_api_value as gdp_value,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_value
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        gdp_value,
        previous_year_gdb,
        previous_year_gdb_value,
         1.0 * a.previous_year_gdb / NULLIF(b.previous_year_gdb_value, 0) - 1 AS gdp_growth,
        MIN(gdp_value) as min_gdp_growth_since_2000,
        MAX(gdp_value) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
  
[0m02:00:13.301156 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m02:00:13.304726 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m02:00:13.305772 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:00:13.306195 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m02:00:13.306530 [debug] [Thread-2 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "a"
LINE 37:          1.0 * a.previous_year_gdb / NULLIF(b.previous_year_...
                        ^

[0m02:00:13.307067 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

generate_surrogate_key as (

    select 
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
)

select *
from generate_surrogate_key
  );
  
[0m02:00:13.314789 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m02:00:13.315590 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: ROLLBACK
[0m02:00:13.316794 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m02:00:13.317957 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:00:13.202025 => 2023-07-30 02:00:13.317873
[0m02:00:13.318713 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:00:13.318974 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:00:13.324396 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m02:00:13.325856 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m02:00:13.328041 [debug] [Thread-2 (]: Database Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)
  missing FROM-clause entry for table "a"
  LINE 37:          1.0 * a.previous_year_gdb / NULLIF(b.previous_year_...
                          ^
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:00:13.328408 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:00:13.330016 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdf08d55-8e25-4cf4-853d-48963c2672ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41501b8c10>]}
[0m02:00:13.348078 [error] [Thread-2 (]: 2 of 4 ERROR creating sql table model public.worldbank_api_metrics ............. [[31mERROR[0m in 0.15s]
[0m02:00:13.365037 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m02:00:13.366807 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:00:13.367491 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m02:00:13.369210 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m02:00:13.372960 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:00:13.380179 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m02:00:13.380865 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m02:00:13.387045 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:00:13.389503 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-30 02:00:13.236648 => 2023-07-30 02:00:13.389253
[0m02:00:13.390524 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m02:00:13.392396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdf08d55-8e25-4cf4-853d-48963c2672ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4151da0850>]}
[0m02:00:13.393377 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.21s]
[0m02:00:13.394283 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m02:00:13.395483 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m02:00:13.396436 [info ] [Thread-4 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m02:00:13.398178 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m02:00:13.399072 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m02:00:13.402378 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m02:00:13.404538 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-30 02:00:13.399842 => 2023-07-30 02:00:13.404454
[0m02:00:13.405070 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m02:00:13.424718 [debug] [Thread-3 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:00:13.427923 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m02:00:13.432383 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:00:13.434343 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m02:00:13.435910 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m02:00:13.436333 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:00:13.437159 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m02:00:13.440774 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:00:13.441538 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:00:13.442204 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m02:00:13.444751 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:00:13.448813 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:00:13.449787 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:00:13.450372 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:00:13.452984 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m02:00:13.456508 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:00:13.456818 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m02:00:13.457413 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m02:00:13.457909 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m02:00:13.458901 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m02:00:13.463170 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m02:00:13.463619 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0 seconds
[0m02:00:13.466739 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m02:00:13.469019 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 02:00:13.270022 => 2023-07-30 02:00:13.468952
[0m02:00:13.469648 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m02:00:13.470398 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m02:00:13.472315 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdf08d55-8e25-4cf4-853d-48963c2672ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4150097550>]}
[0m02:00:13.472642 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:00:13.473620 [info ] [Thread-3 (]: 3 of 4 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.29s]
[0m02:00:13.476324 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m02:00:13.477297 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:00:13.477840 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m02:00:13.479141 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m02:00:13.480554 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m02:00:13.483056 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m02:00:13.483921 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m02:00:13.485141 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m02:00:13.486956 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-30 02:00:13.405621 => 2023-07-30 02:00:13.486892
[0m02:00:13.487676 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m02:00:13.489593 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdf08d55-8e25-4cf4-853d-48963c2672ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4150094a50>]}
[0m02:00:13.490859 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.09s]
[0m02:00:13.492225 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m02:00:13.496798 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:00:13.498068 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:13.499035 [debug] [MainThread]: On master: BEGIN
[0m02:00:13.499822 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:00:13.509350 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:00:13.510561 [debug] [MainThread]: On master: COMMIT
[0m02:00:13.511293 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:13.511881 [debug] [MainThread]: On master: COMMIT
[0m02:00:13.512825 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:00:13.513541 [debug] [MainThread]: On master: Close
[0m02:00:13.514729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:00:13.515495 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m02:00:13.516178 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:00:13.516712 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:00:13.517242 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m02:00:13.517869 [info ] [MainThread]: 
[0m02:00:13.518801 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m02:00:13.520259 [debug] [MainThread]: Command end result
[0m02:00:13.530666 [info ] [MainThread]: 
[0m02:00:13.531667 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:00:13.532604 [info ] [MainThread]: 
[0m02:00:13.533490 [error] [MainThread]: [33mDatabase Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)[0m
[0m02:00:13.534401 [error] [MainThread]:   missing FROM-clause entry for table "a"
[0m02:00:13.535223 [error] [MainThread]:   LINE 37:          1.0 * a.previous_year_gdb / NULLIF(b.previous_year_...
[0m02:00:13.536392 [error] [MainThread]:                           ^
[0m02:00:13.537225 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:00:13.538866 [info ] [MainThread]: 
[0m02:00:13.540828 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m02:00:13.542273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4151877ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4151876d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4151bad710>]}
[0m02:00:13.542990 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:00:37.193765 | c4a0ee79-b6d2-4fb4-b0bc-dc806b64283f ==============================
[0m02:00:37.193765 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:00:37.196400 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:00:37.197667 [debug] [MainThread]: Tracking: tracking
[0m02:00:37.202035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68814a8710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68811852d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68812adc50>]}
[0m02:00:37.216456 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:00:37.280724 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:00:37.281832 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m02:00:37.297407 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m02:00:37.323441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4a0ee79-b6d2-4fb4-b0bc-dc806b64283f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880cab890>]}
[0m02:00:37.338355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4a0ee79-b6d2-4fb4-b0bc-dc806b64283f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687f5dec90>]}
[0m02:00:37.340014 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:00:37.341591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4a0ee79-b6d2-4fb4-b0bc-dc806b64283f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687f560a50>]}
[0m02:00:37.344452 [info ] [MainThread]: 
[0m02:00:37.351347 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:00:37.355161 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:00:37.374724 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:00:37.377279 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:00:37.380062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:37.401174 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:00:37.404251 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:00:37.409389 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:00:37.421800 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:00:37.423394 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:00:37.424631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:00:37.435031 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:00:37.436101 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:00:37.436833 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:00:37.445450 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:00:37.448278 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:00:37.449707 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:00:37.457611 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:37.458513 [debug] [MainThread]: On master: BEGIN
[0m02:00:37.459330 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:00:37.468667 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:00:37.469729 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:37.470691 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:00:37.488827 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:00:37.491809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4a0ee79-b6d2-4fb4-b0bc-dc806b64283f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880c4f150>]}
[0m02:00:37.493164 [debug] [MainThread]: On master: ROLLBACK
[0m02:00:37.494634 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:37.495403 [debug] [MainThread]: On master: BEGIN
[0m02:00:37.496745 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:00:37.497692 [debug] [MainThread]: On master: COMMIT
[0m02:00:37.498449 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:37.499083 [debug] [MainThread]: On master: COMMIT
[0m02:00:37.499963 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:00:37.500696 [debug] [MainThread]: On master: Close
[0m02:00:37.501898 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:00:37.502721 [info ] [MainThread]: 
[0m02:00:37.522925 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m02:00:37.523277 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:00:37.525580 [info ] [Thread-2 (]: 2 of 4 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:00:37.524438 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m02:00:37.523648 [debug] [Thread-3 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:00:37.527549 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:00:37.528929 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m02:00:37.529659 [info ] [Thread-3 (]: 3 of 4 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:00:37.530688 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:00:37.531592 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m02:00:37.532555 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:00:37.536834 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:00:37.540141 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m02:00:37.540862 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:00:37.545540 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m02:00:37.546875 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:00:37.533153 => 2023-07-30 02:00:37.546758
[0m02:00:37.547122 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-30 02:00:37.537877 => 2023-07-30 02:00:37.547057
[0m02:00:37.548464 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:00:37.549369 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:00:37.542831 => 2023-07-30 02:00:37.549213
[0m02:00:37.549745 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m02:00:37.567640 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m02:00:37.609668 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m02:00:37.611716 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:00:37.616268 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m02:00:37.619676 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:00:37.620038 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m02:00:37.620630 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:00:37.620859 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:00:37.621492 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m02:00:37.622151 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m02:00:37.622771 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:00:37.623387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:37.624017 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:00:37.637775 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:00:37.638707 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m02:00:37.639350 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m02:00:37.643709 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m02:00:37.644071 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:00:37.644446 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m02:00:37.645368 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:00:37.646312 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:00:37.653843 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m02:00:37.654515 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

generate_surrogate_key as (

    select 
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
)

select *
from generate_surrogate_key
  );
  
[0m02:00:37.655240 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        worldbank_api_value as gdp_value,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_value
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        gdp_value,
        previous_year_gdb,
        previous_year_gdb_value,
         1.0 * previous_year_gdb / NULLIF(previous_year_gdb_value, 0) - 1 AS gdp_growth,
        MIN(gdp_value) as min_gdp_growth_since_2000,
        MAX(gdp_value) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
  
[0m02:00:37.655928 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m02:00:37.660028 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:00:37.663074 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m02:00:37.663815 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m02:00:37.666609 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:00:37.700165 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m02:00:37.703569 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m02:00:37.705084 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m02:00:37.708992 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:00:37.715444 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m02:00:37.716370 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m02:00:37.721872 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:00:37.724071 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-30 02:00:37.589546 => 2023-07-30 02:00:37.724010
[0m02:00:37.724898 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m02:00:37.726077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a0ee79-b6d2-4fb4-b0bc-dc806b64283f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687f5ac610>]}
[0m02:00:37.727067 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.20s]
[0m02:00:37.729346 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m02:00:37.730784 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m02:00:37.732091 [info ] [Thread-4 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m02:00:37.733459 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m02:00:37.734459 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m02:00:37.737545 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m02:00:37.740103 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-30 02:00:37.735100 => 2023-07-30 02:00:37.740030
[0m02:00:37.741961 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m02:00:37.763616 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m02:00:37.767164 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m02:00:37.769049 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m02:00:37.769786 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:00:37.778023 [debug] [Thread-3 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:00:37.783660 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:00:37.784849 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m02:00:37.785910 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m02:00:37.788011 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m02:00:37.791349 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m02:00:37.797435 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m02:00:37.801785 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m02:00:37.802566 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m02:00:37.804048 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:00:37.805990 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m02:00:37.807201 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m02:00:37.808510 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m02:00:37.812320 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m02:00:37.816783 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m02:00:37.817542 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m02:00:37.818705 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m02:00:37.820516 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-30 02:00:37.743168 => 2023-07-30 02:00:37.820454
[0m02:00:37.821379 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m02:00:37.823325 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a0ee79-b6d2-4fb4-b0bc-dc806b64283f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687f4f37d0>]}
[0m02:00:37.824935 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.09s]
[0m02:00:37.826197 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m02:00:37.867145 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:00:37.871719 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:00:37.872610 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics" rename to "worldbank_api_metrics__dbt_backup"
[0m02:00:37.874333 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:00:37.877752 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:00:37.878551 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" rename to "worldbank_api_metrics"
[0m02:00:37.879938 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:00:37.882350 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m02:00:37.882952 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:00:37.883442 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m02:00:37.889089 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m02:00:37.889432 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:00:37.892019 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:00:37.896006 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:00:37.896693 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_metrics__dbt_backup" cascade
[0m02:00:37.897385 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m02:00:37.899582 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:00:37.904324 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:00:37.905415 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:00:37.905774 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m02:00:37.906601 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:00:37.908915 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:00:37.550485 => 2023-07-30 02:00:37.908859
[0m02:00:37.910431 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:00:37.910822 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m02:00:37.912029 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a0ee79-b6d2-4fb4-b0bc-dc806b64283f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687f50afd0>]}
[0m02:00:37.915854 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:00:37.917157 [info ] [Thread-2 (]: 2 of 4 OK created sql table model public.worldbank_api_metrics ................. [[32mSELECT 16758[0m in 0.39s]
[0m02:00:37.918516 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m02:00:37.919910 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:00:37.925879 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0 seconds
[0m02:00:37.927547 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 02:00:37.612257 => 2023-07-30 02:00:37.927492
[0m02:00:37.928164 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m02:00:37.929317 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a0ee79-b6d2-4fb4-b0bc-dc806b64283f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687eb21ad0>]}
[0m02:00:37.930233 [info ] [Thread-3 (]: 3 of 4 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.40s]
[0m02:00:37.931231 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:00:37.934551 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:00:37.935141 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:37.935756 [debug] [MainThread]: On master: BEGIN
[0m02:00:37.936413 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:00:37.945741 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:00:37.946593 [debug] [MainThread]: On master: COMMIT
[0m02:00:37.947021 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:37.947363 [debug] [MainThread]: On master: COMMIT
[0m02:00:37.947937 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:00:37.948312 [debug] [MainThread]: On master: Close
[0m02:00:37.949059 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:00:37.949409 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m02:00:37.949875 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:00:37.950222 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:00:37.950526 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m02:00:37.950965 [info ] [MainThread]: 
[0m02:00:37.951445 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m02:00:37.952616 [debug] [MainThread]: Command end result
[0m02:00:37.961219 [info ] [MainThread]: 
[0m02:00:37.962332 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:00:37.963265 [info ] [MainThread]: 
[0m02:00:37.964511 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m02:00:37.965642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68814aa310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6881451850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6880cb0610>]}
[0m02:00:37.966547 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:06:38.440202 | 2ec7f65a-0005-41fd-a068-32392e2ed1bd ==============================
[0m02:06:38.440202 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:06:38.443245 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:06:38.444455 [debug] [MainThread]: Tracking: tracking
[0m02:06:38.447937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b2354d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b2b98b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b2876410>]}
[0m02:06:38.462091 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:06:38.515575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:06:38.516600 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m02:06:38.532354 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m02:06:38.558872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ec7f65a-0005-41fd-a068-32392e2ed1bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b0c8a190>]}
[0m02:06:38.574051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ec7f65a-0005-41fd-a068-32392e2ed1bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b0c0a950>]}
[0m02:06:38.575242 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:06:38.576485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ec7f65a-0005-41fd-a068-32392e2ed1bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b28de490>]}
[0m02:06:38.579377 [info ] [MainThread]: 
[0m02:06:38.582830 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:06:38.585012 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:06:38.596946 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:06:38.598084 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:06:38.598788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:06:38.613086 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:06:38.615221 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:06:38.617865 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:06:38.624428 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:06:38.625161 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:06:38.625744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:06:38.634962 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:06:38.636082 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:06:38.636923 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:06:38.643910 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:06:38.645904 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:06:38.646742 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:06:38.653761 [debug] [MainThread]: Using postgres connection "master"
[0m02:06:38.654438 [debug] [MainThread]: On master: BEGIN
[0m02:06:38.654947 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:06:38.663624 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:06:38.664623 [debug] [MainThread]: Using postgres connection "master"
[0m02:06:38.665239 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:06:38.679720 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:06:38.681660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ec7f65a-0005-41fd-a068-32392e2ed1bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b2925d50>]}
[0m02:06:38.682597 [debug] [MainThread]: On master: ROLLBACK
[0m02:06:38.683722 [debug] [MainThread]: Using postgres connection "master"
[0m02:06:38.684389 [debug] [MainThread]: On master: BEGIN
[0m02:06:38.685540 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:06:38.686682 [debug] [MainThread]: On master: COMMIT
[0m02:06:38.687621 [debug] [MainThread]: Using postgres connection "master"
[0m02:06:38.688489 [debug] [MainThread]: On master: COMMIT
[0m02:06:38.689679 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:06:38.690472 [debug] [MainThread]: On master: Close
[0m02:06:38.691590 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:06:38.692560 [info ] [MainThread]: 
[0m02:06:38.711243 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m02:06:38.711762 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:06:38.712337 [debug] [Thread-3 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:06:38.712866 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m02:06:38.714016 [info ] [Thread-2 (]: 2 of 4 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:06:38.714926 [info ] [Thread-3 (]: 3 of 4 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:06:38.716386 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.my_first_dbt_model'
[0m02:06:38.717386 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:06:38.718325 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:06:38.718895 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m02:06:38.719550 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:06:38.720367 [debug] [Thread-3 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:06:38.724404 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m02:06:38.728045 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:06:38.732447 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m02:06:38.736381 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (compile): 2023-07-30 02:06:38.720957 => 2023-07-30 02:06:38.736173
[0m02:06:38.736848 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:06:38.725287 => 2023-07-30 02:06:38.736758
[0m02:06:38.737444 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m02:06:38.737703 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:06:38.729587 => 2023-07-30 02:06:38.737629
[0m02:06:38.738484 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:06:38.761264 [debug] [Thread-3 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m02:06:38.790242 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m02:06:38.792307 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:06:38.797127 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m02:06:38.801149 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:06:38.801491 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m02:06:38.801923 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:06:38.802135 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:06:38.802542 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m02:06:38.803138 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m02:06:38.803663 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:06:38.804104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:38.804591 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:06:38.816446 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:06:38.817184 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m02:06:38.817553 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m02:06:38.818328 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:06:38.819198 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m02:06:38.819684 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

generate_surrogate_key as (

    select 
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
)

select *
from generate_surrogate_key
  );
  
[0m02:06:38.821665 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:06:38.822491 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:06:38.823089 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        worldbank_api_value as gdp_value,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_value
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        gdp_value,
        previous_year_gdb,
        previous_year_gdb_value,
         1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1 AS gdp_growth,
        MIN(gdp_value) as min_gdp_growth_since_2000,
        MAX(gdp_value) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
  
[0m02:06:38.826911 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m02:06:38.834458 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m02:06:38.835348 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m02:06:38.837701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:06:38.841820 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m02:06:38.842807 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "worldbank_api_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m02:06:38.844594 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:06:38.884500 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m02:06:38.885245 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m02:06:38.885966 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m02:06:38.890782 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:06:38.898228 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m02:06:38.899336 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "worldbank_api_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m02:06:38.908276 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:06:38.911468 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.my_first_dbt_model (execute): 2023-07-30 02:06:38.738989 => 2023-07-30 02:06:38.911367
[0m02:06:38.912623 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m02:06:38.914450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ec7f65a-0005-41fd-a068-32392e2ed1bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b0b98ed0>]}
[0m02:06:38.915660 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.20s]
[0m02:06:38.918753 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m02:06:38.920333 [debug] [Thread-4 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m02:06:38.921241 [info ] [Thread-4 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m02:06:38.922857 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt_project.my_second_dbt_model'
[0m02:06:38.923594 [debug] [Thread-4 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m02:06:38.927324 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m02:06:38.928260 [debug] [Thread-3 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:06:38.932306 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:06:38.933428 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m02:06:38.933933 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (compile): 2023-07-30 02:06:38.924270 => 2023-07-30 02:06:38.933707
[0m02:06:38.935730 [debug] [Thread-4 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m02:06:38.976894 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m02:06:38.979806 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m02:06:38.980500 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m02:06:38.981206 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:06:39.001784 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m02:06:39.002672 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m02:06:39.003271 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "worldbank_api_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m02:06:39.011498 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0 seconds
[0m02:06:39.015441 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m02:06:39.016476 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "worldbank_api_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m02:06:39.018478 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:06:39.021082 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m02:06:39.021423 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:06:39.022228 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m02:06:39.025316 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:06:39.026111 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m02:06:39.026978 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics" rename to "worldbank_api_metrics__dbt_backup"
[0m02:06:39.029313 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:06:39.032549 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:06:39.032792 [debug] [Thread-4 (]: SQL status: COMMIT in 0 seconds
[0m02:06:39.033347 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" rename to "worldbank_api_metrics"
[0m02:06:39.036175 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m02:06:39.037728 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "worldbank_api_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m02:06:39.037998 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:06:39.039106 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0 seconds
[0m02:06:39.041894 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m02:06:39.043817 [debug] [Thread-4 (]: Timing info for model.my_dbt_project.my_second_dbt_model (execute): 2023-07-30 02:06:38.936534 => 2023-07-30 02:06:39.043748
[0m02:06:39.044941 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:06:39.045907 [debug] [Thread-4 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m02:06:39.046920 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m02:06:39.048651 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ec7f65a-0005-41fd-a068-32392e2ed1bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b0c4e610>]}
[0m02:06:39.050545 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m02:06:39.050296 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.13s]
[0m02:06:39.051152 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:06:39.053565 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:06:39.054382 [debug] [Thread-4 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m02:06:39.057597 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:06:39.058344 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_metrics__dbt_backup" cascade
[0m02:06:39.059696 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m02:06:39.061412 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:06:39.066954 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:06:39.067204 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m02:06:39.067755 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:06:39.069417 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:06:38.782991 => 2023-07-30 02:06:39.069363
[0m02:06:39.070158 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:06:39.070856 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:06:39.072836 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ec7f65a-0005-41fd-a068-32392e2ed1bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b2c57a90>]}
[0m02:06:39.073114 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m02:06:39.074036 [info ] [Thread-2 (]: 2 of 4 OK created sql table model public.worldbank_api_metrics ................. [[32mSELECT 16758[0m in 0.36s]
[0m02:06:39.077547 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:06:39.078459 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:06:39.079247 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m02:06:39.085343 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0 seconds
[0m02:06:39.087315 [debug] [Thread-3 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 02:06:38.793255 => 2023-07-30 02:06:39.087244
[0m02:06:39.088028 [debug] [Thread-3 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m02:06:39.089308 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ec7f65a-0005-41fd-a068-32392e2ed1bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b0b05710>]}
[0m02:06:39.090309 [info ] [Thread-3 (]: 3 of 4 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.37s]
[0m02:06:39.091902 [debug] [Thread-3 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:06:39.095295 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:06:39.095907 [debug] [MainThread]: Using postgres connection "master"
[0m02:06:39.096310 [debug] [MainThread]: On master: BEGIN
[0m02:06:39.096634 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:06:39.125075 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:06:39.125868 [debug] [MainThread]: On master: COMMIT
[0m02:06:39.126533 [debug] [MainThread]: Using postgres connection "master"
[0m02:06:39.127134 [debug] [MainThread]: On master: COMMIT
[0m02:06:39.127991 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:06:39.128500 [debug] [MainThread]: On master: Close
[0m02:06:39.129421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:06:39.130026 [debug] [MainThread]: Connection 'model.my_dbt_project.my_first_dbt_model' was properly closed.
[0m02:06:39.130398 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:06:39.130756 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:06:39.131062 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m02:06:39.131452 [info ] [MainThread]: 
[0m02:06:39.132193 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m02:06:39.133333 [debug] [MainThread]: Command end result
[0m02:06:39.142212 [info ] [MainThread]: 
[0m02:06:39.142895 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:06:39.143496 [info ] [MainThread]: 
[0m02:06:39.144162 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m02:06:39.144878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b242c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b2c43e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b0be7c90>]}
[0m02:06:39.145477 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:16:34.857482 | f2cab999-2df6-47f4-9534-25c950da5f8f ==============================
[0m02:16:34.857482 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:16:34.860450 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:16:34.861855 [debug] [MainThread]: Tracking: tracking
[0m02:16:34.865150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3543731550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f354179a810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35433c3b50>]}
[0m02:16:34.878435 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:16:34.926172 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 1 files changed.
[0m02:16:34.928336 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/example/my_second_dbt_model.sql
[0m02:16:34.929402 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/example/my_first_dbt_model.sql
[0m02:16:34.930808 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_stg.sql
[0m02:16:34.948691 [debug] [MainThread]: 1603: static parser failed on example/worldbank_api_stg.sql
[0m02:16:34.972792 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/worldbank_api_stg.sql
[0m02:16:34.992982 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m02:16:34.996305 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m02:16:35.017142 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_project.unique_my_second_dbt_model_id.57a0f8c493' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m02:16:35.019269 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_project.not_null_my_second_dbt_model_id.151b76d778' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m02:16:35.020995 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_project.unique_my_first_dbt_model_id.16e066b321' (models/example/schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m02:16:35.022693 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710' (models/example/schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m02:16:35.042534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2cab999-2df6-47f4-9534-25c950da5f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35416ba3d0>]}
[0m02:16:35.065170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2cab999-2df6-47f4-9534-25c950da5f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35416ce350>]}
[0m02:16:35.065997 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:16:35.067238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2cab999-2df6-47f4-9534-25c950da5f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3545dfca10>]}
[0m02:16:35.069061 [info ] [MainThread]: 
[0m02:16:35.071843 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:16:35.076942 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:16:35.110312 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:16:35.111376 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:16:35.112371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:16:35.128439 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:16:35.153498 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:16:35.157859 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:16:35.169464 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:16:35.170594 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:16:35.171416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:16:35.201506 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:16:35.202729 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:16:35.203547 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:16:35.235356 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:16:35.238527 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:16:35.240185 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:16:35.249593 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:35.250452 [debug] [MainThread]: On master: BEGIN
[0m02:16:35.251243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:16:35.279294 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:16:35.280133 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:35.280714 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:16:35.345295 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:16:35.347051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2cab999-2df6-47f4-9534-25c950da5f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35437fb610>]}
[0m02:16:35.347849 [debug] [MainThread]: On master: ROLLBACK
[0m02:16:35.348658 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:35.349384 [debug] [MainThread]: On master: BEGIN
[0m02:16:35.350625 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:16:35.351587 [debug] [MainThread]: On master: COMMIT
[0m02:16:35.352249 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:35.352670 [debug] [MainThread]: On master: COMMIT
[0m02:16:35.353367 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:16:35.353803 [debug] [MainThread]: On master: Close
[0m02:16:35.354607 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:16:35.355722 [info ] [MainThread]: 
[0m02:16:35.373985 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:16:35.374669 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:16:35.375688 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:16:35.376901 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:16:35.378135 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:16:35.380996 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:16:35.382434 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:16:35.383631 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:16:35.387581 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:16:35.394519 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:16:35.388767 => 2023-07-30 02:16:35.394427
[0m02:16:35.399636 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:16:35.384170 => 2023-07-30 02:16:35.399464
[0m02:16:35.400736 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:16:35.442029 [debug] [Thread-2 (]: Compilation Error in model worldbank_api_stg (models/example/worldbank_api_stg.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m02:16:35.453001 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:16:35.453425 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2cab999-2df6-47f4-9534-25c950da5f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35416d1510>]}
[0m02:16:35.455464 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model public.worldbank_api_stg ................. [[31mERROR[0m in 0.07s]
[0m02:16:35.458107 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:16:35.459525 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:16:35.460311 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:16:35.460864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:16:35.469995 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:16:35.470862 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:16:35.471552 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        worldbank_api_value as gdp_value,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_value
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        gdp_value,
        previous_year_gdb,
        previous_year_gdb_value,
         1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1 AS gdp_growth,
        MIN(gdp_value) as min_gdp_growth_since_2000,
        MAX(gdp_value) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
  
[0m02:16:35.616194 [debug] [Thread-1 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:16:35.624725 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:16:35.625725 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics" rename to "worldbank_api_metrics__dbt_backup"
[0m02:16:35.627389 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:16:35.630914 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:16:35.631994 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" rename to "worldbank_api_metrics"
[0m02:16:35.633544 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:16:35.656033 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m02:16:35.657038 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:16:35.658101 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m02:16:35.664199 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:16:35.670446 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:16:35.671508 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_metrics__dbt_backup" cascade
[0m02:16:35.677013 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:16:35.679255 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:16:35.401980 => 2023-07-30 02:16:35.679184
[0m02:16:35.680196 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:16:35.681675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2cab999-2df6-47f4-9534-25c950da5f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35416ecc10>]}
[0m02:16:35.682850 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.worldbank_api_metrics ................. [[32mSELECT 16758[0m in 0.30s]
[0m02:16:35.684556 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:16:35.688280 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:16:35.688989 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:35.689503 [debug] [MainThread]: On master: BEGIN
[0m02:16:35.690129 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:16:35.699376 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:16:35.700383 [debug] [MainThread]: On master: COMMIT
[0m02:16:35.700969 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:35.701463 [debug] [MainThread]: On master: COMMIT
[0m02:16:35.702304 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:16:35.703096 [debug] [MainThread]: On master: Close
[0m02:16:35.704122 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:16:35.704763 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:16:35.705310 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:16:35.705927 [info ] [MainThread]: 
[0m02:16:35.706701 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m02:16:35.707872 [debug] [MainThread]: Command end result
[0m02:16:35.721116 [info ] [MainThread]: 
[0m02:16:35.722493 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:16:35.723999 [info ] [MainThread]: 
[0m02:16:35.725328 [error] [MainThread]: [33mCompilation Error in model worldbank_api_stg (models/example/worldbank_api_stg.sql)[0m
[0m02:16:35.727232 [error] [MainThread]:   'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m02:16:35.729118 [info ] [MainThread]: 
[0m02:16:35.730842 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m02:16:35.732217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3541717690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35434ae150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35434af4d0>]}
[0m02:16:35.733363 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:18:04.051845 | 25c0b8bf-e536-4240-8ee8-8f91b7419df0 ==============================
[0m02:18:04.051845 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:18:04.054363 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:18:04.055261 [debug] [MainThread]: Tracking: tracking
[0m02:18:04.058493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e6263450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e67e9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e61ff0d0>]}
[0m02:18:04.072181 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:18:04.120620 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:18:04.121927 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:18:04.133601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25c0b8bf-e536-4240-8ee8-8f91b7419df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e627acd0>]}
[0m02:18:04.144577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25c0b8bf-e536-4240-8ee8-8f91b7419df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e675ef50>]}
[0m02:18:04.145438 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:18:04.146683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25c0b8bf-e536-4240-8ee8-8f91b7419df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e6262ad0>]}
[0m02:18:04.148660 [info ] [MainThread]: 
[0m02:18:04.151683 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:18:04.154495 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:18:04.166726 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:18:04.167514 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:18:04.168007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:04.183517 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:18:04.185368 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:18:04.187959 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:18:04.195091 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:18:04.195712 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:18:04.196288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:18:04.205652 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:18:04.206529 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:18:04.207135 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:18:04.213967 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:18:04.216270 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:18:04.217297 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:18:04.224473 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:04.225072 [debug] [MainThread]: On master: BEGIN
[0m02:18:04.225587 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:18:04.235583 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:18:04.236407 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:04.237099 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:18:04.256304 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:18:04.258749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25c0b8bf-e536-4240-8ee8-8f91b7419df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e4b12210>]}
[0m02:18:04.259650 [debug] [MainThread]: On master: ROLLBACK
[0m02:18:04.260847 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:04.261745 [debug] [MainThread]: On master: BEGIN
[0m02:18:04.263300 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:18:04.264163 [debug] [MainThread]: On master: COMMIT
[0m02:18:04.264771 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:04.265301 [debug] [MainThread]: On master: COMMIT
[0m02:18:04.266215 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:18:04.267021 [debug] [MainThread]: On master: Close
[0m02:18:04.268190 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:18:04.269162 [info ] [MainThread]: 
[0m02:18:04.291073 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:18:04.291447 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:18:04.292353 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:18:04.293747 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:18:04.295396 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:18:04.296610 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:18:04.297814 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:18:04.298798 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:18:04.303103 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:18:04.309960 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:18:04.303941 => 2023-07-30 02:18:04.309745
[0m02:18:04.316510 [debug] [Thread-2 (]: Compilation Error in model worldbank_api_stg (models/example/worldbank_api_stg.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m02:18:04.317016 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:18:04.300130 => 2023-07-30 02:18:04.316783
[0m02:18:04.318322 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25c0b8bf-e536-4240-8ee8-8f91b7419df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e4aa82d0>]}
[0m02:18:04.319651 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:18:04.321854 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model public.worldbank_api_stg ................. [[31mERROR[0m in 0.02s]
[0m02:18:04.358529 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:18:04.408027 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:18:04.412240 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:18:04.412909 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:18:04.413599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:04.442717 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:18:04.444702 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:18:04.449801 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        worldbank_api_value as gdp_value,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_value
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        gdp_value,
        previous_year_gdb,
        previous_year_gdb_value,
         1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1 AS gdp_growth,
        MIN(gdp_value) as min_gdp_growth_since_2000,
        MAX(gdp_value) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
  
[0m02:18:04.543975 [debug] [Thread-1 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:18:04.553001 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:18:04.554101 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics" rename to "worldbank_api_metrics__dbt_backup"
[0m02:18:04.555880 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:18:04.559444 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:18:04.560450 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" rename to "worldbank_api_metrics"
[0m02:18:04.561970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:18:04.588289 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m02:18:04.589250 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:18:04.590114 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m02:18:04.594260 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:18:04.600107 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:18:04.600936 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_metrics__dbt_backup" cascade
[0m02:18:04.605823 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:18:04.607699 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:18:04.324117 => 2023-07-30 02:18:04.607637
[0m02:18:04.608466 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:18:04.609641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25c0b8bf-e536-4240-8ee8-8f91b7419df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e69c3f10>]}
[0m02:18:04.610519 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.worldbank_api_metrics ................. [[32mSELECT 16758[0m in 0.31s]
[0m02:18:04.611658 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:18:04.614781 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:18:04.615463 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:04.616075 [debug] [MainThread]: On master: BEGIN
[0m02:18:04.616625 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:18:04.625963 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:18:04.626561 [debug] [MainThread]: On master: COMMIT
[0m02:18:04.627139 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:04.627547 [debug] [MainThread]: On master: COMMIT
[0m02:18:04.628655 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:18:04.629621 [debug] [MainThread]: On master: Close
[0m02:18:04.630598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:18:04.631139 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:18:04.631685 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:18:04.632304 [info ] [MainThread]: 
[0m02:18:04.633203 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m02:18:04.634290 [debug] [MainThread]: Command end result
[0m02:18:04.645736 [info ] [MainThread]: 
[0m02:18:04.646914 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:18:04.648275 [info ] [MainThread]: 
[0m02:18:04.649300 [error] [MainThread]: [33mCompilation Error in model worldbank_api_stg (models/example/worldbank_api_stg.sql)[0m
[0m02:18:04.650676 [error] [MainThread]:   'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m02:18:04.651800 [info ] [MainThread]: 
[0m02:18:04.652679 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m02:18:04.654162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e6243150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e673a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e6739910>]}
[0m02:18:04.655214 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:19:48.756446 | 33c56b3b-97a8-44d0-9ca0-a0d1abda197e ==============================
[0m02:19:48.756446 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:19:48.759396 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m02:19:48.760335 [debug] [MainThread]: Tracking: tracking
[0m02:19:48.762966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab4fab850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab54e0750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab4fa8390>]}
[0m02:19:48.763987 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:19:48.764941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab4fa9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab4fab850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab590e950>]}
[0m02:19:48.765772 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:21:06.008879 | d4f2226a-0478-4540-ade1-7f5a59ffaf6d ==============================
[0m02:21:06.008879 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:21:06.012017 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m02:21:06.013166 [debug] [MainThread]: Tracking: tracking
[0m02:21:06.015998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa473d54650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa473973c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4734931d0>]}
[0m02:21:06.017356 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:21:06.018669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa473d54150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa473d54650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa473937250>]}
[0m02:21:06.020068 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:21:37.277558 | 774a8472-7645-4699-a9cf-ec5a7b3f6439 ==============================
[0m02:21:37.277558 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:21:37.279939 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m02:21:37.280757 [debug] [MainThread]: Tracking: tracking
[0m02:21:37.284333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381d24c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381ca78a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381ca68ad0>]}
[0m02:21:37.291138 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jctmigo0'
[0m02:21:37.292086 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:21:37.453292 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:21:37.455069 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:21:37.559829 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:21:37.575438 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:21:39.182914 [info ] [MainThread]:   Installed from version 1.0.0
[0m02:21:39.184439 [info ] [MainThread]:   Updated version available: 1.1.1
[0m02:21:39.185520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '774a8472-7645-4699-a9cf-ec5a7b3f6439', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381d2757d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381d245ad0>]}
[0m02:21:39.186576 [info ] [MainThread]: 
[0m02:21:39.187826 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m02:21:39.190204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381ca78a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381ca787d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381d2757d0>]}
[0m02:21:39.191244 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:21:50.165691 | 25f0b779-419b-41d9-99fd-736b13fd5e6c ==============================
[0m02:21:50.165691 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:21:50.168893 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:21:50.169825 [debug] [MainThread]: Tracking: tracking
[0m02:21:50.174440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd5b3aa750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd5b379110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd5b389690>]}
[0m02:21:50.208345 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:21:50.228391 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m02:21:50.230223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '25f0b779-419b-41d9-99fd-736b13fd5e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd5952de50>]}
[0m02:21:51.506089 [debug] [MainThread]: 1603: static parser failed on example/worldbank_api_stg.sql
[0m02:21:51.545244 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/worldbank_api_stg.sql
[0m02:21:51.550224 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m02:21:51.591548 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m02:21:51.594770 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m02:21:51.618427 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_project.unique_my_first_dbt_model_id.16e066b321' (models/example/schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m02:21:51.619718 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710' (models/example/schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m02:21:51.620803 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_project.unique_my_second_dbt_model_id.57a0f8c493' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m02:21:51.622035 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_project.not_null_my_second_dbt_model_id.151b76d778' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m02:21:51.656040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25f0b779-419b-41d9-99fd-736b13fd5e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd59506f10>]}
[0m02:21:51.671637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25f0b779-419b-41d9-99fd-736b13fd5e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd58a3b3d0>]}
[0m02:21:51.672300 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:21:51.673421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25f0b779-419b-41d9-99fd-736b13fd5e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd5eb9ea10>]}
[0m02:21:51.675222 [info ] [MainThread]: 
[0m02:21:51.677850 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:21:51.680253 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:21:51.692655 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:21:51.693620 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:21:51.694289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:21:51.708651 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:21:51.710771 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:21:51.713124 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:21:51.720409 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:21:51.721275 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:21:51.721934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:21:51.732107 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:21:51.733208 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:21:51.734165 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:21:51.745195 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:21:51.747600 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:21:51.749184 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:21:51.811264 [debug] [MainThread]: Using postgres connection "master"
[0m02:21:51.812375 [debug] [MainThread]: On master: BEGIN
[0m02:21:51.813300 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:21:51.823849 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:21:51.824780 [debug] [MainThread]: Using postgres connection "master"
[0m02:21:51.825528 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:21:51.849525 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:21:51.851992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25f0b779-419b-41d9-99fd-736b13fd5e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd5946e290>]}
[0m02:21:51.853102 [debug] [MainThread]: On master: ROLLBACK
[0m02:21:51.854444 [debug] [MainThread]: Using postgres connection "master"
[0m02:21:51.855343 [debug] [MainThread]: On master: BEGIN
[0m02:21:51.856943 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:21:51.858116 [debug] [MainThread]: On master: COMMIT
[0m02:21:51.858955 [debug] [MainThread]: Using postgres connection "master"
[0m02:21:51.859618 [debug] [MainThread]: On master: COMMIT
[0m02:21:51.860512 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:21:51.861180 [debug] [MainThread]: On master: Close
[0m02:21:51.862291 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:21:51.863452 [info ] [MainThread]: 
[0m02:21:51.883103 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:21:51.883562 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:21:51.884464 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:21:51.886043 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:21:51.887384 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:21:51.888299 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:21:51.889160 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:21:51.889745 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:21:51.892969 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:21:51.900588 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m02:21:51.906062 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:21:51.893475 => 2023-07-30 02:21:51.905830
[0m02:21:51.906530 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:21:51.890374 => 2023-07-30 02:21:51.906414
[0m02:21:51.906839 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m02:21:51.907720 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:21:51.977556 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m02:21:51.979433 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:21:51.984542 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:21:51.985129 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:21:51.985366 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m02:21:51.985958 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:21:51.986594 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:21:51.987156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:21:51.999775 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:21:52.000841 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:21:52.001963 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

flattened_columns as (

    select
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
),

generate_surrogate_key as (

    select
        *,
        
    
md5(cast(coalesce(cast(worldbank_api_indicator_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_indicator_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_countryiso3code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_obs_status as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_decimal as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as generated_id
    from flattened_columns

)

select *
from generate_surrogate_key
  );
  
[0m02:21:52.002815 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:21:52.003817 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:21:52.004449 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        worldbank_api_value as gdp_value,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_value
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        gdp_value,
        previous_year_gdb,
        previous_year_gdb_value,
         1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1 AS gdp_growth,
        MIN(gdp_value) as min_gdp_growth_since_2000,
        MAX(gdp_value) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
  
[0m02:21:52.126015 [debug] [Thread-1 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:21:52.133701 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:21:52.134622 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics" rename to "worldbank_api_metrics__dbt_backup"
[0m02:21:52.136257 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:21:52.140147 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:21:52.140806 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" rename to "worldbank_api_metrics"
[0m02:21:52.142047 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:21:52.169071 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m02:21:52.169973 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:21:52.170599 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m02:21:52.177974 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:21:52.184727 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:21:52.185379 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_metrics__dbt_backup" cascade
[0m02:21:52.190268 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:21:52.192016 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:21:51.924708 => 2023-07-30 02:21:52.191958
[0m02:21:52.193090 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:21:52.194656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25f0b779-419b-41d9-99fd-736b13fd5e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd5ab2a110>]}
[0m02:21:52.195553 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.worldbank_api_metrics ................. [[32mSELECT 16758[0m in 0.31s]
[0m02:21:52.198439 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:21:52.329273 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:21:52.332633 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:21:52.333221 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m02:21:52.334539 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:21:52.337664 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:21:52.338569 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m02:21:52.340058 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:21:52.343235 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:21:52.343814 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:21:52.344378 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:21:52.348376 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m02:21:52.351083 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:21:52.351672 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m02:21:52.356316 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m02:21:52.357900 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 02:21:51.908364 => 2023-07-30 02:21:52.357843
[0m02:21:52.358436 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m02:21:52.359375 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25f0b779-419b-41d9-99fd-736b13fd5e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd5ab4afd0>]}
[0m02:21:52.360247 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.47s]
[0m02:21:52.361241 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:21:52.364644 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:21:52.365445 [debug] [MainThread]: Using postgres connection "master"
[0m02:21:52.366035 [debug] [MainThread]: On master: BEGIN
[0m02:21:52.366497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:21:52.375224 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:21:52.376080 [debug] [MainThread]: On master: COMMIT
[0m02:21:52.376813 [debug] [MainThread]: Using postgres connection "master"
[0m02:21:52.377345 [debug] [MainThread]: On master: COMMIT
[0m02:21:52.378111 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:21:52.378764 [debug] [MainThread]: On master: Close
[0m02:21:52.379709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:21:52.380266 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:21:52.380904 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:21:52.381497 [info ] [MainThread]: 
[0m02:21:52.382316 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m02:21:52.383465 [debug] [MainThread]: Command end result
[0m02:21:52.394901 [info ] [MainThread]: 
[0m02:21:52.396299 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:21:52.397603 [info ] [MainThread]: 
[0m02:21:52.398895 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:21:52.400144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd594b9650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd5d3ba5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd59373a50>]}
[0m02:21:52.400961 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:28:59.809069 | e84e7c24-54dd-458a-a6e2-d4b5a8d8a8f4 ==============================
[0m02:28:59.809069 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:28:59.811491 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:28:59.812302 [debug] [MainThread]: Tracking: tracking
[0m02:28:59.816077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f608566bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f608507e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6085161550>]}
[0m02:28:59.838644 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:28:59.962638 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:28:59.963590 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/schema.yml
[0m02:28:59.973538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60856a00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f608566a290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f608566b990>]}
[0m02:28:59.974469 [debug] [MainThread]: Flushing usage events
[0m02:29:01.380094 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/example/schema.yml @ models: {'name': 'worldbank_api_stg', 'description': 'A starter dbt model', 'columns': [{'name': 'generated_id', 'description': 'The primary key for this table generated by dbt utils', 'tests': ['unique', 'not_null']}, {'name': None, 'description': 'The country name', 'tests': ['not_null']}, {'name': None, 'description': 'The year', 'tests': ['not_null']}], 'original_file_path': 'models/example/schema.yml', 'yaml_key': 'models', 'package_name': 'my_dbt_project'} - at path ['columns'][1]['name']: None is not of type 'string'


============================== 2023-07-30 02:34:45.480883 | 67e07b12-4799-4e69-8b6a-0589b3409883 ==============================
[0m02:34:45.480883 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:34:45.484118 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:34:45.485324 [debug] [MainThread]: Tracking: tracking
[0m02:34:45.490162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9cb7e0f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9cbcecad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9cbbd9150>]}
[0m02:34:45.514312 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:34:45.626491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:34:45.627415 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/schema.yml
[0m02:34:45.676776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67e07b12-4799-4e69-8b6a-0589b3409883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9cbfcfed0>]}
[0m02:34:45.703543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67e07b12-4799-4e69-8b6a-0589b3409883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9ca051e10>]}
[0m02:34:45.704909 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:34:45.706760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67e07b12-4799-4e69-8b6a-0589b3409883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9cbd2d110>]}
[0m02:34:45.709881 [info ] [MainThread]: 
[0m02:34:45.714477 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:34:45.717163 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:34:45.732536 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:34:45.733290 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:34:45.733792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:34:45.747999 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:34:45.750080 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:34:45.753194 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:34:45.762894 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:34:45.765134 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:34:45.766545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:34:45.777258 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:34:45.778207 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:34:45.778852 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:34:45.785414 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:34:45.787305 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:34:45.788358 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:34:45.797278 [debug] [MainThread]: Using postgres connection "master"
[0m02:34:45.798272 [debug] [MainThread]: On master: BEGIN
[0m02:34:45.798950 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:34:45.807667 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:34:45.808536 [debug] [MainThread]: Using postgres connection "master"
[0m02:34:45.809109 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:34:45.829348 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:34:45.832313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67e07b12-4799-4e69-8b6a-0589b3409883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9cbbeb9d0>]}
[0m02:34:45.833747 [debug] [MainThread]: On master: ROLLBACK
[0m02:34:45.834886 [debug] [MainThread]: Using postgres connection "master"
[0m02:34:45.835625 [debug] [MainThread]: On master: BEGIN
[0m02:34:45.836700 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:34:45.837735 [debug] [MainThread]: On master: COMMIT
[0m02:34:45.838685 [debug] [MainThread]: Using postgres connection "master"
[0m02:34:45.839327 [debug] [MainThread]: On master: COMMIT
[0m02:34:45.840177 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:34:45.840793 [debug] [MainThread]: On master: Close
[0m02:34:45.841781 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:34:45.843082 [info ] [MainThread]: 
[0m02:34:45.861465 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:34:45.861979 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:34:45.863074 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:34:45.864362 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:34:45.866711 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:34:45.868592 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:34:45.869800 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:34:45.870417 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:34:45.874056 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:34:45.905511 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m02:34:45.907094 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:34:45.871013 => 2023-07-30 02:34:45.906978
[0m02:34:45.908443 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:34:45.909226 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:34:45.874826 => 2023-07-30 02:34:45.909072
[0m02:34:45.925973 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m02:34:45.968181 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:34:45.969989 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m02:34:45.976594 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:34:45.976955 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:34:45.977624 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m02:34:45.978491 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:34:45.979252 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:34:45.979901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:34:45.990099 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:34:45.990975 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:34:45.991641 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

flattened_columns as (

    select
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
),

generate_surrogate_key as (

    select
        *,
        
    
md5(cast(coalesce(cast(worldbank_api_indicator_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_indicator_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_countryiso3code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_obs_status as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_decimal as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as generated_id
    from flattened_columns

)

select *
from generate_surrogate_key
  );
  
[0m02:34:45.993215 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:34:45.994038 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:34:45.994785 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        worldbank_api_value as gdp_value,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_value
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        gdp_value,
        previous_year_gdb,
        previous_year_gdb_value,
         1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1 AS gdp_growth,
        MIN(gdp_value) as min_gdp_growth_since_2000,
        MAX(gdp_value) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
  
[0m02:34:46.100783 [debug] [Thread-1 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:34:46.108503 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:34:46.109543 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics" rename to "worldbank_api_metrics__dbt_backup"
[0m02:34:46.111282 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:34:46.114811 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:34:46.115623 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" rename to "worldbank_api_metrics"
[0m02:34:46.116980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:34:46.140411 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m02:34:46.141427 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:34:46.142319 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m02:34:46.148992 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:34:46.154997 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:34:46.155869 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_metrics__dbt_backup" cascade
[0m02:34:46.161069 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:34:46.163432 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:34:45.909429 => 2023-07-30 02:34:46.163361
[0m02:34:46.164267 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:34:46.165533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e07b12-4799-4e69-8b6a-0589b3409883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c9fbcf10>]}
[0m02:34:46.166618 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.worldbank_api_metrics ................. [[32mSELECT 16758[0m in 0.30s]
[0m02:34:46.169359 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:34:46.311222 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:34:46.314918 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:34:46.315770 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m02:34:46.317413 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:34:46.320647 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:34:46.321483 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m02:34:46.323246 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:34:46.325934 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:34:46.326688 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:34:46.327431 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:34:46.331561 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m02:34:46.334778 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:34:46.335506 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m02:34:46.340623 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m02:34:46.342464 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 02:34:45.937567 => 2023-07-30 02:34:46.342401
[0m02:34:46.343117 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m02:34:46.344457 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e07b12-4799-4e69-8b6a-0589b3409883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c9f4ee10>]}
[0m02:34:46.345475 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.48s]
[0m02:34:46.346732 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:34:46.350315 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:34:46.350820 [debug] [MainThread]: Using postgres connection "master"
[0m02:34:46.351238 [debug] [MainThread]: On master: BEGIN
[0m02:34:46.351594 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:34:46.360677 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:34:46.361790 [debug] [MainThread]: On master: COMMIT
[0m02:34:46.362478 [debug] [MainThread]: Using postgres connection "master"
[0m02:34:46.363072 [debug] [MainThread]: On master: COMMIT
[0m02:34:46.363929 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:34:46.364495 [debug] [MainThread]: On master: Close
[0m02:34:46.365534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:34:46.366032 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:34:46.366571 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:34:46.367125 [info ] [MainThread]: 
[0m02:34:46.368001 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m02:34:46.369253 [debug] [MainThread]: Command end result
[0m02:34:46.381216 [info ] [MainThread]: 
[0m02:34:46.383021 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:34:46.384531 [info ] [MainThread]: 
[0m02:34:46.385851 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:34:46.386905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9ca06d410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9ca083a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9cbcefbd0>]}
[0m02:34:46.387832 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:35:00.996959 | e185c127-4da9-4ccb-b33d-b9c5049e77b9 ==============================
[0m02:35:00.996959 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:35:01.000067 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m02:35:01.001427 [debug] [MainThread]: Tracking: tracking
[0m02:35:01.004663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f740bb29190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f740b5e6cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f740b56d190>]}
[0m02:35:01.026966 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:35:01.120730 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:35:01.121527 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:35:01.128870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e185c127-4da9-4ccb-b33d-b9c5049e77b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7409e81cd0>]}
[0m02:35:01.143019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e185c127-4da9-4ccb-b33d-b9c5049e77b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7409dc0750>]}
[0m02:35:01.143915 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:35:01.144992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e185c127-4da9-4ccb-b33d-b9c5049e77b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f740ba32450>]}
[0m02:35:01.146757 [info ] [MainThread]: 
[0m02:35:01.150464 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:35:01.153180 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:35:01.167616 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:35:01.168680 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:35:01.169653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:35:01.181637 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:35:01.182962 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:35:01.183726 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:35:01.191214 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:35:01.193225 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:35:01.194199 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:35:01.201503 [debug] [MainThread]: Using postgres connection "master"
[0m02:35:01.202407 [debug] [MainThread]: On master: BEGIN
[0m02:35:01.203068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:35:01.213692 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:35:01.215027 [debug] [MainThread]: Using postgres connection "master"
[0m02:35:01.215684 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:35:01.232096 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:35:01.234303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e185c127-4da9-4ccb-b33d-b9c5049e77b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f740d56c090>]}
[0m02:35:01.235189 [debug] [MainThread]: On master: ROLLBACK
[0m02:35:01.236163 [debug] [MainThread]: Using postgres connection "master"
[0m02:35:01.236817 [debug] [MainThread]: On master: BEGIN
[0m02:35:01.237829 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:35:01.238654 [debug] [MainThread]: On master: COMMIT
[0m02:35:01.239273 [debug] [MainThread]: Using postgres connection "master"
[0m02:35:01.239785 [debug] [MainThread]: On master: COMMIT
[0m02:35:01.240531 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:35:01.241060 [debug] [MainThread]: On master: Close
[0m02:35:01.242074 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:35:01.243040 [info ] [MainThread]: 
[0m02:35:01.262864 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a
[0m02:35:01.263234 [debug] [Thread-2 (]: Began running node test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5
[0m02:35:01.264092 [info ] [Thread-1 (]: 1 of 2 START test not_null_worldbank_api_stg_generated_id ...................... [RUN]
[0m02:35:01.265049 [info ] [Thread-2 (]: 2 of 2 START test unique_worldbank_api_stg_generated_id ........................ [RUN]
[0m02:35:01.266416 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a'
[0m02:35:01.267685 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5'
[0m02:35:01.268294 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a
[0m02:35:01.268975 [debug] [Thread-2 (]: Began compiling node test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5
[0m02:35:01.283271 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a"
[0m02:35:01.291979 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5"
[0m02:35:01.298047 [debug] [Thread-2 (]: Timing info for test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5 (compile): 2023-07-30 02:35:01.283581 => 2023-07-30 02:35:01.297711
[0m02:35:01.298595 [debug] [Thread-1 (]: Timing info for test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a (compile): 2023-07-30 02:35:01.269408 => 2023-07-30 02:35:01.298411
[0m02:35:01.299673 [debug] [Thread-2 (]: Began executing node test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5
[0m02:35:01.300547 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a
[0m02:35:01.319002 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5"
[0m02:35:01.321285 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a"
[0m02:35:01.325042 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a"
[0m02:35:01.325604 [debug] [Thread-2 (]: Using postgres connection "test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5"
[0m02:35:01.325857 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a: BEGIN
[0m02:35:01.326434 [debug] [Thread-2 (]: On test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5: BEGIN
[0m02:35:01.327115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:01.327745 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:35:01.339037 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:35:01.340354 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:35:01.341817 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a"
[0m02:35:01.343140 [debug] [Thread-2 (]: Using postgres connection "test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5"
[0m02:35:01.344477 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select generated_id
from "worldbank_api_db"."public"."worldbank_api_stg"
where generated_id is null



      
    ) dbt_internal_test
[0m02:35:01.345397 [debug] [Thread-2 (]: On test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    generated_id as unique_field,
    count(*) as n_records

from "worldbank_api_db"."public"."worldbank_api_stg"
where generated_id is not null
group by generated_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:35:01.351131 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m02:35:01.354481 [debug] [Thread-1 (]: Timing info for test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a (execute): 2023-07-30 02:35:01.319257 => 2023-07-30 02:35:01.354406
[0m02:35:01.355405 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a: ROLLBACK
[0m02:35:01.356505 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a: Close
[0m02:35:01.357707 [info ] [Thread-1 (]: 1 of 2 PASS not_null_worldbank_api_stg_generated_id ............................ [[32mPASS[0m in 0.09s]
[0m02:35:01.360519 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a
[0m02:35:01.361064 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0 seconds
[0m02:35:01.363134 [debug] [Thread-2 (]: Timing info for test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5 (execute): 2023-07-30 02:35:01.301235 => 2023-07-30 02:35:01.363065
[0m02:35:01.363609 [debug] [Thread-2 (]: On test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5: ROLLBACK
[0m02:35:01.364281 [debug] [Thread-2 (]: On test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5: Close
[0m02:35:01.365213 [info ] [Thread-2 (]: 2 of 2 PASS unique_worldbank_api_stg_generated_id .............................. [[32mPASS[0m in 0.10s]
[0m02:35:01.366186 [debug] [Thread-2 (]: Finished running node test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5
[0m02:35:01.369136 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:35:01.369599 [debug] [MainThread]: Using postgres connection "master"
[0m02:35:01.369985 [debug] [MainThread]: On master: BEGIN
[0m02:35:01.370312 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:35:01.379468 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:35:01.380340 [debug] [MainThread]: On master: COMMIT
[0m02:35:01.380949 [debug] [MainThread]: Using postgres connection "master"
[0m02:35:01.381422 [debug] [MainThread]: On master: COMMIT
[0m02:35:01.382173 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:35:01.382672 [debug] [MainThread]: On master: Close
[0m02:35:01.383547 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:35:01.384043 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a' was properly closed.
[0m02:35:01.384774 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5' was properly closed.
[0m02:35:01.385349 [info ] [MainThread]: 
[0m02:35:01.386113 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m02:35:01.387054 [debug] [MainThread]: Command end result
[0m02:35:01.398569 [info ] [MainThread]: 
[0m02:35:01.400446 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:35:01.401989 [info ] [MainThread]: 
[0m02:35:01.403107 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:35:01.404308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f740bcefed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f740ba880d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f740b5646d0>]}
[0m02:35:01.405234 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:36:37.662090 | c8992305-baef-42f7-843e-75afd7064b10 ==============================
[0m02:36:37.662090 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:36:37.664710 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m02:36:37.665708 [debug] [MainThread]: Tracking: tracking
[0m02:36:37.670751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4c8c2fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4c899b090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4c6cde8d0>]}
[0m02:36:37.693564 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:36:37.788263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:36:37.789313 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/schema.yml
[0m02:36:37.804089 [debug] [MainThread]: 1603: static parser failed on example/worldbank_api_stg.sql
[0m02:36:37.834859 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/worldbank_api_stg.sql
[0m02:36:37.876317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8992305-baef-42f7-843e-75afd7064b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4c6cf8e90>]}
[0m02:36:37.893805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8992305-baef-42f7-843e-75afd7064b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4c6ca9290>]}
[0m02:36:37.894610 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:36:37.895692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8992305-baef-42f7-843e-75afd7064b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4c8b65150>]}
[0m02:36:37.897594 [info ] [MainThread]: 
[0m02:36:37.900455 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:36:37.903040 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:36:37.915104 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:36:37.916148 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:36:37.917442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:36:37.928467 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:36:37.930027 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:36:37.931287 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:36:37.938644 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:36:37.941204 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:36:37.942385 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:36:37.949562 [debug] [MainThread]: Using postgres connection "master"
[0m02:36:37.950272 [debug] [MainThread]: On master: BEGIN
[0m02:36:37.950931 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:36:37.962823 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:36:37.963997 [debug] [MainThread]: Using postgres connection "master"
[0m02:36:37.964576 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:36:37.978926 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:36:37.981015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8992305-baef-42f7-843e-75afd7064b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4c6ca8910>]}
[0m02:36:37.982562 [debug] [MainThread]: On master: ROLLBACK
[0m02:36:37.983741 [debug] [MainThread]: Using postgres connection "master"
[0m02:36:37.984443 [debug] [MainThread]: On master: BEGIN
[0m02:36:37.985604 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:36:37.986337 [debug] [MainThread]: On master: COMMIT
[0m02:36:37.986821 [debug] [MainThread]: Using postgres connection "master"
[0m02:36:37.987207 [debug] [MainThread]: On master: COMMIT
[0m02:36:37.987848 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:36:37.988323 [debug] [MainThread]: On master: Close
[0m02:36:37.989230 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:36:37.989893 [info ] [MainThread]: 
[0m02:36:38.007913 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a
[0m02:36:38.008296 [debug] [Thread-2 (]: Began running node test.my_dbt_project.not_null_worldbank_api_stg_worldbank_api_date.0214aad441
[0m02:36:38.008643 [debug] [Thread-3 (]: Began running node test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5
[0m02:36:38.009554 [info ] [Thread-1 (]: 1 of 3 START test not_null_worldbank_api_stg_generated_id ...................... [RUN]
[0m02:36:38.010709 [info ] [Thread-2 (]: 2 of 3 START test not_null_worldbank_api_stg_worldbank_api_date ................ [RUN]
[0m02:36:38.012098 [info ] [Thread-3 (]: 3 of 3 START test unique_worldbank_api_stg_generated_id ........................ [RUN]
[0m02:36:38.013578 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a'
[0m02:36:38.015517 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.my_dbt_project.not_null_worldbank_api_stg_worldbank_api_date.0214aad441'
[0m02:36:38.016366 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5'
[0m02:36:38.017071 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a
[0m02:36:38.017773 [debug] [Thread-2 (]: Began compiling node test.my_dbt_project.not_null_worldbank_api_stg_worldbank_api_date.0214aad441
[0m02:36:38.018229 [debug] [Thread-3 (]: Began compiling node test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5
[0m02:36:38.032528 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a"
[0m02:36:38.037873 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt_project.not_null_worldbank_api_stg_worldbank_api_date.0214aad441"
[0m02:36:38.047329 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5"
[0m02:36:38.052961 [debug] [Thread-1 (]: Timing info for test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a (compile): 2023-07-30 02:36:38.018833 => 2023-07-30 02:36:38.052764
[0m02:36:38.053393 [debug] [Thread-2 (]: Timing info for test.my_dbt_project.not_null_worldbank_api_stg_worldbank_api_date.0214aad441 (compile): 2023-07-30 02:36:38.032853 => 2023-07-30 02:36:38.053315
[0m02:36:38.054427 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a
[0m02:36:38.054812 [debug] [Thread-3 (]: Timing info for test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5 (compile): 2023-07-30 02:36:38.038920 => 2023-07-30 02:36:38.054727
[0m02:36:38.073442 [debug] [Thread-3 (]: Began executing node test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5
[0m02:36:38.072689 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a"
[0m02:36:38.055824 [debug] [Thread-2 (]: Began executing node test.my_dbt_project.not_null_worldbank_api_stg_worldbank_api_date.0214aad441
[0m02:36:38.076403 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5"
[0m02:36:38.080159 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt_project.not_null_worldbank_api_stg_worldbank_api_date.0214aad441"
[0m02:36:38.082095 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a"
[0m02:36:38.082908 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a: BEGIN
[0m02:36:38.083165 [debug] [Thread-3 (]: Using postgres connection "test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5"
[0m02:36:38.083373 [debug] [Thread-2 (]: Using postgres connection "test.my_dbt_project.not_null_worldbank_api_stg_worldbank_api_date.0214aad441"
[0m02:36:38.083861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:38.084428 [debug] [Thread-3 (]: On test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5: BEGIN
[0m02:36:38.084927 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_worldbank_api_stg_worldbank_api_date.0214aad441: BEGIN
[0m02:36:38.086857 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:36:38.087588 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:36:38.095983 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:36:38.096879 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a"
[0m02:36:38.097355 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select generated_id
from "worldbank_api_db"."public"."worldbank_api_stg"
where generated_id is null



      
    ) dbt_internal_test
[0m02:36:38.100212 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m02:36:38.101166 [debug] [Thread-3 (]: Using postgres connection "test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5"
[0m02:36:38.101804 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m02:36:38.102053 [debug] [Thread-3 (]: On test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    generated_id as unique_field,
    count(*) as n_records

from "worldbank_api_db"."public"."worldbank_api_stg"
where generated_id is not null
group by generated_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:36:38.104349 [debug] [Thread-1 (]: Timing info for test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a (execute): 2023-07-30 02:36:38.056315 => 2023-07-30 02:36:38.104279
[0m02:36:38.105129 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:36:38.105989 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a: ROLLBACK
[0m02:36:38.106702 [debug] [Thread-2 (]: Using postgres connection "test.my_dbt_project.not_null_worldbank_api_stg_worldbank_api_date.0214aad441"
[0m02:36:38.107492 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a: Close
[0m02:36:38.107829 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_worldbank_api_stg_worldbank_api_date.0214aad441: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_worldbank_api_stg_worldbank_api_date.0214aad441"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select worldbank_api_date
from "worldbank_api_db"."public"."worldbank_api_stg"
where worldbank_api_date is null



      
    ) dbt_internal_test
[0m02:36:38.108977 [info ] [Thread-1 (]: 1 of 3 PASS not_null_worldbank_api_stg_generated_id ............................ [[32mPASS[0m in 0.10s]
[0m02:36:38.112325 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a
[0m02:36:38.113427 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0 seconds
[0m02:36:38.115186 [debug] [Thread-2 (]: Timing info for test.my_dbt_project.not_null_worldbank_api_stg_worldbank_api_date.0214aad441 (execute): 2023-07-30 02:36:38.077860 => 2023-07-30 02:36:38.115116
[0m02:36:38.115863 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_worldbank_api_stg_worldbank_api_date.0214aad441: ROLLBACK
[0m02:36:38.116696 [debug] [Thread-2 (]: On test.my_dbt_project.not_null_worldbank_api_stg_worldbank_api_date.0214aad441: Close
[0m02:36:38.117818 [info ] [Thread-2 (]: 2 of 3 PASS not_null_worldbank_api_stg_worldbank_api_date ...................... [[32mPASS[0m in 0.10s]
[0m02:36:38.118508 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0 seconds
[0m02:36:38.119227 [debug] [Thread-2 (]: Finished running node test.my_dbt_project.not_null_worldbank_api_stg_worldbank_api_date.0214aad441
[0m02:36:38.121057 [debug] [Thread-3 (]: Timing info for test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5 (execute): 2023-07-30 02:36:38.074165 => 2023-07-30 02:36:38.120993
[0m02:36:38.122345 [debug] [Thread-3 (]: On test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5: ROLLBACK
[0m02:36:38.123105 [debug] [Thread-3 (]: On test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5: Close
[0m02:36:38.124159 [info ] [Thread-3 (]: 3 of 3 PASS unique_worldbank_api_stg_generated_id .............................. [[32mPASS[0m in 0.11s]
[0m02:36:38.125341 [debug] [Thread-3 (]: Finished running node test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5
[0m02:36:38.128419 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:36:38.129032 [debug] [MainThread]: Using postgres connection "master"
[0m02:36:38.129485 [debug] [MainThread]: On master: BEGIN
[0m02:36:38.129988 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:36:38.139573 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:36:38.140548 [debug] [MainThread]: On master: COMMIT
[0m02:36:38.141134 [debug] [MainThread]: Using postgres connection "master"
[0m02:36:38.141706 [debug] [MainThread]: On master: COMMIT
[0m02:36:38.142459 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:36:38.143013 [debug] [MainThread]: On master: Close
[0m02:36:38.143954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:36:38.144751 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_worldbank_api_stg_generated_id.28c68af88a' was properly closed.
[0m02:36:38.145374 [debug] [MainThread]: Connection 'test.my_dbt_project.not_null_worldbank_api_stg_worldbank_api_date.0214aad441' was properly closed.
[0m02:36:38.145879 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_worldbank_api_stg_generated_id.a1d3ac47a5' was properly closed.
[0m02:36:38.146422 [info ] [MainThread]: 
[0m02:36:38.147301 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m02:36:38.148352 [debug] [MainThread]: Command end result
[0m02:36:38.161875 [info ] [MainThread]: 
[0m02:36:38.162856 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:36:38.163607 [info ] [MainThread]: 
[0m02:36:38.164629 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m02:36:38.166012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4c8b8fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4c8780110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4c8998910>]}
[0m02:36:38.166849 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:36:56.173318 | 34f07605-0096-4063-a9a8-9e605cc188d9 ==============================
[0m02:36:56.173318 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:36:56.176015 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:36:56.177313 [debug] [MainThread]: Tracking: tracking
[0m02:36:56.180513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd87ba4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd8775b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd8803eb10>]}
[0m02:36:56.203130 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:36:56.295243 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:36:56.296152 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/schema.yml
[0m02:36:56.314940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34f07605-0096-4063-a9a8-9e605cc188d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd87ed9b10>]}
[0m02:36:56.333555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34f07605-0096-4063-a9a8-9e605cc188d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd85f94f50>]}
[0m02:36:56.334813 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:36:56.337261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34f07605-0096-4063-a9a8-9e605cc188d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd85e7aa10>]}
[0m02:36:56.340927 [info ] [MainThread]: 
[0m02:36:56.345090 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:36:56.347975 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:36:56.361737 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:36:56.362645 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:36:56.363371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:36:56.378564 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:36:56.380649 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:36:56.383408 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:36:56.391078 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:36:56.391940 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:36:56.392853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:56.404244 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:36:56.405205 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:36:56.405924 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:36:56.412694 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:36:56.414642 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:36:56.415701 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:36:56.424372 [debug] [MainThread]: Using postgres connection "master"
[0m02:36:56.427249 [debug] [MainThread]: On master: BEGIN
[0m02:36:56.430410 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:36:56.440244 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:36:56.441457 [debug] [MainThread]: Using postgres connection "master"
[0m02:36:56.442590 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:36:56.466304 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:36:56.468359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34f07605-0096-4063-a9a8-9e605cc188d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd85f95590>]}
[0m02:36:56.469202 [debug] [MainThread]: On master: ROLLBACK
[0m02:36:56.470016 [debug] [MainThread]: Using postgres connection "master"
[0m02:36:56.470531 [debug] [MainThread]: On master: BEGIN
[0m02:36:56.471541 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:36:56.472386 [debug] [MainThread]: On master: COMMIT
[0m02:36:56.473153 [debug] [MainThread]: Using postgres connection "master"
[0m02:36:56.473697 [debug] [MainThread]: On master: COMMIT
[0m02:36:56.474499 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:36:56.475030 [debug] [MainThread]: On master: Close
[0m02:36:56.475913 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:36:56.477145 [info ] [MainThread]: 
[0m02:36:56.496489 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:36:56.496987 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:36:56.498058 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:36:56.499693 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:36:56.501955 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:36:56.503409 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:36:56.504173 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:36:56.504900 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:36:56.508008 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:36:56.530889 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m02:36:56.533221 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:36:56.505482 => 2023-07-30 02:36:56.533123
[0m02:36:56.533826 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:36:56.508619 => 2023-07-30 02:36:56.533767
[0m02:36:56.534111 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:36:56.535002 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m02:36:56.604420 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:36:56.604882 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m02:36:56.608528 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:36:56.608817 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:36:56.609445 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:36:56.609938 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m02:36:56.610558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:56.611031 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:36:56.620942 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:36:56.622226 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:36:56.622584 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:36:56.623538 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        worldbank_api_value as gdp_value,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_value
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        gdp_value,
        previous_year_gdb,
        previous_year_gdb_value,
         1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1 AS gdp_growth,
        MIN(gdp_value) as min_gdp_growth_since_2000,
        MAX(gdp_value) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
  
[0m02:36:56.624553 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:36:56.626358 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

flattened_columns as (

    select
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
),

generate_surrogate_key as (

    select
        *,
        
    
md5(cast(coalesce(cast(worldbank_api_indicator_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_indicator_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_countryiso3code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_obs_status as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_decimal as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as generated_id
    from flattened_columns

)

select *
from generate_surrogate_key
  );
  
[0m02:36:56.723252 [debug] [Thread-1 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:36:56.730386 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:36:56.731036 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics" rename to "worldbank_api_metrics__dbt_backup"
[0m02:36:56.732340 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:36:56.735433 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:36:56.735956 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" rename to "worldbank_api_metrics"
[0m02:36:56.736963 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:36:56.760848 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m02:36:56.761684 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:36:56.762487 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m02:36:56.769582 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:36:56.775733 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:36:56.776568 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_metrics__dbt_backup" cascade
[0m02:36:56.781904 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:36:56.784322 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:36:56.535589 => 2023-07-30 02:36:56.784259
[0m02:36:56.785161 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:36:56.786465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f07605-0096-4063-a9a8-9e605cc188d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd87a33e50>]}
[0m02:36:56.787382 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.worldbank_api_metrics ................. [[32mSELECT 16758[0m in 0.28s]
[0m02:36:56.790114 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:36:56.964752 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:36:56.970451 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:36:56.971641 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m02:36:56.974359 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:36:56.978314 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:36:56.979156 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m02:36:56.982004 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:36:56.985423 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:36:56.986205 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:36:56.987092 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:36:56.992241 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m02:36:56.999302 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:36:57.000872 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m02:36:57.011503 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m02:36:57.083651 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 02:36:56.552204 => 2023-07-30 02:36:57.083501
[0m02:36:57.089472 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m02:36:57.092544 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f07605-0096-4063-a9a8-9e605cc188d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd87ed9990>]}
[0m02:36:57.095317 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.59s]
[0m02:36:57.099066 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:36:57.149547 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:36:57.150803 [debug] [MainThread]: Using postgres connection "master"
[0m02:36:57.151960 [debug] [MainThread]: On master: BEGIN
[0m02:36:57.153343 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:36:57.174257 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:36:57.175855 [debug] [MainThread]: On master: COMMIT
[0m02:36:57.177408 [debug] [MainThread]: Using postgres connection "master"
[0m02:36:57.178881 [debug] [MainThread]: On master: COMMIT
[0m02:36:57.181067 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:36:57.182516 [debug] [MainThread]: On master: Close
[0m02:36:57.184325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:36:57.185335 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:36:57.186230 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:36:57.187670 [info ] [MainThread]: 
[0m02:36:57.189462 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m02:36:57.192165 [debug] [MainThread]: Command end result
[0m02:36:57.223479 [info ] [MainThread]: 
[0m02:36:57.227073 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:36:57.230787 [info ] [MainThread]: 
[0m02:36:57.233088 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:36:57.235397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd85fcf810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd8768d290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd87eeffd0>]}
[0m02:36:57.236938 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:40:45.550245 | cb72c71d-6e89-4470-8b35-d810c8a388f4 ==============================
[0m02:40:45.550245 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:40:45.553153 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:40:45.554431 [debug] [MainThread]: Tracking: tracking
[0m02:40:45.558189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158ec34b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158ecf2b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158ec6c250>]}
[0m02:40:45.580785 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:40:45.683674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:40:45.684761 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m02:40:45.700309 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m02:40:45.727381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb72c71d-6e89-4470-8b35-d810c8a388f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158ea120d0>]}
[0m02:40:45.745319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb72c71d-6e89-4470-8b35-d810c8a388f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158cb9dbd0>]}
[0m02:40:45.746120 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:40:45.747453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb72c71d-6e89-4470-8b35-d810c8a388f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158ec34950>]}
[0m02:40:45.749425 [info ] [MainThread]: 
[0m02:40:45.752851 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:40:45.754789 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:40:45.766523 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:40:45.767604 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:40:45.768332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:40:45.782817 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:40:45.785078 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:40:45.787901 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:40:45.794742 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:40:45.795401 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:40:45.796045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:40:45.807743 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:40:45.809408 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:40:45.810473 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:40:45.817550 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:40:45.819338 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:40:45.820493 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:40:45.828693 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:45.829484 [debug] [MainThread]: On master: BEGIN
[0m02:40:45.830051 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:40:45.839001 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:40:45.839646 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:45.840094 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:40:45.858330 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:40:45.861327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb72c71d-6e89-4470-8b35-d810c8a388f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158cd7a890>]}
[0m02:40:45.863257 [debug] [MainThread]: On master: ROLLBACK
[0m02:40:45.865112 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:45.866013 [debug] [MainThread]: On master: BEGIN
[0m02:40:45.867361 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:40:45.868212 [debug] [MainThread]: On master: COMMIT
[0m02:40:45.868800 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:45.869248 [debug] [MainThread]: On master: COMMIT
[0m02:40:45.870022 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:40:45.870569 [debug] [MainThread]: On master: Close
[0m02:40:45.871504 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:40:45.872240 [info ] [MainThread]: 
[0m02:40:45.892670 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:40:45.893028 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:40:45.893720 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:40:45.894884 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:40:45.896203 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:40:45.897520 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:40:45.898216 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:40:45.898785 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:40:45.902039 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:40:45.934767 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m02:40:45.936019 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:40:45.899454 => 2023-07-30 02:40:45.935932
[0m02:40:45.936874 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:40:45.937266 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:40:45.902673 => 2023-07-30 02:40:45.937205
[0m02:40:45.953837 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m02:40:45.991809 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:40:45.994955 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m02:40:45.999265 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:40:45.999800 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:40:46.000050 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:40:46.000793 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m02:40:46.001372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:40:46.001939 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:40:46.012000 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:40:46.012787 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:40:46.013188 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

flattened_columns as (

    select
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
),

generate_surrogate_key as (

    select
        *,
        
    
md5(cast(coalesce(cast(worldbank_api_indicator_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_indicator_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_countryiso3code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_obs_status as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_decimal as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as generated_id
    from flattened_columns

)

select *
from generate_surrogate_key
  );
  
[0m02:40:46.019206 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:40:46.020381 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:40:46.021311 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        worldbank_api_value as gdp_value,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_value
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        gdp_value,
        previous_year_gdb,
        previous_year_gdb_value,
        ROUND(1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0),3) - 1 AS gdp_growth,
        ROUND(MIN(1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1),3) as min_gdp_growth_since_2000,
        ROUND(MAX(1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1),3) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
  
[0m02:40:46.030558 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 37:         ROUND(1.0 * gdp_value / NULLIF(previous_year_gdb_val...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m02:40:46.031410 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: ROLLBACK
[0m02:40:46.032522 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:40:45.937562 => 2023-07-30 02:40:46.032394
[0m02:40:46.033125 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:40:46.037873 [debug] [Thread-1 (]: Database Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)
  function round(double precision, integer) does not exist
  LINE 37:         ROUND(1.0 * gdp_value / NULLIF(previous_year_gdb_val...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:40:46.038781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb72c71d-6e89-4470-8b35-d810c8a388f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158ccc3010>]}
[0m02:40:46.039769 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model public.worldbank_api_metrics ............. [[31mERROR[0m in 0.14s]
[0m02:40:46.042367 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:40:46.317164 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:40:46.324277 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:40:46.324904 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m02:40:46.326313 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:40:46.331815 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:40:46.332832 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m02:40:46.334246 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:40:46.357966 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:40:46.358881 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:40:46.359611 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:40:46.363044 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m02:40:46.369330 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:40:46.370169 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m02:40:46.375390 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m02:40:46.377549 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 02:40:45.970937 => 2023-07-30 02:40:46.377478
[0m02:40:46.378601 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m02:40:46.379933 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb72c71d-6e89-4470-8b35-d810c8a388f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158cd319d0>]}
[0m02:40:46.380827 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.48s]
[0m02:40:46.382022 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:40:46.385271 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:40:46.386005 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:46.386557 [debug] [MainThread]: On master: BEGIN
[0m02:40:46.387049 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:40:46.395770 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:40:46.396653 [debug] [MainThread]: On master: COMMIT
[0m02:40:46.397204 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:46.397737 [debug] [MainThread]: On master: COMMIT
[0m02:40:46.398422 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:40:46.398970 [debug] [MainThread]: On master: Close
[0m02:40:46.399873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:40:46.400322 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:40:46.400881 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:40:46.401403 [info ] [MainThread]: 
[0m02:40:46.402205 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m02:40:46.403245 [debug] [MainThread]: Command end result
[0m02:40:46.415361 [info ] [MainThread]: 
[0m02:40:46.416572 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:40:46.417896 [info ] [MainThread]: 
[0m02:40:46.419251 [error] [MainThread]: [33mDatabase Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)[0m
[0m02:40:46.420312 [error] [MainThread]:   function round(double precision, integer) does not exist
[0m02:40:46.421548 [error] [MainThread]:   LINE 37:         ROUND(1.0 * gdp_value / NULLIF(previous_year_gdb_val...
[0m02:40:46.422782 [error] [MainThread]:                    ^
[0m02:40:46.424353 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m02:40:46.425619 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:40:46.426908 [info ] [MainThread]: 
[0m02:40:46.428170 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m02:40:46.429685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158cba96d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158e978e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158ccc3650>]}
[0m02:40:46.430832 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:41:55.375257 | 1419fc2d-99ea-4de5-9172-3b9f4503063f ==============================
[0m02:41:55.375257 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:41:55.377839 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:41:55.378913 [debug] [MainThread]: Tracking: tracking
[0m02:41:55.382656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f51081e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f52d21ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5080e810>]}
[0m02:41:55.404524 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:41:55.499347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:41:55.500293 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m02:41:55.517433 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m02:41:55.547058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1419fc2d-99ea-4de5-9172-3b9f4503063f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f4f0a7f50>]}
[0m02:41:55.563958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1419fc2d-99ea-4de5-9172-3b9f4503063f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f4f03fe90>]}
[0m02:41:55.565576 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:41:55.566910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1419fc2d-99ea-4de5-9172-3b9f4503063f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f50cebdd0>]}
[0m02:41:55.571082 [info ] [MainThread]: 
[0m02:41:55.575841 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:41:55.578519 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:41:55.594656 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:41:55.595661 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:41:55.596444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:41:55.612395 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:41:55.614376 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:41:55.616865 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:41:55.623539 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:41:55.624243 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:41:55.625029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:41:55.635307 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:41:55.636381 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:41:55.636990 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:41:55.644839 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:41:55.647187 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:41:55.648475 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:41:55.656583 [debug] [MainThread]: Using postgres connection "master"
[0m02:41:55.657338 [debug] [MainThread]: On master: BEGIN
[0m02:41:55.657955 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:41:55.667167 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:41:55.668050 [debug] [MainThread]: Using postgres connection "master"
[0m02:41:55.668653 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:41:55.685413 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:41:55.687622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1419fc2d-99ea-4de5-9172-3b9f4503063f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f4f19f790>]}
[0m02:41:55.688669 [debug] [MainThread]: On master: ROLLBACK
[0m02:41:55.689979 [debug] [MainThread]: Using postgres connection "master"
[0m02:41:55.690774 [debug] [MainThread]: On master: BEGIN
[0m02:41:55.692012 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:41:55.693078 [debug] [MainThread]: On master: COMMIT
[0m02:41:55.693999 [debug] [MainThread]: Using postgres connection "master"
[0m02:41:55.694777 [debug] [MainThread]: On master: COMMIT
[0m02:41:55.695718 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:41:55.696352 [debug] [MainThread]: On master: Close
[0m02:41:55.697445 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:41:55.698781 [info ] [MainThread]: 
[0m02:41:55.717759 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:41:55.718101 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:41:55.719146 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:41:55.720462 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:41:55.721771 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:41:55.723330 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:41:55.724016 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:41:55.724819 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:41:55.728000 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:41:55.754184 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m02:41:55.755502 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:41:55.725321 => 2023-07-30 02:41:55.755419
[0m02:41:55.756090 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:41:55.767806 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:41:55.728806 => 2023-07-30 02:41:55.767679
[0m02:41:55.780978 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m02:41:55.824428 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:41:55.826133 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m02:41:55.829649 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:41:55.830332 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:41:55.830604 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:41:55.831438 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m02:41:55.832000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:41:55.832596 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:41:55.843317 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:41:55.844043 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:41:55.844516 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:41:55.845199 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        worldbank_api_value as gdp_value,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_value
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        gdp_value,
        previous_year_gdb,
        previous_year_gdb_value,
        ROUND(1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0),3) - 1 AS gdp_growth,
        MIN(1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1) as min_gdp_growth_since_2000,
        MAX(1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
  
[0m02:41:55.845923 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:41:55.847435 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

flattened_columns as (

    select
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
),

generate_surrogate_key as (

    select
        *,
        
    
md5(cast(coalesce(cast(worldbank_api_indicator_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_indicator_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_countryiso3code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_obs_status as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_decimal as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as generated_id
    from flattened_columns

)

select *
from generate_surrogate_key
  );
  
[0m02:41:55.851286 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 37:         ROUND(1.0 * gdp_value / NULLIF(previous_year_gdb_val...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m02:41:55.852285 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: ROLLBACK
[0m02:41:55.853332 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:41:55.756670 => 2023-07-30 02:41:55.853247
[0m02:41:55.854073 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:41:55.858933 [debug] [Thread-1 (]: Database Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)
  function round(double precision, integer) does not exist
  LINE 37:         ROUND(1.0 * gdp_value / NULLIF(previous_year_gdb_val...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:41:55.859820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1419fc2d-99ea-4de5-9172-3b9f4503063f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f4f1df550>]}
[0m02:41:55.860728 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model public.worldbank_api_metrics ............. [[31mERROR[0m in 0.14s]
[0m02:41:55.863430 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:41:56.168366 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:41:56.175819 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:41:56.176839 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m02:41:56.178863 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:41:56.182418 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:41:56.183334 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m02:41:56.185087 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:41:56.210273 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:41:56.211252 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:41:56.212188 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:41:56.215688 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m02:41:56.222368 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:41:56.223174 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m02:41:56.227979 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m02:41:56.229826 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 02:41:55.792728 => 2023-07-30 02:41:56.229767
[0m02:41:56.230470 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m02:41:56.231567 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1419fc2d-99ea-4de5-9172-3b9f4503063f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f4f0cf850>]}
[0m02:41:56.232331 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.51s]
[0m02:41:56.233369 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:41:56.236469 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:41:56.237309 [debug] [MainThread]: Using postgres connection "master"
[0m02:41:56.237973 [debug] [MainThread]: On master: BEGIN
[0m02:41:56.238627 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:41:56.248646 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:41:56.249599 [debug] [MainThread]: On master: COMMIT
[0m02:41:56.250362 [debug] [MainThread]: Using postgres connection "master"
[0m02:41:56.251091 [debug] [MainThread]: On master: COMMIT
[0m02:41:56.252155 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:41:56.252928 [debug] [MainThread]: On master: Close
[0m02:41:56.254227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:41:56.254965 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:41:56.255792 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:41:56.256585 [info ] [MainThread]: 
[0m02:41:56.257927 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m02:41:56.259477 [debug] [MainThread]: Command end result
[0m02:41:56.271334 [info ] [MainThread]: 
[0m02:41:56.272493 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:41:56.273731 [info ] [MainThread]: 
[0m02:41:56.274796 [error] [MainThread]: [33mDatabase Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)[0m
[0m02:41:56.275600 [error] [MainThread]:   function round(double precision, integer) does not exist
[0m02:41:56.276263 [error] [MainThread]:   LINE 37:         ROUND(1.0 * gdp_value / NULLIF(previous_year_gdb_val...
[0m02:41:56.277384 [error] [MainThread]:                    ^
[0m02:41:56.278077 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m02:41:56.279188 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:41:56.280075 [info ] [MainThread]: 
[0m02:41:56.281394 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m02:41:56.282856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f4f1c9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f4f13d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5087f890>]}
[0m02:41:56.283970 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:42:38.161416 | bb794be0-b86a-4a5f-a0b7-2375192a12e7 ==============================
[0m02:42:38.161416 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:42:38.164115 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:42:38.165124 [debug] [MainThread]: Tracking: tracking
[0m02:42:38.168793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3871d9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd38697ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd387208e10>]}
[0m02:42:38.192410 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:42:38.290004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:42:38.290908 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m02:42:38.306521 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m02:42:38.336298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb794be0-b86a-4a5f-a0b7-2375192a12e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd386e4d490>]}
[0m02:42:38.354138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb794be0-b86a-4a5f-a0b7-2375192a12e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3850b5250>]}
[0m02:42:38.355018 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:42:38.356006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb794be0-b86a-4a5f-a0b7-2375192a12e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3870e4d10>]}
[0m02:42:38.358096 [info ] [MainThread]: 
[0m02:42:38.361030 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:42:38.363354 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:42:38.374859 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:42:38.375967 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:42:38.376963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:38.392290 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:42:38.394624 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:42:38.397560 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:42:38.404644 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:42:38.405968 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:42:38.406807 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:38.417057 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:42:38.418221 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:42:38.419123 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:42:38.426119 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:42:38.428249 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:42:38.429274 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:42:38.436737 [debug] [MainThread]: Using postgres connection "master"
[0m02:42:38.437573 [debug] [MainThread]: On master: BEGIN
[0m02:42:38.438483 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:42:38.448296 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:42:38.449106 [debug] [MainThread]: Using postgres connection "master"
[0m02:42:38.449649 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:42:38.464479 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:42:38.466400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb794be0-b86a-4a5f-a0b7-2375192a12e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3852a02d0>]}
[0m02:42:38.467175 [debug] [MainThread]: On master: ROLLBACK
[0m02:42:38.468090 [debug] [MainThread]: Using postgres connection "master"
[0m02:42:38.468717 [debug] [MainThread]: On master: BEGIN
[0m02:42:38.469800 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:42:38.470560 [debug] [MainThread]: On master: COMMIT
[0m02:42:38.471215 [debug] [MainThread]: Using postgres connection "master"
[0m02:42:38.471692 [debug] [MainThread]: On master: COMMIT
[0m02:42:38.472372 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:42:38.472832 [debug] [MainThread]: On master: Close
[0m02:42:38.473719 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:42:38.474677 [info ] [MainThread]: 
[0m02:42:38.493431 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:42:38.493836 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:42:38.494892 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:42:38.495860 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:42:38.497428 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:42:38.498781 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:42:38.499535 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:42:38.500285 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:42:38.503472 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:42:38.529730 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m02:42:38.531400 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:42:38.500807 => 2023-07-30 02:42:38.531220
[0m02:42:38.532707 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:42:38.533474 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:42:38.504126 => 2023-07-30 02:42:38.533355
[0m02:42:38.550148 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m02:42:38.594841 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:42:38.596776 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m02:42:38.600703 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:42:38.601142 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:42:38.601617 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:42:38.602089 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m02:42:38.602664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:42:38.603092 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:42:38.613674 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:42:38.614426 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:42:38.615317 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:42:38.615844 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:42:38.616561 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        worldbank_api_value as gdp_value,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_value
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        gdp_value,
        previous_year_gdb,
        previous_year_gdb_value,
        ROUND(1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1,3) AS gdp_growth,
        MIN(1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1) as min_gdp_growth_since_2000,
        MAX(1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
  
[0m02:42:38.617088 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

flattened_columns as (

    select
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
),

generate_surrogate_key as (

    select
        *,
        
    
md5(cast(coalesce(cast(worldbank_api_indicator_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_indicator_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_countryiso3code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_obs_status as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_decimal as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as generated_id
    from flattened_columns

)

select *
from generate_surrogate_key
  );
  
[0m02:42:38.622638 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 37:         ROUND(1.0 * gdp_value / NULLIF(previous_year_gdb_val...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m02:42:38.623745 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: ROLLBACK
[0m02:42:38.625205 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:42:38.533806 => 2023-07-30 02:42:38.625116
[0m02:42:38.626830 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:42:38.631290 [debug] [Thread-1 (]: Database Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)
  function round(double precision, integer) does not exist
  LINE 37:         ROUND(1.0 * gdp_value / NULLIF(previous_year_gdb_val...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:42:38.632289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb794be0-b86a-4a5f-a0b7-2375192a12e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3851f0090>]}
[0m02:42:38.633258 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model public.worldbank_api_metrics ............. [[31mERROR[0m in 0.14s]
[0m02:42:38.635754 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:42:38.957701 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:42:38.964932 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:42:38.965953 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m02:42:38.967508 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:42:38.970906 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:42:38.971517 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m02:42:38.973025 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:42:38.995865 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:42:38.997024 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:42:38.997869 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:42:39.002051 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m02:42:39.008141 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:42:39.009066 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m02:42:39.015061 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m02:42:39.017184 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 02:42:38.567142 => 2023-07-30 02:42:39.017113
[0m02:42:39.018038 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m02:42:39.019336 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb794be0-b86a-4a5f-a0b7-2375192a12e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3851d3550>]}
[0m02:42:39.020376 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.52s]
[0m02:42:39.021757 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:42:39.025181 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:42:39.025764 [debug] [MainThread]: Using postgres connection "master"
[0m02:42:39.026412 [debug] [MainThread]: On master: BEGIN
[0m02:42:39.026853 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:42:39.038437 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:42:39.039319 [debug] [MainThread]: On master: COMMIT
[0m02:42:39.039908 [debug] [MainThread]: Using postgres connection "master"
[0m02:42:39.040434 [debug] [MainThread]: On master: COMMIT
[0m02:42:39.041266 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:42:39.041773 [debug] [MainThread]: On master: Close
[0m02:42:39.042661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:42:39.043142 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:42:39.043625 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:42:39.044178 [info ] [MainThread]: 
[0m02:42:39.045019 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m02:42:39.046923 [debug] [MainThread]: Command end result
[0m02:42:39.064498 [info ] [MainThread]: 
[0m02:42:39.065987 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:42:39.067113 [info ] [MainThread]: 
[0m02:42:39.068312 [error] [MainThread]: [33mDatabase Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)[0m
[0m02:42:39.069529 [error] [MainThread]:   function round(double precision, integer) does not exist
[0m02:42:39.071010 [error] [MainThread]:   LINE 37:         ROUND(1.0 * gdp_value / NULLIF(previous_year_gdb_val...
[0m02:42:39.072181 [error] [MainThread]:                    ^
[0m02:42:39.073216 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m02:42:39.074119 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:42:39.075283 [info ] [MainThread]: 
[0m02:42:39.076349 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m02:42:39.077488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3870e4d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd387179010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd385115850>]}
[0m02:42:39.078208 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:43:27.496772 | 9ca3f737-4c34-47f1-a725-fedbc29f721f ==============================
[0m02:43:27.496772 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:43:27.499347 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:43:27.500155 [debug] [MainThread]: Tracking: tracking
[0m02:43:27.503606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2824b29690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2824b547d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2824b6b1d0>]}
[0m02:43:27.525212 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:43:27.624350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:43:27.625313 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m02:43:27.642036 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m02:43:27.670179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ca3f737-4c34-47f1-a725-fedbc29f721f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2822c15d10>]}
[0m02:43:27.687755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ca3f737-4c34-47f1-a725-fedbc29f721f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2822cc4510>]}
[0m02:43:27.688658 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:43:27.689971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ca3f737-4c34-47f1-a725-fedbc29f721f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28243747d0>]}
[0m02:43:27.692141 [info ] [MainThread]: 
[0m02:43:27.695447 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:43:27.697597 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:43:27.710370 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:43:27.711263 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:43:27.712024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:43:27.736748 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:43:27.739355 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:43:27.742443 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:43:27.749636 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:43:27.750244 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:43:27.750844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:27.759697 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:43:27.760377 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:43:27.760858 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:43:27.767263 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:43:27.768874 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:43:27.769564 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:43:27.776748 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:27.777850 [debug] [MainThread]: On master: BEGIN
[0m02:43:27.778673 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:43:27.788464 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:43:27.789243 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:27.789822 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:43:27.806770 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:43:27.808749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ca3f737-4c34-47f1-a725-fedbc29f721f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2822c69e90>]}
[0m02:43:27.809670 [debug] [MainThread]: On master: ROLLBACK
[0m02:43:27.810630 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:27.811348 [debug] [MainThread]: On master: BEGIN
[0m02:43:27.812631 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:43:27.813516 [debug] [MainThread]: On master: COMMIT
[0m02:43:27.814149 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:27.814714 [debug] [MainThread]: On master: COMMIT
[0m02:43:27.815572 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:43:27.816170 [debug] [MainThread]: On master: Close
[0m02:43:27.817232 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:43:27.818148 [info ] [MainThread]: 
[0m02:43:27.838821 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:43:27.839293 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:43:27.840317 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:43:27.841328 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:43:27.842759 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:43:27.844061 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:43:27.844763 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:43:27.845309 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:43:27.848980 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:43:27.873574 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m02:43:27.875765 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:43:27.845995 => 2023-07-30 02:43:27.875531
[0m02:43:27.877401 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:43:27.877632 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:43:27.849655 => 2023-07-30 02:43:27.877570
[0m02:43:27.894831 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m02:43:27.937346 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:43:27.940891 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m02:43:27.944802 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:43:27.945136 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:43:27.945679 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:43:27.946310 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m02:43:27.946904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:27.947622 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:43:27.959139 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:43:27.960238 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:43:27.960625 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:43:27.961626 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:43:27.962668 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

flattened_columns as (

    select
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
),

generate_surrogate_key as (

    select
        *,
        
    
md5(cast(coalesce(cast(worldbank_api_indicator_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_indicator_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_countryiso3code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_obs_status as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_decimal as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as generated_id
    from flattened_columns

)

select *
from generate_surrogate_key
  );
  
[0m02:43:27.963629 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        worldbank_api_value as gdp_value,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_value
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        gdp_value,
        previous_year_gdb,
        previous_year_gdb_value,
        ROUND(10,666,1) as test
        1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1 AS gdp_growth,
        MIN(1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1) as min_gdp_growth_since_2000,
        MAX(1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6,7
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
  
[0m02:43:27.965852 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "1.0"
LINE 38:         1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0)...
                 ^

[0m02:43:27.966505 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: ROLLBACK
[0m02:43:27.967382 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:43:27.878217 => 2023-07-30 02:43:27.967298
[0m02:43:27.967924 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:43:27.972495 [debug] [Thread-1 (]: Database Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)
  syntax error at or near "1.0"
  LINE 38:         1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0)...
                   ^
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:43:27.973179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ca3f737-4c34-47f1-a725-fedbc29f721f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2822b8c810>]}
[0m02:43:27.973794 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model public.worldbank_api_metrics ............. [[31mERROR[0m in 0.13s]
[0m02:43:27.976496 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:43:28.287218 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:43:28.294707 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:43:28.295542 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m02:43:28.296993 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:43:28.300412 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:43:28.301188 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m02:43:28.302446 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:43:28.327094 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:43:28.327937 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:43:28.328726 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:43:28.334847 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m02:43:28.340674 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:43:28.341497 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m02:43:28.347059 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m02:43:28.348926 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 02:43:27.906143 => 2023-07-30 02:43:28.348864
[0m02:43:28.349674 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m02:43:28.350815 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ca3f737-4c34-47f1-a725-fedbc29f721f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2824979850>]}
[0m02:43:28.351740 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.51s]
[0m02:43:28.352689 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:43:28.355565 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:43:28.356119 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:28.356537 [debug] [MainThread]: On master: BEGIN
[0m02:43:28.357033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:43:28.366193 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:43:28.367209 [debug] [MainThread]: On master: COMMIT
[0m02:43:28.368373 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:28.369159 [debug] [MainThread]: On master: COMMIT
[0m02:43:28.370231 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:43:28.371051 [debug] [MainThread]: On master: Close
[0m02:43:28.372414 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:43:28.373158 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:43:28.374222 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:43:28.375277 [info ] [MainThread]: 
[0m02:43:28.376345 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m02:43:28.377837 [debug] [MainThread]: Command end result
[0m02:43:28.397310 [info ] [MainThread]: 
[0m02:43:28.398480 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:43:28.399722 [info ] [MainThread]: 
[0m02:43:28.401419 [error] [MainThread]: [33mDatabase Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)[0m
[0m02:43:28.402679 [error] [MainThread]:   syntax error at or near "1.0"
[0m02:43:28.403892 [error] [MainThread]:   LINE 38:         1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0)...
[0m02:43:28.405104 [error] [MainThread]:                    ^
[0m02:43:28.406150 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:43:28.407447 [info ] [MainThread]: 
[0m02:43:28.408564 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m02:43:28.409846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2822b8ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2822b8c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2824979850>]}
[0m02:43:28.410850 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:43:42.593164 | f664fd7f-659e-4517-81ad-3ce157522226 ==============================
[0m02:43:42.593164 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:43:42.595892 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:43:42.596996 [debug] [MainThread]: Tracking: tracking
[0m02:43:42.599721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16dacc9e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16daccb110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16dacc8390>]}
[0m02:43:42.622560 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:43:42.718668 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:43:42.719542 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m02:43:42.737515 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m02:43:42.766329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f664fd7f-659e-4517-81ad-3ce157522226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16dac49990>]}
[0m02:43:42.783832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f664fd7f-659e-4517-81ad-3ce157522226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16d9394f90>]}
[0m02:43:42.784755 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:43:42.786679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f664fd7f-659e-4517-81ad-3ce157522226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16daca9790>]}
[0m02:43:42.791021 [info ] [MainThread]: 
[0m02:43:42.796064 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:43:42.798640 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:43:42.814991 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:43:42.815899 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:43:42.816710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:43:42.831747 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:43:42.834689 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:43:42.838002 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:43:42.845563 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:43:42.846466 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:43:42.847199 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:42.856274 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:43:42.857101 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:43:42.857770 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:43:42.864746 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:43:42.867182 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:43:42.868307 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:43:42.876626 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:42.877426 [debug] [MainThread]: On master: BEGIN
[0m02:43:42.878332 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:43:42.888143 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:43:42.888809 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:42.889359 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:43:42.904143 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:43:42.906034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f664fd7f-659e-4517-81ad-3ce157522226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16d94daa90>]}
[0m02:43:42.906736 [debug] [MainThread]: On master: ROLLBACK
[0m02:43:42.907619 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:42.908435 [debug] [MainThread]: On master: BEGIN
[0m02:43:42.909663 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:43:42.910342 [debug] [MainThread]: On master: COMMIT
[0m02:43:42.910811 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:42.911219 [debug] [MainThread]: On master: COMMIT
[0m02:43:42.911879 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:43:42.912364 [debug] [MainThread]: On master: Close
[0m02:43:42.913293 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:43:42.914099 [info ] [MainThread]: 
[0m02:43:42.934484 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:43:42.934915 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:43:42.936255 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:43:42.937532 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:43:42.939232 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:43:42.940891 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:43:42.941818 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:43:42.942787 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:43:42.946161 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:43:42.974476 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m02:43:42.975889 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:43:42.943460 => 2023-07-30 02:43:42.975780
[0m02:43:42.976835 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:43:42.977317 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:43:42.947000 => 2023-07-30 02:43:42.977251
[0m02:43:42.988930 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m02:43:43.051864 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:43:43.054592 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m02:43:43.058539 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:43:43.059053 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:43:43.059300 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m02:43:43.059930 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:43:43.060398 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:43:43.061177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:43.071847 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:43:43.072172 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:43:43.072880 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:43:43.073655 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:43:43.074448 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

flattened_columns as (

    select
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
),

generate_surrogate_key as (

    select
        *,
        
    
md5(cast(coalesce(cast(worldbank_api_indicator_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_indicator_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_countryiso3code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_obs_status as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_decimal as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as generated_id
    from flattened_columns

)

select *
from generate_surrogate_key
  );
  
[0m02:43:43.075237 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        worldbank_api_value as gdp_value,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_value
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        gdp_value,
        previous_year_gdb,
        previous_year_gdb_value,
        ROUND(10,666,1) as test,
        1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1 AS gdp_growth,
        MIN(1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1) as min_gdp_growth_since_2000,
        MAX(1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6,7
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
  
[0m02:43:43.079055 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(integer, integer, integer) does not exist
LINE 37:         ROUND(10,666,1) as test,
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m02:43:43.080171 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: ROLLBACK
[0m02:43:43.081242 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:43:42.977532 => 2023-07-30 02:43:43.081159
[0m02:43:43.082020 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:43:43.086673 [debug] [Thread-1 (]: Database Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)
  function round(integer, integer, integer) does not exist
  LINE 37:         ROUND(10,666,1) as test,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:43:43.087613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f664fd7f-659e-4517-81ad-3ce157522226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16d9569610>]}
[0m02:43:43.088508 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model public.worldbank_api_metrics ............. [[31mERROR[0m in 0.15s]
[0m02:43:43.091157 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:43:43.393330 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:43:43.401212 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:43:43.402230 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m02:43:43.404090 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:43:43.407424 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:43:43.408182 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m02:43:43.409627 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:43:43.434367 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:43:43.435292 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:43:43.436111 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:43:43.438769 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m02:43:43.444780 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:43:43.445604 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m02:43:43.451049 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m02:43:43.453042 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 02:43:43.000229 => 2023-07-30 02:43:43.452937
[0m02:43:43.454026 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m02:43:43.455651 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f664fd7f-659e-4517-81ad-3ce157522226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16d9501bd0>]}
[0m02:43:43.456823 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.52s]
[0m02:43:43.458242 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:43:43.462368 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:43:43.463096 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:43.463684 [debug] [MainThread]: On master: BEGIN
[0m02:43:43.464235 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:43:43.474023 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:43:43.474755 [debug] [MainThread]: On master: COMMIT
[0m02:43:43.475430 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:43.475975 [debug] [MainThread]: On master: COMMIT
[0m02:43:43.476725 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:43:43.477333 [debug] [MainThread]: On master: Close
[0m02:43:43.478325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:43:43.478869 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:43:43.479466 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:43:43.480098 [info ] [MainThread]: 
[0m02:43:43.481022 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m02:43:43.482126 [debug] [MainThread]: Command end result
[0m02:43:43.494032 [info ] [MainThread]: 
[0m02:43:43.495434 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:43:43.496595 [info ] [MainThread]: 
[0m02:43:43.497774 [error] [MainThread]: [33mDatabase Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)[0m
[0m02:43:43.499033 [error] [MainThread]:   function round(integer, integer, integer) does not exist
[0m02:43:43.500267 [error] [MainThread]:   LINE 37:         ROUND(10,666,1) as test,
[0m02:43:43.501626 [error] [MainThread]:                    ^
[0m02:43:43.503709 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m02:43:43.505150 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:43:43.506721 [info ] [MainThread]: 
[0m02:43:43.507903 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m02:43:43.509630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16dacc29d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16d95114d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16dac49610>]}
[0m02:43:43.511002 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:44:03.727178 | 2533bc5f-55f6-46fe-8a23-9ab199e66b21 ==============================
[0m02:44:03.727178 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:44:03.730767 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:44:03.732289 [debug] [MainThread]: Tracking: tracking
[0m02:44:03.737838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43e7509d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43efa4150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43efa4cd0>]}
[0m02:44:03.764689 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:44:03.872183 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:44:03.873160 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m02:44:03.889810 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m02:44:03.925937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2533bc5f-55f6-46fe-8a23-9ab199e66b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43e75ca50>]}
[0m02:44:03.947028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2533bc5f-55f6-46fe-8a23-9ab199e66b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43d09ca10>]}
[0m02:44:03.948584 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:44:03.950135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2533bc5f-55f6-46fe-8a23-9ab199e66b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4401a3190>]}
[0m02:44:03.953705 [info ] [MainThread]: 
[0m02:44:03.958178 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:44:03.961004 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:44:03.976717 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:44:03.977718 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:44:03.978780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:44:03.993841 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:44:03.996193 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:44:03.999118 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:44:04.011581 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:44:04.012494 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:44:04.013354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:04.023588 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:44:04.024386 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:44:04.025125 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:44:04.031874 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:44:04.033977 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:44:04.034854 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:44:04.042194 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:04.042953 [debug] [MainThread]: On master: BEGIN
[0m02:44:04.043572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:44:04.053107 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:44:04.053965 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:04.055298 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:44:04.081284 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:44:04.083338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2533bc5f-55f6-46fe-8a23-9ab199e66b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43fa0a4d0>]}
[0m02:44:04.084330 [debug] [MainThread]: On master: ROLLBACK
[0m02:44:04.085302 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:04.085896 [debug] [MainThread]: On master: BEGIN
[0m02:44:04.086979 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:44:04.087812 [debug] [MainThread]: On master: COMMIT
[0m02:44:04.088416 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:04.088967 [debug] [MainThread]: On master: COMMIT
[0m02:44:04.089749 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:44:04.090278 [debug] [MainThread]: On master: Close
[0m02:44:04.091191 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:44:04.092095 [info ] [MainThread]: 
[0m02:44:04.110404 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:44:04.110785 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:44:04.111700 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:44:04.112516 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:44:04.113745 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:44:04.114990 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:44:04.115874 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:44:04.116425 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:44:04.119586 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:44:04.141600 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m02:44:04.144210 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:44:04.116982 => 2023-07-30 02:44:04.144102
[0m02:44:04.144666 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:44:04.120075 => 2023-07-30 02:44:04.144531
[0m02:44:04.145303 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:44:04.146078 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m02:44:04.209995 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m02:44:04.212210 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:44:04.216804 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:44:04.217408 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:44:04.217626 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m02:44:04.218420 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:44:04.218998 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:44:04.219593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:04.231559 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:44:04.232052 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:44:04.232771 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:44:04.233375 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:44:04.234135 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        worldbank_api_value as gdp_value,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_value
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        gdp_value,
        previous_year_gdb,
        previous_year_gdb_value,
        ROUND(10.666,1) as test,
        1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1 AS gdp_growth,
        MIN(1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1) as min_gdp_growth_since_2000,
        MAX(1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6,7
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
  
[0m02:44:04.234790 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

flattened_columns as (

    select
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
),

generate_surrogate_key as (

    select
        *,
        
    
md5(cast(coalesce(cast(worldbank_api_indicator_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_indicator_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_countryiso3code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_obs_status as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_decimal as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as generated_id
    from flattened_columns

)

select *
from generate_surrogate_key
  );
  
[0m02:44:04.353413 [debug] [Thread-1 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:44:04.361099 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:44:04.361937 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics" rename to "worldbank_api_metrics__dbt_backup"
[0m02:44:04.363921 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:44:04.369134 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:44:04.369990 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" rename to "worldbank_api_metrics"
[0m02:44:04.371814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:44:04.395921 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m02:44:04.396758 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:44:04.397498 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m02:44:04.405206 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:44:04.411119 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:44:04.412065 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_metrics__dbt_backup" cascade
[0m02:44:04.418140 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:44:04.419977 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:44:04.146710 => 2023-07-30 02:44:04.419916
[0m02:44:04.420627 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:44:04.421740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2533bc5f-55f6-46fe-8a23-9ab199e66b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43cffb9d0>]}
[0m02:44:04.422498 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.worldbank_api_metrics ................. [[32mSELECT 16758[0m in 0.31s]
[0m02:44:04.425464 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:44:04.553702 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:44:04.557447 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:44:04.558287 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m02:44:04.559810 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:44:04.563018 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:44:04.563825 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m02:44:04.565160 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:44:04.567594 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:44:04.568187 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:44:04.568819 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:44:04.572279 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m02:44:04.574943 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:44:04.575575 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m02:44:04.580117 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m02:44:04.581833 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 02:44:04.162938 => 2023-07-30 02:44:04.581775
[0m02:44:04.582500 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m02:44:04.583850 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2533bc5f-55f6-46fe-8a23-9ab199e66b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43cfa4650>]}
[0m02:44:04.584866 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.47s]
[0m02:44:04.586096 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:44:04.589662 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:44:04.590408 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:04.590996 [debug] [MainThread]: On master: BEGIN
[0m02:44:04.591647 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:44:04.602542 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:44:04.603352 [debug] [MainThread]: On master: COMMIT
[0m02:44:04.603843 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:04.604331 [debug] [MainThread]: On master: COMMIT
[0m02:44:04.604990 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:44:04.605657 [debug] [MainThread]: On master: Close
[0m02:44:04.606592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:44:04.607123 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:44:04.607660 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:44:04.608281 [info ] [MainThread]: 
[0m02:44:04.609323 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m02:44:04.610384 [debug] [MainThread]: Command end result
[0m02:44:04.622194 [info ] [MainThread]: 
[0m02:44:04.623199 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:44:04.624149 [info ] [MainThread]: 
[0m02:44:04.625205 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:44:04.626539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43ee118d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43c810890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43e80f090>]}
[0m02:44:04.627365 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:44:30.452405 | 7441c429-955e-4369-9513-fbafe1ab92d2 ==============================
[0m02:44:30.452405 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:44:30.455497 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:44:30.456872 [debug] [MainThread]: Tracking: tracking
[0m02:44:30.460195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7cd8cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7ce54dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7d16c090>]}
[0m02:44:30.483882 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:44:30.575177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:44:30.575838 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:44:30.583341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7441c429-955e-4369-9513-fbafe1ab92d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7b202fd0>]}
[0m02:44:30.597174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7441c429-955e-4369-9513-fbafe1ab92d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7b11bd50>]}
[0m02:44:30.598177 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:44:30.599130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7441c429-955e-4369-9513-fbafe1ab92d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7c8a3f90>]}
[0m02:44:30.601103 [info ] [MainThread]: 
[0m02:44:30.605057 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:44:30.607341 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:44:30.620335 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:44:30.621105 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:44:30.621866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:44:30.644866 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:44:30.647186 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:44:30.650255 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:44:30.658216 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:44:30.659263 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:44:30.659828 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:30.670395 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:44:30.671254 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:44:30.671839 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:44:30.678375 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:44:30.680522 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:44:30.681756 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:44:30.689168 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:30.690107 [debug] [MainThread]: On master: BEGIN
[0m02:44:30.690730 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:44:30.700436 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:44:30.701319 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:30.702019 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:44:30.716660 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:44:30.718530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7441c429-955e-4369-9513-fbafe1ab92d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7b180e50>]}
[0m02:44:30.719582 [debug] [MainThread]: On master: ROLLBACK
[0m02:44:30.721119 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:30.722062 [debug] [MainThread]: On master: BEGIN
[0m02:44:30.723689 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:44:30.724846 [debug] [MainThread]: On master: COMMIT
[0m02:44:30.725507 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:30.726164 [debug] [MainThread]: On master: COMMIT
[0m02:44:30.727209 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:44:30.728008 [debug] [MainThread]: On master: Close
[0m02:44:30.729214 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:44:30.730361 [info ] [MainThread]: 
[0m02:44:30.749243 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:44:30.749620 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:44:30.751714 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:44:30.750534 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:44:30.753084 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:44:30.754217 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:44:30.754987 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:44:30.755532 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:44:30.776217 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:44:30.786276 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m02:44:30.790240 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:44:30.773382 => 2023-07-30 02:44:30.790079
[0m02:44:30.790529 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:44:30.756168 => 2023-07-30 02:44:30.790468
[0m02:44:30.791207 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:44:30.791828 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m02:44:30.857150 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m02:44:30.858941 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:44:30.863450 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:44:30.863752 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:44:30.864275 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m02:44:30.864858 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:44:30.865440 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:44:30.866030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:30.876817 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:44:30.877268 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:44:30.878147 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:44:30.878726 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:44:30.879384 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

flattened_columns as (

    select
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
),

generate_surrogate_key as (

    select
        *,
        
    
md5(cast(coalesce(cast(worldbank_api_indicator_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_indicator_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_countryiso3code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_obs_status as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_decimal as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as generated_id
    from flattened_columns

)

select *
from generate_surrogate_key
  );
  
[0m02:44:30.880175 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        worldbank_api_value as gdp_value,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_value
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        gdp_value,
        previous_year_gdb,
        previous_year_gdb_value,
        ROUND(10.666,1) as test,
        1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1 AS gdp_growth,
        MIN(1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1) as min_gdp_growth_since_2000,
        MAX(1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6,7
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
  
[0m02:44:30.968813 [debug] [Thread-1 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:44:30.976421 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:44:30.977275 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics" rename to "worldbank_api_metrics__dbt_backup"
[0m02:44:30.978719 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:44:30.982012 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:44:30.982831 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" rename to "worldbank_api_metrics"
[0m02:44:30.984489 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:44:31.009202 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m02:44:31.010277 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:44:31.011175 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m02:44:31.017367 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:44:31.023237 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:44:31.023986 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_metrics__dbt_backup" cascade
[0m02:44:31.028756 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:44:31.030635 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:44:30.792568 => 2023-07-30 02:44:31.030567
[0m02:44:31.031218 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:44:31.032299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7441c429-955e-4369-9513-fbafe1ab92d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7b1c3b50>]}
[0m02:44:31.033215 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.worldbank_api_metrics ................. [[32mSELECT 16758[0m in 0.28s]
[0m02:44:31.035883 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:44:31.182052 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:44:31.186795 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:44:31.187594 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m02:44:31.189017 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:44:31.192292 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:44:31.193287 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m02:44:31.194628 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:44:31.197396 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:44:31.198176 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:44:31.198909 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:44:31.201611 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m02:44:31.205741 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:44:31.206534 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m02:44:31.211357 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m02:44:31.213193 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 02:44:30.809096 => 2023-07-30 02:44:31.213051
[0m02:44:31.213875 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m02:44:31.215161 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7441c429-955e-4369-9513-fbafe1ab92d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7af2c590>]}
[0m02:44:31.216102 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.46s]
[0m02:44:31.217593 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:44:31.221206 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:44:31.221824 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:31.222374 [debug] [MainThread]: On master: BEGIN
[0m02:44:31.222874 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:44:31.231591 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:44:31.232440 [debug] [MainThread]: On master: COMMIT
[0m02:44:31.232953 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:31.233470 [debug] [MainThread]: On master: COMMIT
[0m02:44:31.234143 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:44:31.234643 [debug] [MainThread]: On master: Close
[0m02:44:31.235531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:44:31.236015 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:44:31.236503 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:44:31.237095 [info ] [MainThread]: 
[0m02:44:31.238011 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m02:44:31.239333 [debug] [MainThread]: Command end result
[0m02:44:31.251635 [info ] [MainThread]: 
[0m02:44:31.253595 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:44:31.255012 [info ] [MainThread]: 
[0m02:44:31.256422 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:44:31.258321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7d043610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7b1a19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7b1a22d0>]}
[0m02:44:31.260386 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:45:14.735989 | eb4d09ae-f0b9-41eb-b434-e09668620631 ==============================
[0m02:45:14.735989 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:45:14.738404 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:45:14.739272 [debug] [MainThread]: Tracking: tracking
[0m02:45:14.741866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7de882eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7de882f450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7de87b4dd0>]}
[0m02:45:14.767224 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:45:14.922805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:45:14.923587 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:45:14.931400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb4d09ae-f0b9-41eb-b434-e09668620631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7de70eb610>]}
[0m02:45:14.946420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb4d09ae-f0b9-41eb-b434-e09668620631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7de7007b50>]}
[0m02:45:14.947399 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:45:14.948439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb4d09ae-f0b9-41eb-b434-e09668620631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7de878af90>]}
[0m02:45:14.950688 [info ] [MainThread]: 
[0m02:45:14.953854 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:45:14.955973 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:45:14.968972 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:45:14.969848 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:45:14.970647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:45:14.984751 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:45:14.987656 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:45:14.990433 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:45:15.001519 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:45:15.002873 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:45:15.004045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:45:15.017167 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:45:15.018393 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:45:15.019520 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:45:15.027084 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:45:15.029287 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:45:15.031727 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:45:15.042964 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:15.043770 [debug] [MainThread]: On master: BEGIN
[0m02:45:15.044888 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:45:15.057028 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:45:15.057911 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:15.058638 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:45:15.077390 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:45:15.079768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb4d09ae-f0b9-41eb-b434-e09668620631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7de6efcad0>]}
[0m02:45:15.080668 [debug] [MainThread]: On master: ROLLBACK
[0m02:45:15.081586 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:15.082090 [debug] [MainThread]: On master: BEGIN
[0m02:45:15.083090 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:45:15.083713 [debug] [MainThread]: On master: COMMIT
[0m02:45:15.084220 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:15.084628 [debug] [MainThread]: On master: COMMIT
[0m02:45:15.085302 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:45:15.085791 [debug] [MainThread]: On master: Close
[0m02:45:15.086706 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:45:15.087614 [info ] [MainThread]: 
[0m02:45:15.107227 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:45:15.107664 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:45:15.108705 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:45:15.109885 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:45:15.111405 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:45:15.113332 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:45:15.114323 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:45:15.115269 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:45:15.118817 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:45:15.142159 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m02:45:15.144623 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:45:15.116024 => 2023-07-30 02:45:15.144487
[0m02:45:15.145780 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:45:15.146661 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:45:15.119732 => 2023-07-30 02:45:15.146487
[0m02:45:15.163336 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m02:45:15.216854 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:45:15.219617 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m02:45:15.229199 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:45:15.230244 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m02:45:15.229542 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:45:15.231175 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:45:15.232415 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:45:15.234683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:15.249477 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:45:15.250723 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:45:15.251427 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

flattened_columns as (

    select
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
),

generate_surrogate_key as (

    select
        *,
        
    
md5(cast(coalesce(cast(worldbank_api_indicator_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_indicator_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_countryiso3code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_obs_status as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_decimal as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as generated_id
    from flattened_columns

)

select *
from generate_surrogate_key
  );
  
[0m02:45:15.252871 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:45:15.253669 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:45:15.254379 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        worldbank_api_value as gdp_value,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_value
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        gdp_value,
        previous_year_gdb,
        previous_year_gdb_value,
        ROUND(10.666,1) as test,
        1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1 AS gdp_growth,
        MIN(1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1) as min_gdp_growth_since_2000,
        MAX(1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6,7
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
  
[0m02:45:15.361170 [debug] [Thread-1 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:45:15.368991 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:45:15.369877 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics" rename to "worldbank_api_metrics__dbt_backup"
[0m02:45:15.371513 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:45:15.374916 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:45:15.375708 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" rename to "worldbank_api_metrics"
[0m02:45:15.377340 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:45:15.406146 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m02:45:15.407089 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:45:15.407979 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m02:45:15.415081 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:45:15.421507 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:45:15.422573 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_metrics__dbt_backup" cascade
[0m02:45:15.428141 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:45:15.430323 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:45:15.146943 => 2023-07-30 02:45:15.430259
[0m02:45:15.431114 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:45:15.432300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb4d09ae-f0b9-41eb-b434-e09668620631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7de70d1710>]}
[0m02:45:15.433247 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.worldbank_api_metrics ................. [[32mSELECT 16758[0m in 0.32s]
[0m02:45:15.435809 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:45:15.565598 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:45:15.569403 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:45:15.570597 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m02:45:15.572373 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:45:15.575770 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:45:15.576635 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m02:45:15.578087 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:45:15.581003 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:45:15.581824 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:45:15.582628 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:45:15.585376 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m02:45:15.589427 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:45:15.590409 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m02:45:15.595002 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m02:45:15.596714 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 02:45:15.174775 => 2023-07-30 02:45:15.596605
[0m02:45:15.597516 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m02:45:15.598748 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb4d09ae-f0b9-41eb-b434-e09668620631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7de6e17910>]}
[0m02:45:15.599537 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.49s]
[0m02:45:15.600615 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:45:15.603952 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:45:15.604643 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:15.605215 [debug] [MainThread]: On master: BEGIN
[0m02:45:15.605824 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:45:15.614968 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:45:15.615709 [debug] [MainThread]: On master: COMMIT
[0m02:45:15.616254 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:15.616827 [debug] [MainThread]: On master: COMMIT
[0m02:45:15.617632 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:45:15.618247 [debug] [MainThread]: On master: Close
[0m02:45:15.619194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:45:15.619860 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:45:15.620444 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:45:15.621192 [info ] [MainThread]: 
[0m02:45:15.622476 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m02:45:15.623800 [debug] [MainThread]: Command end result
[0m02:45:15.635731 [info ] [MainThread]: 
[0m02:45:15.637373 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:45:15.638643 [info ] [MainThread]: 
[0m02:45:15.639857 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:45:15.641082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7de6ffa6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7de6ffbb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7de6ffbe50>]}
[0m02:45:15.642003 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:46:53.435741 | c6e814f9-621a-4ef9-b488-7112157bdc0c ==============================
[0m02:46:53.435741 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:46:53.438856 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:46:53.440269 [debug] [MainThread]: Tracking: tracking
[0m02:46:53.443484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0cc374d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0cc373c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0cac1e750>]}
[0m02:46:53.465724 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:46:53.577225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:46:53.578162 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m02:46:53.594565 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m02:46:53.626152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6e814f9-621a-4ef9-b488-7112157bdc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0cc8a3110>]}
[0m02:46:53.643225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6e814f9-621a-4ef9-b488-7112157bdc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0cab338d0>]}
[0m02:46:53.644031 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:46:53.644985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6e814f9-621a-4ef9-b488-7112157bdc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0cc397f10>]}
[0m02:46:53.646947 [info ] [MainThread]: 
[0m02:46:53.650123 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:46:53.652572 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:46:53.664409 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:46:53.665509 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:46:53.666306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:46:53.680686 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:46:53.683485 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:46:53.686582 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:46:53.693802 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:46:53.694634 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:46:53.695348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:46:53.705578 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:46:53.707276 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:46:53.708276 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:46:53.715724 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:46:53.718062 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:46:53.719750 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:46:53.727460 [debug] [MainThread]: Using postgres connection "master"
[0m02:46:53.728527 [debug] [MainThread]: On master: BEGIN
[0m02:46:53.729340 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:46:53.738628 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:46:53.739386 [debug] [MainThread]: Using postgres connection "master"
[0m02:46:53.739792 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:46:53.754401 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:46:53.756250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6e814f9-621a-4ef9-b488-7112157bdc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0cc370610>]}
[0m02:46:53.757016 [debug] [MainThread]: On master: ROLLBACK
[0m02:46:53.757969 [debug] [MainThread]: Using postgres connection "master"
[0m02:46:53.758596 [debug] [MainThread]: On master: BEGIN
[0m02:46:53.760155 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:46:53.761295 [debug] [MainThread]: On master: COMMIT
[0m02:46:53.761841 [debug] [MainThread]: Using postgres connection "master"
[0m02:46:53.762430 [debug] [MainThread]: On master: COMMIT
[0m02:46:53.763335 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:46:53.763911 [debug] [MainThread]: On master: Close
[0m02:46:53.764885 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:46:53.765639 [info ] [MainThread]: 
[0m02:46:53.785273 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:46:53.785682 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:46:53.786608 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:46:53.787849 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:46:53.789707 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:46:53.791197 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:46:53.791984 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:46:53.792773 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:46:53.796036 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:46:53.823018 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m02:46:53.826500 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:46:53.793337 => 2023-07-30 02:46:53.826278
[0m02:46:53.828196 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:46:53.828575 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:46:53.796908 => 2023-07-30 02:46:53.828494
[0m02:46:53.846243 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m02:46:53.894381 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m02:46:53.897162 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:46:53.901734 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:46:53.902072 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:46:53.902812 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m02:46:53.903974 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:46:53.905476 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:46:53.906545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:46:53.918330 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:46:53.919301 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:46:53.919984 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

flattened_columns as (

    select
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
),

generate_surrogate_key as (

    select
        *,
        
    
md5(cast(coalesce(cast(worldbank_api_indicator_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_indicator_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_countryiso3code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_obs_status as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_decimal as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as generated_id
    from flattened_columns

)

select *
from generate_surrogate_key
  );
  
[0m02:46:53.921268 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:46:53.922284 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:46:53.922959 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_indicator_value as gdp,
        worldbank_api_value as gdp_value,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_value
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        gdp_value,
        previous_year_gdb,
        previous_year_gdb_value,
        ROUND((1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1),3) AS gdp_growth,
        ROUND(MIN(1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1),3) as min_gdp_growth_since_2000,
        ROUND(MAX(1.0 * gdp_value / NULLIF(previous_year_gdb_value, 0) - 1),3) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
  
[0m02:46:53.929061 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 37:         ROUND((1.0 * gdp_value / NULLIF(previous_year_gdb_va...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m02:46:53.930217 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: ROLLBACK
[0m02:46:53.931499 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:46:53.829404 => 2023-07-30 02:46:53.931406
[0m02:46:53.932308 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:46:53.936914 [debug] [Thread-1 (]: Database Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)
  function round(double precision, integer) does not exist
  LINE 37:         ROUND((1.0 * gdp_value / NULLIF(previous_year_gdb_va...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:46:53.937896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6e814f9-621a-4ef9-b488-7112157bdc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0cad13d50>]}
[0m02:46:53.938791 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model public.worldbank_api_metrics ............. [[31mERROR[0m in 0.15s]
[0m02:46:53.941424 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:46:54.245615 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:46:54.253199 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:46:54.254194 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m02:46:54.255908 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:46:54.259995 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:46:54.261079 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m02:46:54.262486 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:46:54.286358 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:46:54.287487 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:46:54.288141 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:46:54.293590 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m02:46:54.299583 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:46:54.300463 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m02:46:54.306004 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m02:46:54.308371 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 02:46:53.858157 => 2023-07-30 02:46:54.308289
[0m02:46:54.309226 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m02:46:54.310699 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6e814f9-621a-4ef9-b488-7112157bdc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0cabbc190>]}
[0m02:46:54.311674 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.52s]
[0m02:46:54.312862 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:46:54.316485 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:46:54.317007 [debug] [MainThread]: Using postgres connection "master"
[0m02:46:54.317450 [debug] [MainThread]: On master: BEGIN
[0m02:46:54.317797 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:46:54.326798 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:46:54.327769 [debug] [MainThread]: On master: COMMIT
[0m02:46:54.328386 [debug] [MainThread]: Using postgres connection "master"
[0m02:46:54.328889 [debug] [MainThread]: On master: COMMIT
[0m02:46:54.329737 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:46:54.330315 [debug] [MainThread]: On master: Close
[0m02:46:54.331300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:46:54.331924 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:46:54.332466 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:46:54.333036 [info ] [MainThread]: 
[0m02:46:54.333986 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m02:46:54.335345 [debug] [MainThread]: Command end result
[0m02:46:54.349179 [info ] [MainThread]: 
[0m02:46:54.350515 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:46:54.351798 [info ] [MainThread]: 
[0m02:46:54.352978 [error] [MainThread]: [33mDatabase Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)[0m
[0m02:46:54.354253 [error] [MainThread]:   function round(double precision, integer) does not exist
[0m02:46:54.355321 [error] [MainThread]:   LINE 37:         ROUND((1.0 * gdp_value / NULLIF(previous_year_gdb_va...
[0m02:46:54.356755 [error] [MainThread]:                    ^
[0m02:46:54.358651 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m02:46:54.360194 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:46:54.361669 [info ] [MainThread]: 
[0m02:46:54.362757 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m02:46:54.364157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0ccbc68d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0cc956890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0cac53910>]}
[0m02:46:54.365244 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:53:08.475662 | 330965cf-4537-4811-8bf3-9847085440b6 ==============================
[0m02:53:08.475662 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:53:08.478849 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:53:08.480163 [debug] [MainThread]: Tracking: tracking
[0m02:53:08.483173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77aeffcd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77af754c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77af4ace50>]}
[0m02:53:08.507597 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:53:08.609742 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:53:08.610719 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m02:53:08.627475 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m02:53:08.658290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '330965cf-4537-4811-8bf3-9847085440b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ad7f3a50>]}
[0m02:53:08.678799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '330965cf-4537-4811-8bf3-9847085440b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ad868a10>]}
[0m02:53:08.681080 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:53:08.683070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '330965cf-4537-4811-8bf3-9847085440b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77af6a8890>]}
[0m02:53:08.686505 [info ] [MainThread]: 
[0m02:53:08.690212 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:53:08.692707 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:53:08.705878 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:53:08.706788 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:53:08.707503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:53:08.722198 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:53:08.724518 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:53:08.727313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:53:08.734927 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:53:08.735699 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:53:08.736250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:53:08.746805 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:53:08.747717 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:53:08.748297 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:53:08.754913 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:53:08.757340 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:53:08.758677 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:53:08.766285 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:08.767154 [debug] [MainThread]: On master: BEGIN
[0m02:53:08.767865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:53:08.778218 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:53:08.779124 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:08.779680 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:53:08.794305 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:53:08.796794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '330965cf-4537-4811-8bf3-9847085440b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77af93ab90>]}
[0m02:53:08.797914 [debug] [MainThread]: On master: ROLLBACK
[0m02:53:08.799642 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:08.800744 [debug] [MainThread]: On master: BEGIN
[0m02:53:08.802234 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:53:08.803353 [debug] [MainThread]: On master: COMMIT
[0m02:53:08.805257 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:08.806201 [debug] [MainThread]: On master: COMMIT
[0m02:53:08.807382 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:53:08.808178 [debug] [MainThread]: On master: Close
[0m02:53:08.809390 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:53:08.810289 [info ] [MainThread]: 
[0m02:53:08.829769 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:53:08.830300 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:53:08.831324 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:53:08.833611 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:53:08.835748 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:53:08.837287 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:53:08.838456 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:53:08.839164 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:53:08.843024 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:53:08.868213 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m02:53:08.869804 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:53:08.840027 => 2023-07-30 02:53:08.869708
[0m02:53:08.870612 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:53:08.871102 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:53:08.843980 => 2023-07-30 02:53:08.871039
[0m02:53:08.887805 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m02:53:08.929622 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:53:08.930802 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m02:53:08.935480 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:53:08.935814 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:08.936413 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:53:08.937030 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m02:53:08.937614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:53:08.938202 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:53:08.949775 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:53:08.950483 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:53:08.950803 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:53:08.951661 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:08.952147 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_value as gdp,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_date,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year
        gdp,
        previous_year_gdb_date,
        previous_year_gdb,
        1.0 * gdp / nullif(previous_year_gdb, 0) - 1 as gdp_growth,
        min(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) as min_gdp_growth_since_2000,
        max(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6
),

final as (

    select 
        country,
        year,
        round(gdp,3) as gdb,
        round(min_gdp_growth_since_2000) as min_gdp_growth_since_2000,
        round(max_gdp_growth_since_2000) as max_gdp_growth_since_2000
    from calculated_gdb_metrics
)

select *
from final

where gdp is not null
  );
  
[0m02:53:08.952711 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

flattened_columns as (

    select
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
),

generate_surrogate_key as (

    select
        *,
        
    
md5(cast(coalesce(cast(worldbank_api_indicator_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_indicator_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_countryiso3code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_obs_status as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_decimal as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as generated_id
    from flattened_columns

)

select *
from generate_surrogate_key
  );
  
[0m02:53:08.958847 [debug] [Thread-1 (]: Postgres adapter: Postgres error: aggregate functions are not allowed in GROUP BY
LINE 36:         min(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) as...
                 ^

[0m02:53:08.959969 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: ROLLBACK
[0m02:53:08.961482 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:53:08.871350 => 2023-07-30 02:53:08.961381
[0m02:53:08.962340 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:53:08.967248 [debug] [Thread-1 (]: Database Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)
  aggregate functions are not allowed in GROUP BY
  LINE 36:         min(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) as...
                   ^
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:53:08.968223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '330965cf-4537-4811-8bf3-9847085440b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ad73d190>]}
[0m02:53:08.969301 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model public.worldbank_api_metrics ............. [[31mERROR[0m in 0.13s]
[0m02:53:08.972390 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:53:09.279163 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:53:09.286705 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:09.287677 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m02:53:09.289568 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:53:09.293006 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:09.293989 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m02:53:09.295270 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:53:09.318125 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:53:09.319224 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:09.320084 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:53:09.325310 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m02:53:09.331649 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:09.332498 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m02:53:09.337849 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m02:53:09.340125 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 02:53:08.899198 => 2023-07-30 02:53:09.340058
[0m02:53:09.340888 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m02:53:09.342306 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '330965cf-4537-4811-8bf3-9847085440b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ad87fcd0>]}
[0m02:53:09.343264 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.51s]
[0m02:53:09.344721 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:53:09.348598 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:53:09.349153 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:09.349512 [debug] [MainThread]: On master: BEGIN
[0m02:53:09.349838 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:53:09.361155 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:53:09.362626 [debug] [MainThread]: On master: COMMIT
[0m02:53:09.363440 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:09.364226 [debug] [MainThread]: On master: COMMIT
[0m02:53:09.365168 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:53:09.365829 [debug] [MainThread]: On master: Close
[0m02:53:09.366858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:53:09.367397 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:53:09.367896 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:53:09.368509 [info ] [MainThread]: 
[0m02:53:09.369566 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m02:53:09.370835 [debug] [MainThread]: Command end result
[0m02:53:09.384428 [info ] [MainThread]: 
[0m02:53:09.385700 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:53:09.386741 [info ] [MainThread]: 
[0m02:53:09.388019 [error] [MainThread]: [33mDatabase Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)[0m
[0m02:53:09.389064 [error] [MainThread]:   aggregate functions are not allowed in GROUP BY
[0m02:53:09.390404 [error] [MainThread]:   LINE 36:         min(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) as...
[0m02:53:09.391858 [error] [MainThread]:                    ^
[0m02:53:09.393342 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:53:09.394589 [info ] [MainThread]: 
[0m02:53:09.395770 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m02:53:09.396792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ad762e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ad763450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ad79f950>]}
[0m02:53:09.397824 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:53:27.162474 | 3e708705-ae56-4d3e-9f09-58f60d784458 ==============================
[0m02:53:27.162474 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:53:27.165193 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:53:27.166586 [debug] [MainThread]: Tracking: tracking
[0m02:53:27.170802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496e010cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496d91f450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496d87fdd0>]}
[0m02:53:27.191563 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:53:27.280057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:53:27.280937 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m02:53:27.296424 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m02:53:27.324708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e708705-ae56-4d3e-9f09-58f60d784458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496c1dbc50>]}
[0m02:53:27.343640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e708705-ae56-4d3e-9f09-58f60d784458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496c1b5990>]}
[0m02:53:27.344653 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:53:27.346006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e708705-ae56-4d3e-9f09-58f60d784458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496e126bd0>]}
[0m02:53:27.348836 [info ] [MainThread]: 
[0m02:53:27.352929 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:53:27.355880 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:53:27.369769 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:53:27.370795 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:53:27.371561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:53:27.387378 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:53:27.389365 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:53:27.392628 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:53:27.399773 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:53:27.400779 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:53:27.401659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:53:27.414644 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:53:27.415699 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:53:27.416278 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:53:27.425066 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:53:27.427179 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:53:27.428302 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:53:27.435739 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:27.436628 [debug] [MainThread]: On master: BEGIN
[0m02:53:27.437342 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:53:27.446599 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:53:27.447518 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:27.448163 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:53:27.467303 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:53:27.469756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e708705-ae56-4d3e-9f09-58f60d784458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496d89db10>]}
[0m02:53:27.470843 [debug] [MainThread]: On master: ROLLBACK
[0m02:53:27.472121 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:27.473186 [debug] [MainThread]: On master: BEGIN
[0m02:53:27.474882 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:53:27.475875 [debug] [MainThread]: On master: COMMIT
[0m02:53:27.476781 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:27.477386 [debug] [MainThread]: On master: COMMIT
[0m02:53:27.478347 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:53:27.479198 [debug] [MainThread]: On master: Close
[0m02:53:27.480824 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:53:27.482082 [info ] [MainThread]: 
[0m02:53:27.500377 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:53:27.500771 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:53:27.501658 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:53:27.502694 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:53:27.503818 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:53:27.505346 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:53:27.506204 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:53:27.506966 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:53:27.510409 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:53:27.538000 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m02:53:27.540796 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:53:27.507585 => 2023-07-30 02:53:27.540605
[0m02:53:27.541407 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:53:27.511266 => 2023-07-30 02:53:27.541333
[0m02:53:27.542414 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:53:27.543599 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m02:53:27.619321 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:53:27.619760 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m02:53:27.622786 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:27.623280 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:53:27.623574 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m02:53:27.624196 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:53:27.624863 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:53:27.625710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:53:27.639005 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:53:27.639448 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:53:27.640546 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:53:27.641608 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:27.642661 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_value as gdp,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_date,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year
        gdp,
        previous_year_gdb_date,
        previous_year_gdb,
        1.0 * gdp / nullif(previous_year_gdb, 0) - 1 as gdp_growth,
        min(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) as min_gdp_growth_since_2000,
        max(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5
),

final as (

    select 
        country,
        year,
        round(gdp,3) as gdb,
        round(min_gdp_growth_since_2000) as min_gdp_growth_since_2000,
        round(max_gdp_growth_since_2000) as max_gdp_growth_since_2000
    from calculated_gdb_metrics
)

select *
from final

where gdp is not null
  );
  
[0m02:53:27.643803 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

flattened_columns as (

    select
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
),

generate_surrogate_key as (

    select
        *,
        
    
md5(cast(coalesce(cast(worldbank_api_indicator_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_indicator_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_countryiso3code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_obs_status as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_decimal as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as generated_id
    from flattened_columns

)

select *
from generate_surrogate_key
  );
  
[0m02:53:27.650386 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "year" does not exist
LINE 46:         year,
                 ^

[0m02:53:27.651183 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: ROLLBACK
[0m02:53:27.652415 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:53:27.544422 => 2023-07-30 02:53:27.652325
[0m02:53:27.653410 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:53:27.659433 [debug] [Thread-1 (]: Database Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)
  column "year" does not exist
  LINE 46:         year,
                   ^
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:53:27.660714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e708705-ae56-4d3e-9f09-58f60d784458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496c1580d0>]}
[0m02:53:27.661906 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model public.worldbank_api_metrics ............. [[31mERROR[0m in 0.16s]
[0m02:53:27.664644 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:53:27.988721 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:53:27.996546 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:27.997382 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m02:53:27.999085 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:53:28.002507 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:28.003288 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m02:53:28.004543 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:53:28.028607 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:53:28.029526 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:28.030372 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:53:28.033777 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m02:53:28.039730 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:28.040543 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m02:53:28.045680 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m02:53:28.047678 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 02:53:27.568174 => 2023-07-30 02:53:28.047617
[0m02:53:28.048522 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m02:53:28.050083 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e708705-ae56-4d3e-9f09-58f60d784458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496c191950>]}
[0m02:53:28.051125 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.55s]
[0m02:53:28.052305 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:53:28.055925 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:53:28.056642 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:28.057238 [debug] [MainThread]: On master: BEGIN
[0m02:53:28.057871 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:53:28.066943 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:53:28.067863 [debug] [MainThread]: On master: COMMIT
[0m02:53:28.068470 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:28.069035 [debug] [MainThread]: On master: COMMIT
[0m02:53:28.069779 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:53:28.070332 [debug] [MainThread]: On master: Close
[0m02:53:28.071309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:53:28.071964 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:53:28.072557 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:53:28.073153 [info ] [MainThread]: 
[0m02:53:28.073911 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m02:53:28.074808 [debug] [MainThread]: Command end result
[0m02:53:28.087102 [info ] [MainThread]: 
[0m02:53:28.088094 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:53:28.089113 [info ] [MainThread]: 
[0m02:53:28.090422 [error] [MainThread]: [33mDatabase Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)[0m
[0m02:53:28.091408 [error] [MainThread]:   column "year" does not exist
[0m02:53:28.092636 [error] [MainThread]:   LINE 46:         year,
[0m02:53:28.093606 [error] [MainThread]:                    ^
[0m02:53:28.094689 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:53:28.096102 [info ] [MainThread]: 
[0m02:53:28.097358 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m02:53:28.098759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496d87edd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496e12e810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496dd13410>]}
[0m02:53:28.099928 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:53:42.301764 | 6f1c3668-3f24-4926-b15c-7f91f09f455b ==============================
[0m02:53:42.301764 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:53:42.304718 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:53:42.305620 [debug] [MainThread]: Tracking: tracking
[0m02:53:42.308586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6281f8dc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6281e15190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f628203f5d0>]}
[0m02:53:42.339432 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:53:42.453904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:53:42.454881 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m02:53:42.471767 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m02:53:42.502042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f1c3668-3f24-4926-b15c-7f91f09f455b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f628234b650>]}
[0m02:53:42.520302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f1c3668-3f24-4926-b15c-7f91f09f455b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6280215050>]}
[0m02:53:42.521194 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:53:42.522214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f1c3668-3f24-4926-b15c-7f91f09f455b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6281ac4250>]}
[0m02:53:42.524330 [info ] [MainThread]: 
[0m02:53:42.528662 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:53:42.530867 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:53:42.545531 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:53:42.546377 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:53:42.546952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:53:42.561311 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:53:42.563230 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:53:42.566106 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:53:42.576073 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:53:42.576949 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:53:42.577482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:53:42.586838 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:53:42.587695 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:53:42.588344 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:53:42.595827 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:53:42.598076 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:53:42.599379 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:53:42.607653 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:42.608921 [debug] [MainThread]: On master: BEGIN
[0m02:53:42.609631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:53:42.620142 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:53:42.621119 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:42.621873 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:53:42.640649 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:53:42.642792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f1c3668-3f24-4926-b15c-7f91f09f455b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f628035db90>]}
[0m02:53:42.643869 [debug] [MainThread]: On master: ROLLBACK
[0m02:53:42.645108 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:42.645824 [debug] [MainThread]: On master: BEGIN
[0m02:53:42.647355 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:53:42.648651 [debug] [MainThread]: On master: COMMIT
[0m02:53:42.649562 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:42.650199 [debug] [MainThread]: On master: COMMIT
[0m02:53:42.651075 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:53:42.651763 [debug] [MainThread]: On master: Close
[0m02:53:42.652944 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:53:42.653854 [info ] [MainThread]: 
[0m02:53:42.677157 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:53:42.677591 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:53:42.678414 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:53:42.680096 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:53:42.682139 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:53:42.684182 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:53:42.685257 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:53:42.686217 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:53:42.690209 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:53:42.715633 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m02:53:42.717591 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:53:42.686964 => 2023-07-30 02:53:42.717366
[0m02:53:42.718049 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:53:42.691186 => 2023-07-30 02:53:42.717981
[0m02:53:42.718484 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:53:42.719276 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m02:53:42.806289 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:53:42.806883 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m02:53:42.810926 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:53:42.811479 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:42.811927 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:53:42.813157 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m02:53:42.814168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:53:42.815096 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:53:42.827111 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:53:42.827962 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:53:42.829408 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_value as gdp,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_date,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        previous_year_gdb_date,
        previous_year_gdb,
        1.0 * gdp / nullif(previous_year_gdb, 0) - 1 as gdp_growth,
        min(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) as min_gdp_growth_since_2000,
        max(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5
),

final as (

    select 
        country,
        year,
        round(gdp,3) as gdb,
        round(min_gdp_growth_since_2000) as min_gdp_growth_since_2000,
        round(max_gdp_growth_since_2000) as max_gdp_growth_since_2000
    from calculated_gdb_metrics
)

select *
from final

where gdp is not null
  );
  
[0m02:53:42.831162 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:53:42.831852 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:42.832409 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

flattened_columns as (

    select
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
),

generate_surrogate_key as (

    select
        *,
        
    
md5(cast(coalesce(cast(worldbank_api_indicator_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_indicator_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_countryiso3code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_obs_status as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_decimal as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as generated_id
    from flattened_columns

)

select *
from generate_surrogate_key
  );
  
[0m02:53:42.839468 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 47:         round(gdp,3) as gdb,
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m02:53:42.840712 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: ROLLBACK
[0m02:53:42.842228 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:53:42.719957 => 2023-07-30 02:53:42.842136
[0m02:53:42.843235 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:53:42.848996 [debug] [Thread-1 (]: Database Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)
  function round(double precision, integer) does not exist
  LINE 47:         round(gdp,3) as gdb,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:53:42.850315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f1c3668-3f24-4926-b15c-7f91f09f455b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62803e9b10>]}
[0m02:53:42.851768 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model public.worldbank_api_metrics ............. [[31mERROR[0m in 0.17s]
[0m02:53:42.854432 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:53:43.166897 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:53:43.174421 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:43.175367 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m02:53:43.177681 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:53:43.184109 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:43.184985 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m02:53:43.186344 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:53:43.215037 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:53:43.216105 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:43.216809 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:53:43.220943 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m02:53:43.226946 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:43.227772 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m02:53:43.232453 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m02:53:43.234344 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 02:53:42.736328 => 2023-07-30 02:53:43.234279
[0m02:53:43.234969 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m02:53:43.236139 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f1c3668-3f24-4926-b15c-7f91f09f455b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62803a9b10>]}
[0m02:53:43.237074 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.55s]
[0m02:53:43.238605 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:53:43.241937 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:53:43.242592 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:43.243099 [debug] [MainThread]: On master: BEGIN
[0m02:53:43.243669 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:53:43.253137 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:53:43.254129 [debug] [MainThread]: On master: COMMIT
[0m02:53:43.254939 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:43.255624 [debug] [MainThread]: On master: COMMIT
[0m02:53:43.256514 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:53:43.257034 [debug] [MainThread]: On master: Close
[0m02:53:43.257957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:53:43.258427 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:53:43.258916 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:53:43.259409 [info ] [MainThread]: 
[0m02:53:43.260309 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m02:53:43.261620 [debug] [MainThread]: Command end result
[0m02:53:43.275835 [info ] [MainThread]: 
[0m02:53:43.277445 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:53:43.279045 [info ] [MainThread]: 
[0m02:53:43.280360 [error] [MainThread]: [33mDatabase Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)[0m
[0m02:53:43.281884 [error] [MainThread]:   function round(double precision, integer) does not exist
[0m02:53:43.283873 [error] [MainThread]:   LINE 47:         round(gdp,3) as gdb,
[0m02:53:43.286446 [error] [MainThread]:                    ^
[0m02:53:43.287938 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m02:53:43.289644 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:53:43.291236 [info ] [MainThread]: 
[0m02:53:43.292657 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m02:53:43.294228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6281f8c890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6281f8e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6281e03a10>]}
[0m02:53:43.295589 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:53:52.313052 | 03f704c0-8506-4794-8309-277811712170 ==============================
[0m02:53:52.313052 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:53:52.315585 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:53:52.316542 [debug] [MainThread]: Tracking: tracking
[0m02:53:52.319584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff370e89510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff370985e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37090d150>]}
[0m02:53:52.348737 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:53:52.489066 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:53:52.490334 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m02:53:52.509233 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m02:53:52.540602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03f704c0-8506-4794-8309-277811712170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff36f167e90>]}
[0m02:53:52.559371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03f704c0-8506-4794-8309-277811712170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff36f254390>]}
[0m02:53:52.560284 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:53:52.561464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03f704c0-8506-4794-8309-277811712170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3711a8f90>]}
[0m02:53:52.563820 [info ] [MainThread]: 
[0m02:53:52.568578 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:53:52.571464 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:53:52.587000 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:53:52.587941 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:53:52.588773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:53:52.604661 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:53:52.607510 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:53:52.610690 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:53:52.621617 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:53:52.622560 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:53:52.623488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:53:52.633819 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:53:52.634759 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:53:52.635567 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:53:52.643888 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:53:52.645893 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:53:52.647019 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:53:52.656217 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:52.656960 [debug] [MainThread]: On master: BEGIN
[0m02:53:52.657645 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:53:52.667906 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:53:52.668742 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:52.669463 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:53:52.687824 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:53:52.690099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03f704c0-8506-4794-8309-277811712170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff36f1c8b50>]}
[0m02:53:52.690941 [debug] [MainThread]: On master: ROLLBACK
[0m02:53:52.691869 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:52.692511 [debug] [MainThread]: On master: BEGIN
[0m02:53:52.693888 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:53:52.694999 [debug] [MainThread]: On master: COMMIT
[0m02:53:52.695711 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:52.696504 [debug] [MainThread]: On master: COMMIT
[0m02:53:52.697466 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:53:52.698272 [debug] [MainThread]: On master: Close
[0m02:53:52.699612 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:53:52.701225 [info ] [MainThread]: 
[0m02:53:52.727923 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:53:52.728708 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:53:52.729915 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:53:52.731793 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:53:52.733807 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:53:52.735619 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:53:52.736701 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:53:52.737978 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:53:52.742788 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:53:52.768373 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m02:53:52.769768 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:53:52.738993 => 2023-07-30 02:53:52.769669
[0m02:53:52.770958 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:53:52.771699 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:53:52.743720 => 2023-07-30 02:53:52.771613
[0m02:53:52.788969 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m02:53:52.858278 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m02:53:52.860679 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:53:52.864861 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:52.865586 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:53:52.866387 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m02:53:52.867620 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:53:52.868602 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:53:52.869727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:53:52.887200 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:53:52.888095 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:52.888901 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

flattened_columns as (

    select
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
),

generate_surrogate_key as (

    select
        *,
        
    
md5(cast(coalesce(cast(worldbank_api_indicator_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_indicator_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_countryiso3code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_obs_status as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_decimal as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as generated_id
    from flattened_columns

)

select *
from generate_surrogate_key
  );
  
[0m02:53:52.893326 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:53:52.894160 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:53:52.894966 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_value as gdp,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_date,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        previous_year_gdb_date,
        previous_year_gdb,
        1.0 * gdp / nullif(previous_year_gdb, 0) - 1 as gdp_growth,
        min(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) as min_gdp_growth_since_2000,
        max(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6
),

final as (

    select 
        country,
        year,
        round(gdp,3) as gdb,
        round(min_gdp_growth_since_2000) as min_gdp_growth_since_2000,
        round(max_gdp_growth_since_2000) as max_gdp_growth_since_2000
    from calculated_gdb_metrics
)

select *
from final

where gdp is not null
  );
  
[0m02:53:52.908233 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 47:         round(gdp,3) as gdb,
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m02:53:52.909668 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: ROLLBACK
[0m02:53:52.911483 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:53:52.771988 => 2023-07-30 02:53:52.911348
[0m02:53:52.912747 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:53:52.919516 [debug] [Thread-1 (]: Database Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)
  function round(double precision, integer) does not exist
  LINE 47:         round(gdp,3) as gdb,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:53:52.920567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03f704c0-8506-4794-8309-277811712170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff36f1c8a10>]}
[0m02:53:52.921857 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model public.worldbank_api_metrics ............. [[31mERROR[0m in 0.19s]
[0m02:53:52.925862 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:53:53.232183 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:53:53.239280 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:53.240103 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m02:53:53.241757 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:53:53.245367 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:53.246091 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m02:53:53.247396 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:53:53.270083 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:53:53.270793 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:53.271352 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:53:53.277392 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m02:53:53.284379 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:53:53.285236 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m02:53:53.291191 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m02:53:53.293529 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 02:53:52.800920 => 2023-07-30 02:53:53.293457
[0m02:53:53.294316 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m02:53:53.295674 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03f704c0-8506-4794-8309-277811712170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff36f1ca050>]}
[0m02:53:53.296741 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.56s]
[0m02:53:53.298047 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:53:53.302544 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:53:53.303510 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:53.304275 [debug] [MainThread]: On master: BEGIN
[0m02:53:53.305062 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:53:53.322076 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:53:53.323281 [debug] [MainThread]: On master: COMMIT
[0m02:53:53.323887 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:53.324517 [debug] [MainThread]: On master: COMMIT
[0m02:53:53.325479 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:53:53.326237 [debug] [MainThread]: On master: Close
[0m02:53:53.327478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:53:53.328217 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:53:53.328750 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:53:53.329416 [info ] [MainThread]: 
[0m02:53:53.330585 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m02:53:53.332275 [debug] [MainThread]: Command end result
[0m02:53:53.360512 [info ] [MainThread]: 
[0m02:53:53.362566 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:53:53.364019 [info ] [MainThread]: 
[0m02:53:53.366072 [error] [MainThread]: [33mDatabase Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)[0m
[0m02:53:53.367569 [error] [MainThread]:   function round(double precision, integer) does not exist
[0m02:53:53.369655 [error] [MainThread]:   LINE 47:         round(gdp,3) as gdb,
[0m02:53:53.371617 [error] [MainThread]:                    ^
[0m02:53:53.373306 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m02:53:53.374554 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:53:53.376209 [info ] [MainThread]: 
[0m02:53:53.377525 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m02:53:53.379653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff370990dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff370c5d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff370d88cd0>]}
[0m02:53:53.381010 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:55:13.999727 | 8b21161b-599d-4596-837f-19846a245efe ==============================
[0m02:55:13.999727 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:55:14.002375 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:55:14.003473 [debug] [MainThread]: Tracking: tracking
[0m02:55:14.005845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effde58c450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effde661750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effde58c250>]}
[0m02:55:14.030400 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:55:14.133622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:55:14.134252 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:55:14.141430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b21161b-599d-4596-837f-19846a245efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effdc789d90>]}
[0m02:55:14.157141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b21161b-599d-4596-837f-19846a245efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effdde13510>]}
[0m02:55:14.158002 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:55:14.159150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b21161b-599d-4596-837f-19846a245efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effde2f4d10>]}
[0m02:55:14.161428 [info ] [MainThread]: 
[0m02:55:14.165910 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:55:14.168860 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:55:14.184843 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:55:14.185595 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:55:14.186233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:55:14.203386 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:55:14.205953 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:55:14.208726 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:55:14.216430 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:55:14.217748 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:55:14.218508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:55:14.227781 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:55:14.229037 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:55:14.229585 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:55:14.236171 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:55:14.238080 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:55:14.238924 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:55:14.246832 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:14.247944 [debug] [MainThread]: On master: BEGIN
[0m02:55:14.248808 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:55:14.258838 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:55:14.259883 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:14.260660 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:55:14.276352 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:55:14.279395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b21161b-599d-4596-837f-19846a245efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effde631450>]}
[0m02:55:14.280963 [debug] [MainThread]: On master: ROLLBACK
[0m02:55:14.282502 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:14.283466 [debug] [MainThread]: On master: BEGIN
[0m02:55:14.284787 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:55:14.285721 [debug] [MainThread]: On master: COMMIT
[0m02:55:14.286455 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:14.287046 [debug] [MainThread]: On master: COMMIT
[0m02:55:14.287959 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:55:14.288665 [debug] [MainThread]: On master: Close
[0m02:55:14.291094 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:55:14.292578 [info ] [MainThread]: 
[0m02:55:14.320366 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:55:14.320892 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:55:14.321887 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:55:14.323685 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:55:14.326267 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:55:14.328740 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:55:14.330264 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:55:14.331767 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:55:14.335396 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:55:14.363061 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m02:55:14.364995 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:55:14.332655 => 2023-07-30 02:55:14.364845
[0m02:55:14.365767 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:55:14.336217 => 2023-07-30 02:55:14.365707
[0m02:55:14.366038 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:55:14.366760 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m02:55:14.434059 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:55:14.435261 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m02:55:14.438848 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:55:14.439322 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:55:14.439731 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:55:14.440340 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m02:55:14.441032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:55:14.441584 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:55:14.451894 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:55:14.452788 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:55:14.453269 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:55:14.454409 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:55:14.455155 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_value as gdp,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_date,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        previous_year_gdb_date,
        previous_year_gdb,
        1.0 * gdp / nullif(previous_year_gdb, 0) - 1 as gdp_growth,
        min(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) as min_gdp_growth_since_2000,
        max(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6
),

final as (

    select 
        country,
        year,
        round(gdp,3) as gdb,
        round(min_gdp_growth_since_2000) as min_gdp_growth_since_2000,
        round(max_gdp_growth_since_2000) as max_gdp_growth_since_2000
    from calculated_gdb_metrics
)

select *
from final

where gdp is not null
  );
  
[0m02:55:14.455716 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

flattened_columns as (

    select
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
),

generate_surrogate_key as (

    select
        *,
        
    
md5(cast(coalesce(cast(worldbank_api_indicator_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_indicator_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_countryiso3code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_obs_status as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_decimal as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as generated_id
    from flattened_columns

)

select *
from generate_surrogate_key
  );
  
[0m02:55:14.462160 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 47:         round(gdp,3) as gdb,
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m02:55:14.462956 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: ROLLBACK
[0m02:55:14.464014 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:55:14.367319 => 2023-07-30 02:55:14.463937
[0m02:55:14.464720 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:55:14.468998 [debug] [Thread-1 (]: Database Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)
  function round(double precision, integer) does not exist
  LINE 47:         round(gdp,3) as gdb,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:55:14.469725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b21161b-599d-4596-837f-19846a245efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effdde12f10>]}
[0m02:55:14.470363 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model public.worldbank_api_metrics ............. [[31mERROR[0m in 0.14s]
[0m02:55:14.472710 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:55:14.771683 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:55:14.779117 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:55:14.779972 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m02:55:14.781500 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:55:14.785147 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:55:14.785929 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m02:55:14.787273 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:55:14.810752 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:55:14.811886 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:55:14.812603 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:55:14.817163 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m02:55:14.823589 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:55:14.824390 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m02:55:14.830020 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m02:55:14.832356 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 02:55:14.383948 => 2023-07-30 02:55:14.832295
[0m02:55:14.833173 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m02:55:14.834409 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b21161b-599d-4596-837f-19846a245efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effdc788b10>]}
[0m02:55:14.835709 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.51s]
[0m02:55:14.836939 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:55:14.840106 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:55:14.840729 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:14.841173 [debug] [MainThread]: On master: BEGIN
[0m02:55:14.841658 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:55:14.851496 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:55:14.852483 [debug] [MainThread]: On master: COMMIT
[0m02:55:14.853053 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:14.853473 [debug] [MainThread]: On master: COMMIT
[0m02:55:14.854174 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:55:14.854822 [debug] [MainThread]: On master: Close
[0m02:55:14.855836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:55:14.856457 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:55:14.856940 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:55:14.857552 [info ] [MainThread]: 
[0m02:55:14.858678 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m02:55:14.860111 [debug] [MainThread]: Command end result
[0m02:55:14.879899 [info ] [MainThread]: 
[0m02:55:14.881421 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:55:14.883031 [info ] [MainThread]: 
[0m02:55:14.884540 [error] [MainThread]: [33mDatabase Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)[0m
[0m02:55:14.886104 [error] [MainThread]:   function round(double precision, integer) does not exist
[0m02:55:14.887625 [error] [MainThread]:   LINE 47:         round(gdp,3) as gdb,
[0m02:55:14.888759 [error] [MainThread]:                    ^
[0m02:55:14.889975 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m02:55:14.890828 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:55:14.891880 [info ] [MainThread]: 
[0m02:55:14.893497 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m02:55:14.895117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effde630590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effde631150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effde184290>]}
[0m02:55:14.896395 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:55:26.641075 | 561f29e3-3059-41e6-bfac-5e0574b65894 ==============================
[0m02:55:26.641075 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:55:26.643763 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:55:26.644669 [debug] [MainThread]: Tracking: tracking
[0m02:55:26.646956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eea97fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eea56ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eea828650>]}
[0m02:55:26.668634 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:55:26.765646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:55:26.766564 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m02:55:26.784714 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m02:55:26.814598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '561f29e3-3059-41e6-bfac-5e0574b65894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eea12f3d0>]}
[0m02:55:26.828391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '561f29e3-3059-41e6-bfac-5e0574b65894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ee899c6d0>]}
[0m02:55:26.829179 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:55:26.830484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '561f29e3-3059-41e6-bfac-5e0574b65894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eea62ed90>]}
[0m02:55:26.832461 [info ] [MainThread]: 
[0m02:55:26.835462 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:55:26.837939 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:55:26.850664 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:55:26.851440 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:55:26.852190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:55:26.877000 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:55:26.878944 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:55:26.882098 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:55:26.890059 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:55:26.890878 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:55:26.891484 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:55:26.900684 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:55:26.901695 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:55:26.902504 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:55:26.910542 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:55:26.913110 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:55:26.914413 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:55:26.922928 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:26.923840 [debug] [MainThread]: On master: BEGIN
[0m02:55:26.924702 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:55:26.936075 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:55:26.937273 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:26.938161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:55:26.955666 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:55:26.957829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '561f29e3-3059-41e6-bfac-5e0574b65894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ee8974ad0>]}
[0m02:55:26.958879 [debug] [MainThread]: On master: ROLLBACK
[0m02:55:26.960194 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:26.961019 [debug] [MainThread]: On master: BEGIN
[0m02:55:26.962586 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:55:26.963939 [debug] [MainThread]: On master: COMMIT
[0m02:55:26.965056 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:26.965842 [debug] [MainThread]: On master: COMMIT
[0m02:55:26.966826 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:55:26.967922 [debug] [MainThread]: On master: Close
[0m02:55:26.969475 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:55:26.970816 [info ] [MainThread]: 
[0m02:55:26.993524 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:55:26.994007 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:55:26.994867 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:55:26.996407 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:55:26.998266 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:55:26.999641 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:55:27.000570 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:55:27.001362 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:55:27.004825 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:55:27.029257 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m02:55:27.031862 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:55:27.002171 => 2023-07-30 02:55:27.031670
[0m02:55:27.032842 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:55:27.033420 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:55:27.005690 => 2023-07-30 02:55:27.033357
[0m02:55:27.055387 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m02:55:27.092495 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:55:27.095362 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m02:55:27.099795 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:55:27.100099 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:55:27.100762 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m02:55:27.101620 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:55:27.102502 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:55:27.103172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:55:27.115041 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:55:27.115786 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:55:27.116520 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:55:27.117883 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:55:27.119350 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

flattened_columns as (

    select
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
),

generate_surrogate_key as (

    select
        *,
        
    
md5(cast(coalesce(cast(worldbank_api_indicator_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_indicator_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_countryiso3code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_obs_status as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_decimal as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as generated_id
    from flattened_columns

)

select *
from generate_surrogate_key
  );
  
[0m02:55:27.120332 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_value as gdp,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_date,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        previous_year_gdb_date,
        previous_year_gdb,
        1.0 * gdp / nullif(previous_year_gdb, 0) - 1 as gdp_growth,
        min(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) as min_gdp_growth_since_2000,
        max(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6
)

select *
from calculated_gdb_metrics

where gdp is not null
  );
  
[0m02:55:27.223518 [debug] [Thread-1 (]: SQL status: SELECT 13365 in 0 seconds
[0m02:55:27.233558 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:55:27.234633 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics" rename to "worldbank_api_metrics__dbt_backup"
[0m02:55:27.236656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:55:27.240722 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:55:27.241768 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" rename to "worldbank_api_metrics"
[0m02:55:27.243358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:55:27.269826 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m02:55:27.270765 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:55:27.271765 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m02:55:27.273904 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:55:27.281626 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:55:27.282594 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_metrics__dbt_backup" cascade
[0m02:55:27.289391 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:55:27.292144 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:55:27.033625 => 2023-07-30 02:55:27.292001
[0m02:55:27.293142 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:55:27.294914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '561f29e3-3059-41e6-bfac-5e0574b65894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ee88c0bd0>]}
[0m02:55:27.296601 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.worldbank_api_metrics ................. [[32mSELECT 13365[0m in 0.30s]
[0m02:55:27.300693 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:55:27.492921 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:55:27.497705 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:55:27.498609 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m02:55:27.500340 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:55:27.503837 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:55:27.504642 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m02:55:27.506014 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:55:27.508650 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:55:27.509430 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:55:27.510027 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:55:27.597687 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m02:55:27.601448 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:55:27.602417 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m02:55:27.608540 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m02:55:27.610669 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 02:55:27.072029 => 2023-07-30 02:55:27.610602
[0m02:55:27.611853 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m02:55:27.613325 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '561f29e3-3059-41e6-bfac-5e0574b65894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eea1272d0>]}
[0m02:55:27.614553 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.61s]
[0m02:55:27.615882 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:55:27.619327 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:55:27.620217 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:27.620966 [debug] [MainThread]: On master: BEGIN
[0m02:55:27.621714 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:55:27.646849 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:55:27.648035 [debug] [MainThread]: On master: COMMIT
[0m02:55:27.648696 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:27.649452 [debug] [MainThread]: On master: COMMIT
[0m02:55:27.650503 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:55:27.651225 [debug] [MainThread]: On master: Close
[0m02:55:27.652448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:55:27.653241 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:55:27.655144 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:55:27.655972 [info ] [MainThread]: 
[0m02:55:27.657093 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m02:55:27.658871 [debug] [MainThread]: Command end result
[0m02:55:27.687294 [info ] [MainThread]: 
[0m02:55:27.689137 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:55:27.690444 [info ] [MainThread]: 
[0m02:55:27.691545 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:55:27.692769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eea62eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eea97fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ee89c1190>]}
[0m02:55:27.693706 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 02:58:04.664936 | 46feba93-a35a-4ace-a44a-ce8566565a8e ==============================
[0m02:58:04.664936 [info ] [MainThread]: Running with dbt=1.4.5
[0m02:58:04.667668 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:58:04.668959 [debug] [MainThread]: Tracking: tracking
[0m02:58:04.672487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1592f0ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1592f0b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1592610e50>]}
[0m02:58:04.695134 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m02:58:04.788021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:58:04.788987 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m02:58:04.804632 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m02:58:04.835337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46feba93-a35a-4ace-a44a-ce8566565a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1592f093d0>]}
[0m02:58:04.854737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46feba93-a35a-4ace-a44a-ce8566565a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1590dbd110>]}
[0m02:58:04.856178 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:58:04.858731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46feba93-a35a-4ace-a44a-ce8566565a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1592f0a110>]}
[0m02:58:04.862879 [info ] [MainThread]: 
[0m02:58:04.867684 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:58:04.870589 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m02:58:04.886971 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m02:58:04.888052 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m02:58:04.889161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:58:04.903421 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m02:58:04.905455 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m02:58:04.908867 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m02:58:04.921615 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:58:04.923187 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m02:58:04.924174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:58:04.935406 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:58:04.936701 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m02:58:04.938390 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:58:04.946386 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:58:04.948856 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m02:58:04.950156 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m02:58:04.957845 [debug] [MainThread]: Using postgres connection "master"
[0m02:58:04.958707 [debug] [MainThread]: On master: BEGIN
[0m02:58:04.959441 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:58:04.971058 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:58:04.972340 [debug] [MainThread]: Using postgres connection "master"
[0m02:58:04.973872 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:58:04.995866 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m02:58:04.999037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46feba93-a35a-4ace-a44a-ce8566565a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1590f38ad0>]}
[0m02:58:05.000494 [debug] [MainThread]: On master: ROLLBACK
[0m02:58:05.001669 [debug] [MainThread]: Using postgres connection "master"
[0m02:58:05.002327 [debug] [MainThread]: On master: BEGIN
[0m02:58:05.003471 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:58:05.004292 [debug] [MainThread]: On master: COMMIT
[0m02:58:05.004954 [debug] [MainThread]: Using postgres connection "master"
[0m02:58:05.005575 [debug] [MainThread]: On master: COMMIT
[0m02:58:05.006579 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:58:05.007548 [debug] [MainThread]: On master: Close
[0m02:58:05.008994 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:58:05.010330 [info ] [MainThread]: 
[0m02:58:05.042416 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m02:58:05.043011 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m02:58:05.044354 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m02:58:05.052254 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m02:58:05.055057 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m02:58:05.058729 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m02:58:05.060707 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m02:58:05.065020 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m02:58:05.070330 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:58:05.095186 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m02:58:05.096469 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 02:58:05.066124 => 2023-07-30 02:58:05.096390
[0m02:58:05.097154 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m02:58:05.097637 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 02:58:05.071497 => 2023-07-30 02:58:05.097569
[0m02:58:05.120104 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m02:58:05.158299 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m02:58:05.160480 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m02:58:05.164537 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:58:05.165022 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:58:05.165549 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m02:58:05.166222 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m02:58:05.166905 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:58:05.167441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:58:05.179190 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:58:05.179822 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m02:58:05.180244 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m02:58:05.181136 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:58:05.181915 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_value as gdp,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_date,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        previous_year_gdb_date,
        previous_year_gdb,
        1.0 * gdp / nullif(previous_year_gdb, 0) - 1 as gdp_growth,
        min(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) as min_gdp_growth_since_2000,
        max(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6
),

final as (

    select 
        country,
        year,
        gdp,
        round(gdp_growth,3) as gdp_growth,
        round(min_gdp_growth_since_2000,3) as min_gdp_growth_since_2000,
        round(max_gdp_growth_since_2000,3) as max_gdp_growth_since_2000
    from calculated_gdb_metrics
)

select *
from final

where gdp is not null
  );
  
[0m02:58:05.182730 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

flattened_columns as (

    select
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
),

generate_surrogate_key as (

    select
        *,
        
    
md5(cast(coalesce(cast(worldbank_api_indicator_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_indicator_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_countryiso3code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_obs_status as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_decimal as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as generated_id
    from flattened_columns

)

select *
from generate_surrogate_key
  );
  
[0m02:58:05.189547 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 48:         round(gdp_growth,3) as gdp_growth,
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m02:58:05.190511 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: ROLLBACK
[0m02:58:05.193042 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 02:58:05.097909 => 2023-07-30 02:58:05.192950
[0m02:58:05.194060 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m02:58:05.201257 [debug] [Thread-1 (]: Database Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)
  function round(double precision, integer) does not exist
  LINE 48:         round(gdp_growth,3) as gdp_growth,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:58:05.202182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46feba93-a35a-4ace-a44a-ce8566565a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1590e8d910>]}
[0m02:58:05.203291 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model public.worldbank_api_metrics ............. [[31mERROR[0m in 0.15s]
[0m02:58:05.206136 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m02:58:05.506250 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m02:58:05.514373 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:58:05.515568 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m02:58:05.517138 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:58:05.520629 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:58:05.521667 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m02:58:05.523089 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:58:05.545770 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:58:05.547707 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:58:05.548832 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m02:58:05.552070 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m02:58:05.557790 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m02:58:05.558601 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m02:58:05.564136 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m02:58:05.566253 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 02:58:05.132979 => 2023-07-30 02:58:05.566189
[0m02:58:05.567024 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m02:58:05.568248 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46feba93-a35a-4ace-a44a-ce8566565a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1590e1fed0>]}
[0m02:58:05.569156 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.51s]
[0m02:58:05.570583 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m02:58:05.574180 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:58:05.574651 [debug] [MainThread]: Using postgres connection "master"
[0m02:58:05.575067 [debug] [MainThread]: On master: BEGIN
[0m02:58:05.575425 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:58:05.584284 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:58:05.585132 [debug] [MainThread]: On master: COMMIT
[0m02:58:05.585691 [debug] [MainThread]: Using postgres connection "master"
[0m02:58:05.586234 [debug] [MainThread]: On master: COMMIT
[0m02:58:05.586963 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:58:05.587488 [debug] [MainThread]: On master: Close
[0m02:58:05.588455 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:58:05.588955 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m02:58:05.589441 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m02:58:05.589958 [info ] [MainThread]: 
[0m02:58:05.590872 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m02:58:05.591794 [debug] [MainThread]: Command end result
[0m02:58:05.603529 [info ] [MainThread]: 
[0m02:58:05.605035 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:58:05.606612 [info ] [MainThread]: 
[0m02:58:05.608022 [error] [MainThread]: [33mDatabase Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)[0m
[0m02:58:05.609051 [error] [MainThread]:   function round(double precision, integer) does not exist
[0m02:58:05.609968 [error] [MainThread]:   LINE 48:         round(gdp_growth,3) as gdp_growth,
[0m02:58:05.611187 [error] [MainThread]:                    ^
[0m02:58:05.612710 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m02:58:05.614148 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m02:58:05.615455 [info ] [MainThread]: 
[0m02:58:05.616590 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m02:58:05.618179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1590dce950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1590dcea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1590ecaa90>]}
[0m02:58:05.619734 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 03:00:23.701322 | b65a7897-9895-406a-bc25-508488cd244b ==============================
[0m03:00:23.701322 [info ] [MainThread]: Running with dbt=1.4.5
[0m03:00:23.704048 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:00:23.705406 [debug] [MainThread]: Tracking: tracking
[0m03:00:23.708904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa05d3d09d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa05d4075d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa05d360310>]}
[0m03:00:23.732062 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m03:00:23.835052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:00:23.836054 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m03:00:23.852855 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m03:00:23.881233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b65a7897-9895-406a-bc25-508488cd244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa05b6b3910>]}
[0m03:00:23.896162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b65a7897-9895-406a-bc25-508488cd244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa05b591cd0>]}
[0m03:00:23.896910 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m03:00:23.898002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b65a7897-9895-406a-bc25-508488cd244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa05d5a83d0>]}
[0m03:00:23.899830 [info ] [MainThread]: 
[0m03:00:23.902703 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:00:23.905473 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m03:00:23.917764 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m03:00:23.918887 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m03:00:23.919707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:23.932067 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m03:00:23.934559 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m03:00:23.937660 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m03:00:23.946041 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m03:00:23.946999 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m03:00:23.947776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:00:23.959474 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m03:00:23.960390 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m03:00:23.961213 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:00:23.968054 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m03:00:23.970079 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m03:00:23.971120 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m03:00:23.978634 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:23.979632 [debug] [MainThread]: On master: BEGIN
[0m03:00:23.980493 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:00:23.993050 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:00:23.994002 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:23.994867 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:00:24.014475 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m03:00:24.016914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b65a7897-9895-406a-bc25-508488cd244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa05cde4ad0>]}
[0m03:00:24.017920 [debug] [MainThread]: On master: ROLLBACK
[0m03:00:24.018818 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:24.019466 [debug] [MainThread]: On master: BEGIN
[0m03:00:24.020447 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:00:24.021253 [debug] [MainThread]: On master: COMMIT
[0m03:00:24.021784 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:24.022271 [debug] [MainThread]: On master: COMMIT
[0m03:00:24.023065 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m03:00:24.023518 [debug] [MainThread]: On master: Close
[0m03:00:24.024456 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:00:24.025461 [info ] [MainThread]: 
[0m03:00:24.047073 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m03:00:24.047579 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m03:00:24.048553 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m03:00:24.050034 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m03:00:24.051688 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m03:00:24.053705 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m03:00:24.054857 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m03:00:24.056109 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m03:00:24.059751 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m03:00:24.083362 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m03:00:24.085328 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 03:00:24.056941 => 2023-07-30 03:00:24.085151
[0m03:00:24.086202 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m03:00:24.086474 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 03:00:24.060523 => 2023-07-30 03:00:24.086414
[0m03:00:24.108604 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m03:00:24.145920 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m03:00:24.147799 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m03:00:24.151802 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:00:24.152301 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m03:00:24.152508 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m03:00:24.153116 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m03:00:24.153720 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:00:24.154302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:24.164909 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:00:24.165246 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m03:00:24.165913 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m03:00:24.166672 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:00:24.167352 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_value as gdp,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_date,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        previous_year_gdb_date,
        previous_year_gdb,
        1.0 * gdp / nullif(previous_year_gdb, 0) - 1 as gdp_growth,
        min(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) as min_gdp_growth_since_2000,
        max(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6
),

final as (

    select 
        country,
        year,
        gdp,
        round(cast(gdp_growth as float),3) as gdp_growth,
        round(cast(min_gdp_growth_since_2000 as float),3) as min_gdp_growth_since_2000,
        round(cast(max_gdp_growth_since_2000 as float),3) as max_gdp_growth_since_2000
    from calculated_gdb_metrics
)

select *
from final

where gdp is not null
  );
  
[0m03:00:24.168104 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

flattened_columns as (

    select
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
),

generate_surrogate_key as (

    select
        *,
        
    
md5(cast(coalesce(cast(worldbank_api_indicator_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_indicator_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_countryiso3code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_obs_status as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_decimal as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as generated_id
    from flattened_columns

)

select *
from generate_surrogate_key
  );
  
[0m03:00:24.174308 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 48:         round(cast(gdp_growth as float),3) as gdp_growth,
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m03:00:24.175355 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: ROLLBACK
[0m03:00:24.176922 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 03:00:24.087135 => 2023-07-30 03:00:24.176781
[0m03:00:24.177871 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m03:00:24.182134 [debug] [Thread-1 (]: Database Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)
  function round(double precision, integer) does not exist
  LINE 48:         round(cast(gdp_growth as float),3) as gdp_growth,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m03:00:24.182990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b65a7897-9895-406a-bc25-508488cd244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa05b60db10>]}
[0m03:00:24.183878 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model public.worldbank_api_metrics ............. [[31mERROR[0m in 0.13s]
[0m03:00:24.186542 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m03:00:24.520589 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m03:00:24.531250 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:00:24.532261 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m03:00:24.534068 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:00:24.537666 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:00:24.538422 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m03:00:24.539751 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:00:24.565537 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m03:00:24.566494 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:00:24.567431 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m03:00:24.570088 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m03:00:24.576490 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:00:24.577359 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m03:00:24.582607 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m03:00:24.584783 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 03:00:24.120430 => 2023-07-30 03:00:24.584719
[0m03:00:24.585638 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m03:00:24.586942 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b65a7897-9895-406a-bc25-508488cd244b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa05b710b90>]}
[0m03:00:24.587884 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.53s]
[0m03:00:24.589004 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m03:00:24.592506 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:00:24.593415 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:24.594126 [debug] [MainThread]: On master: BEGIN
[0m03:00:24.594786 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:00:24.604540 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:00:24.605542 [debug] [MainThread]: On master: COMMIT
[0m03:00:24.606307 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:24.607020 [debug] [MainThread]: On master: COMMIT
[0m03:00:24.607801 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m03:00:24.608404 [debug] [MainThread]: On master: Close
[0m03:00:24.609322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:00:24.609937 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m03:00:24.610565 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m03:00:24.611302 [info ] [MainThread]: 
[0m03:00:24.612454 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m03:00:24.613919 [debug] [MainThread]: Command end result
[0m03:00:24.628500 [info ] [MainThread]: 
[0m03:00:24.629575 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:00:24.630881 [info ] [MainThread]: 
[0m03:00:24.632309 [error] [MainThread]: [33mDatabase Error in model worldbank_api_metrics (models/example/worldbank_api_metrics.sql)[0m
[0m03:00:24.633596 [error] [MainThread]:   function round(double precision, integer) does not exist
[0m03:00:24.635262 [error] [MainThread]:   LINE 48:         round(cast(gdp_growth as float),3) as gdp_growth,
[0m03:00:24.636614 [error] [MainThread]:                    ^
[0m03:00:24.637876 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m03:00:24.639550 [error] [MainThread]:   compiled Code at target/run/my_dbt_project/models/example/worldbank_api_metrics.sql
[0m03:00:24.640986 [info ] [MainThread]: 
[0m03:00:24.642452 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m03:00:24.643707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa05d301250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa05d303010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa05b69dfd0>]}
[0m03:00:24.645014 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 03:01:03.347987 | e58c7f28-67d9-467f-9c3f-e95b7a3bdf5a ==============================
[0m03:01:03.347987 [info ] [MainThread]: Running with dbt=1.4.5
[0m03:01:03.351090 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:01:03.352506 [debug] [MainThread]: Tracking: tracking
[0m03:01:03.357896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fd61b0150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fd61b0c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fd5f5e150>]}
[0m03:01:03.381341 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m03:01:03.486688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:01:03.487797 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m03:01:03.505888 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m03:01:03.534400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e58c7f28-67d9-467f-9c3f-e95b7a3bdf5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fd415ddd0>]}
[0m03:01:03.551871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e58c7f28-67d9-467f-9c3f-e95b7a3bdf5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fd41f5010>]}
[0m03:01:03.552898 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m03:01:03.554199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e58c7f28-67d9-467f-9c3f-e95b7a3bdf5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fd61a6ad0>]}
[0m03:01:03.556504 [info ] [MainThread]: 
[0m03:01:03.560815 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:01:03.563244 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m03:01:03.577560 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m03:01:03.578542 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m03:01:03.579325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:01:03.593098 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m03:01:03.595285 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m03:01:03.598046 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m03:01:03.606622 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m03:01:03.607526 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m03:01:03.608395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:01:03.621723 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m03:01:03.622781 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m03:01:03.623576 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:01:03.632729 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m03:01:03.635252 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m03:01:03.636787 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m03:01:03.649753 [debug] [MainThread]: Using postgres connection "master"
[0m03:01:03.650900 [debug] [MainThread]: On master: BEGIN
[0m03:01:03.652148 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:01:03.665083 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:01:03.666325 [debug] [MainThread]: Using postgres connection "master"
[0m03:01:03.667329 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:01:03.684062 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m03:01:03.686466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e58c7f28-67d9-467f-9c3f-e95b7a3bdf5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fd422cad0>]}
[0m03:01:03.687681 [debug] [MainThread]: On master: ROLLBACK
[0m03:01:03.689099 [debug] [MainThread]: Using postgres connection "master"
[0m03:01:03.689917 [debug] [MainThread]: On master: BEGIN
[0m03:01:03.691314 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:01:03.692268 [debug] [MainThread]: On master: COMMIT
[0m03:01:03.693135 [debug] [MainThread]: Using postgres connection "master"
[0m03:01:03.694091 [debug] [MainThread]: On master: COMMIT
[0m03:01:03.695154 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m03:01:03.695953 [debug] [MainThread]: On master: Close
[0m03:01:03.697254 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:01:03.698459 [info ] [MainThread]: 
[0m03:01:03.717250 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m03:01:03.717769 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m03:01:03.718934 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m03:01:03.720411 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m03:01:03.722278 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m03:01:03.723811 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m03:01:03.724808 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m03:01:03.725694 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m03:01:03.729317 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m03:01:03.751368 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m03:01:03.754305 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 03:01:03.730152 => 2023-07-30 03:01:03.754212
[0m03:01:03.754836 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 03:01:03.726459 => 2023-07-30 03:01:03.754764
[0m03:01:03.755171 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m03:01:03.756062 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m03:01:03.825875 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m03:01:03.828628 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m03:01:03.831761 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:01:03.832211 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m03:01:03.832424 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m03:01:03.833071 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m03:01:03.833727 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:01:03.834323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:01:03.844136 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m03:01:03.845139 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:01:03.845480 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:01:03.846452 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

flattened_columns as (

    select
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
),

generate_surrogate_key as (

    select
        *,
        
    
md5(cast(coalesce(cast(worldbank_api_indicator_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_indicator_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_countryiso3code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_obs_status as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_decimal as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as generated_id
    from flattened_columns

)

select *
from generate_surrogate_key
  );
  
[0m03:01:03.847181 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m03:01:03.848592 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_value as gdp,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_date,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        previous_year_gdb_date,
        previous_year_gdb,
        1.0 * gdp / nullif(previous_year_gdb, 0) - 1 as gdp_growth,
        min(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) as min_gdp_growth_since_2000,
        max(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6
),

final as (

    select 
        country,
        year,
        gdp,
        round(cast(gdp_growth as numeric),3) as gdp_growth,
        round(cast(min_gdp_growth_since_2000 as numeric),3) as min_gdp_growth_since_2000,
        round(cast(max_gdp_growth_since_2000 as numeric),3) as max_gdp_growth_since_2000
    from calculated_gdb_metrics
)

select *
from final

where gdp is not null
  );
  
[0m03:01:03.971527 [debug] [Thread-1 (]: SQL status: SELECT 13365 in 0 seconds
[0m03:01:03.979153 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m03:01:03.980066 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics" rename to "worldbank_api_metrics__dbt_backup"
[0m03:01:03.981639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:01:03.985116 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m03:01:03.985922 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" rename to "worldbank_api_metrics"
[0m03:01:03.987296 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:01:04.013024 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m03:01:04.014002 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m03:01:04.014760 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m03:01:04.019502 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m03:01:04.025496 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m03:01:04.026280 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_metrics__dbt_backup" cascade
[0m03:01:04.031411 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m03:01:04.033294 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 03:01:03.773368 => 2023-07-30 03:01:04.033229
[0m03:01:04.034113 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m03:01:04.035315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e58c7f28-67d9-467f-9c3f-e95b7a3bdf5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fd420a690>]}
[0m03:01:04.036271 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.worldbank_api_metrics ................. [[32mSELECT 13365[0m in 0.31s]
[0m03:01:04.038540 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m03:01:04.161778 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m03:01:04.165569 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:01:04.166391 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m03:01:04.167986 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:01:04.171253 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:01:04.172036 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m03:01:04.173543 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:01:04.177456 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m03:01:04.178190 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:01:04.178784 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m03:01:04.181267 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m03:01:04.184321 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:01:04.185086 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m03:01:04.189652 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m03:01:04.191441 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 03:01:03.756826 => 2023-07-30 03:01:04.191381
[0m03:01:04.192040 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m03:01:04.193088 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e58c7f28-67d9-467f-9c3f-e95b7a3bdf5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fd4209310>]}
[0m03:01:04.194025 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.47s]
[0m03:01:04.195199 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m03:01:04.198272 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:01:04.199010 [debug] [MainThread]: Using postgres connection "master"
[0m03:01:04.199663 [debug] [MainThread]: On master: BEGIN
[0m03:01:04.200270 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:01:04.209426 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:01:04.210245 [debug] [MainThread]: On master: COMMIT
[0m03:01:04.210863 [debug] [MainThread]: Using postgres connection "master"
[0m03:01:04.211387 [debug] [MainThread]: On master: COMMIT
[0m03:01:04.212245 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m03:01:04.212998 [debug] [MainThread]: On master: Close
[0m03:01:04.214092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:01:04.214729 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m03:01:04.215323 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m03:01:04.216003 [info ] [MainThread]: 
[0m03:01:04.216885 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m03:01:04.218077 [debug] [MainThread]: Command end result
[0m03:01:04.229745 [info ] [MainThread]: 
[0m03:01:04.230816 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:01:04.232027 [info ] [MainThread]: 
[0m03:01:04.233337 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:01:04.234809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fd5989710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fd4134c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fd417cb50>]}
[0m03:01:04.235691 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 03:04:32.403025 | 6f16f685-4e32-4491-8e2f-26fe4e938d63 ==============================
[0m03:04:32.403025 [info ] [MainThread]: Running with dbt=1.4.5
[0m03:04:32.406003 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:04:32.407163 [debug] [MainThread]: Tracking: tracking
[0m03:04:32.410190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1af7d7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1ae998d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1af7d510>]}
[0m03:04:32.432013 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m03:04:32.522979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:04:32.523919 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_stg.sql
[0m03:04:32.539043 [debug] [MainThread]: 1603: static parser failed on example/worldbank_api_stg.sql
[0m03:04:32.574942 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/worldbank_api_stg.sql
[0m03:04:32.616049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f16f685-4e32-4491-8e2f-26fe4e938d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f197c6f90>]}
[0m03:04:32.633695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f16f685-4e32-4491-8e2f-26fe4e938d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1b3c23d0>]}
[0m03:04:32.634634 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m03:04:32.635676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f16f685-4e32-4491-8e2f-26fe4e938d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1b247090>]}
[0m03:04:32.637758 [info ] [MainThread]: 
[0m03:04:32.641317 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:04:32.643543 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m03:04:32.655204 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m03:04:32.656263 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m03:04:32.656924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:04:32.670590 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m03:04:32.673169 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m03:04:32.676602 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m03:04:32.683451 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m03:04:32.684326 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m03:04:32.685048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:04:32.696472 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m03:04:32.697625 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m03:04:32.698457 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:04:32.705213 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m03:04:32.707182 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m03:04:32.708114 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m03:04:32.715444 [debug] [MainThread]: Using postgres connection "master"
[0m03:04:32.716331 [debug] [MainThread]: On master: BEGIN
[0m03:04:32.717169 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:04:32.727172 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:04:32.728452 [debug] [MainThread]: Using postgres connection "master"
[0m03:04:32.729245 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:04:32.744864 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m03:04:32.747233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f16f685-4e32-4491-8e2f-26fe4e938d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f196c4ad0>]}
[0m03:04:32.748092 [debug] [MainThread]: On master: ROLLBACK
[0m03:04:32.749039 [debug] [MainThread]: Using postgres connection "master"
[0m03:04:32.749619 [debug] [MainThread]: On master: BEGIN
[0m03:04:32.750660 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:04:32.751437 [debug] [MainThread]: On master: COMMIT
[0m03:04:32.752069 [debug] [MainThread]: Using postgres connection "master"
[0m03:04:32.752630 [debug] [MainThread]: On master: COMMIT
[0m03:04:32.753455 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m03:04:32.754024 [debug] [MainThread]: On master: Close
[0m03:04:32.754997 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:04:32.755771 [info ] [MainThread]: 
[0m03:04:32.775307 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m03:04:32.775884 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m03:04:32.776887 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m03:04:32.778406 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m03:04:32.780443 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m03:04:32.781537 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m03:04:32.782194 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m03:04:32.782729 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m03:04:32.786414 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m03:04:32.794986 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m03:04:32.798122 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 03:04:32.787178 => 2023-07-30 03:04:32.798033
[0m03:04:32.798622 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 03:04:32.783304 => 2023-07-30 03:04:32.798564
[0m03:04:32.798915 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m03:04:32.799657 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m03:04:32.871227 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m03:04:32.872559 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m03:04:32.876179 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:04:32.876619 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m03:04:32.876897 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m03:04:32.877571 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m03:04:32.878180 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:04:32.878829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:04:32.889950 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:04:32.890502 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m03:04:32.891144 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m03:04:32.891698 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:04:32.892239 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_value as gdp,
        LAG(worldbank_api_date,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_date,
        LAG(worldbank_api_value,1) OVER (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        previous_year_gdb_date,
        previous_year_gdb,
        1.0 * gdp / nullif(previous_year_gdb, 0) - 1 as gdp_growth,
        min(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) as min_gdp_growth_since_2000,
        max(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6
),

final as (

    select 
        country,
        year,
        gdp,
        round(cast(gdp_growth as numeric),3) as gdp_growth,
        round(cast(min_gdp_growth_since_2000 as numeric),3) as min_gdp_growth_since_2000,
        round(cast(max_gdp_growth_since_2000 as numeric),3) as max_gdp_growth_since_2000
    from calculated_gdb_metrics
)

select *
from final

where gdp is not null
  );
  
[0m03:04:32.892688 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

flattened_columns as (

    select
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
),

final as (

    select
        *,
        
    
md5(cast(coalesce(cast(worldbank_api_indicator_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_indicator_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_countryiso3code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_obs_status as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_decimal as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as generated_id
    from flattened_columns

)

select *
from final
  );
  
[0m03:04:33.016662 [debug] [Thread-1 (]: SQL status: SELECT 13365 in 0 seconds
[0m03:04:33.024820 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m03:04:33.025767 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics" rename to "worldbank_api_metrics__dbt_backup"
[0m03:04:33.027467 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:04:33.031004 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m03:04:33.031795 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" rename to "worldbank_api_metrics"
[0m03:04:33.033214 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:04:33.057098 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m03:04:33.058266 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m03:04:33.059157 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m03:04:33.064990 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m03:04:33.070866 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m03:04:33.071669 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_metrics__dbt_backup" cascade
[0m03:04:33.076762 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m03:04:33.078861 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 03:04:32.817571 => 2023-07-30 03:04:33.078794
[0m03:04:33.079664 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m03:04:33.081181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f16f685-4e32-4491-8e2f-26fe4e938d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1b632050>]}
[0m03:04:33.082217 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.worldbank_api_metrics ................. [[32mSELECT 13365[0m in 0.30s]
[0m03:04:33.085203 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m03:04:33.215434 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m03:04:33.218995 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:04:33.219831 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m03:04:33.221598 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:04:33.227500 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:04:33.228349 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m03:04:33.229739 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:04:33.232310 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m03:04:33.233163 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:04:33.233806 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m03:04:33.235989 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m03:04:33.238718 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:04:33.239252 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m03:04:33.243823 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m03:04:33.245447 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 03:04:32.800223 => 2023-07-30 03:04:33.245389
[0m03:04:33.246068 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m03:04:33.247143 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f16f685-4e32-4491-8e2f-26fe4e938d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f19560e50>]}
[0m03:04:33.247952 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.47s]
[0m03:04:33.248987 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m03:04:33.252317 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:04:33.252822 [debug] [MainThread]: Using postgres connection "master"
[0m03:04:33.253157 [debug] [MainThread]: On master: BEGIN
[0m03:04:33.253553 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:04:33.264311 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:04:33.265232 [debug] [MainThread]: On master: COMMIT
[0m03:04:33.265841 [debug] [MainThread]: Using postgres connection "master"
[0m03:04:33.266360 [debug] [MainThread]: On master: COMMIT
[0m03:04:33.267180 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m03:04:33.267725 [debug] [MainThread]: On master: Close
[0m03:04:33.268691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:04:33.269337 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m03:04:33.269949 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m03:04:33.270546 [info ] [MainThread]: 
[0m03:04:33.271418 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m03:04:33.272528 [debug] [MainThread]: Command end result
[0m03:04:33.284536 [info ] [MainThread]: 
[0m03:04:33.286282 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:04:33.287535 [info ] [MainThread]: 
[0m03:04:33.288747 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:04:33.290116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f195a37d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f195a3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1c006790>]}
[0m03:04:33.291500 [debug] [MainThread]: Flushing usage events


============================== 2023-07-30 03:25:42.366480 | 4ba722fd-9e68-47ad-a67f-3d55d7ef0dbf ==============================
[0m03:25:42.366480 [info ] [MainThread]: Running with dbt=1.4.5
[0m03:25:42.369246 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/app', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:25:42.370385 [debug] [MainThread]: Tracking: tracking
[0m03:25:42.374899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7f7653d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7f4ed290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7ef6de90>]}
[0m03:25:42.398143 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m03:25:42.506917 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:25:42.507805 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/example/worldbank_api_metrics.sql
[0m03:25:42.523949 [debug] [MainThread]: 1699: static parser successfully parsed example/worldbank_api_metrics.sql
[0m03:25:42.554313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ba722fd-9e68-47ad-a67f-3d55d7ef0dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7f767dd0>]}
[0m03:25:42.576462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ba722fd-9e68-47ad-a67f-3d55d7ef0dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7d85cad0>]}
[0m03:25:42.578925 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 403 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m03:25:42.580718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ba722fd-9e68-47ad-a67f-3d55d7ef0dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7efda050>]}
[0m03:25:42.584884 [info ] [MainThread]: 
[0m03:25:42.589357 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:25:42.591887 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db'
[0m03:25:42.609608 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db"
[0m03:25:42.610542 [debug] [ThreadPool]: On list_worldbank_api_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db"} */

    select distinct nspname from pg_namespace
  
[0m03:25:42.611246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:25:42.623820 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m03:25:42.625757 [debug] [ThreadPool]: On list_worldbank_api_db: Close
[0m03:25:42.628370 [debug] [ThreadPool]: Acquiring new postgres connection 'list_worldbank_api_db_public'
[0m03:25:42.635579 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m03:25:42.636680 [debug] [ThreadPool]: On list_worldbank_api_db_public: BEGIN
[0m03:25:42.637997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:25:42.650547 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m03:25:42.651491 [debug] [ThreadPool]: Using postgres connection "list_worldbank_api_db_public"
[0m03:25:42.652158 [debug] [ThreadPool]: On list_worldbank_api_db_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_worldbank_api_db_public"} */
select
      'worldbank_api_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'worldbank_api_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:25:42.658628 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m03:25:42.660594 [debug] [ThreadPool]: On list_worldbank_api_db_public: ROLLBACK
[0m03:25:42.661580 [debug] [ThreadPool]: On list_worldbank_api_db_public: Close
[0m03:25:42.668911 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:42.669602 [debug] [MainThread]: On master: BEGIN
[0m03:25:42.670174 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:25:42.679435 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:25:42.680648 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:42.681474 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:25:42.695651 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m03:25:42.697723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ba722fd-9e68-47ad-a67f-3d55d7ef0dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7ef04c50>]}
[0m03:25:42.698486 [debug] [MainThread]: On master: ROLLBACK
[0m03:25:42.699577 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:42.700235 [debug] [MainThread]: On master: BEGIN
[0m03:25:42.701394 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:25:42.702574 [debug] [MainThread]: On master: COMMIT
[0m03:25:42.703249 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:42.703867 [debug] [MainThread]: On master: COMMIT
[0m03:25:42.704839 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m03:25:42.705584 [debug] [MainThread]: On master: Close
[0m03:25:42.706669 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:25:42.707729 [info ] [MainThread]: 
[0m03:25:42.728935 [debug] [Thread-1 (]: Began running node model.my_dbt_project.worldbank_api_metrics
[0m03:25:42.729477 [debug] [Thread-2 (]: Began running node model.my_dbt_project.worldbank_api_stg
[0m03:25:42.730441 [info ] [Thread-1 (]: 1 of 2 START sql table model public.worldbank_api_metrics ...................... [RUN]
[0m03:25:42.731689 [info ] [Thread-2 (]: 2 of 2 START sql table model public.worldbank_api_stg .......................... [RUN]
[0m03:25:42.733511 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_metrics'
[0m03:25:42.735694 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt_project.worldbank_api_stg'
[0m03:25:42.736893 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.worldbank_api_metrics
[0m03:25:42.738189 [debug] [Thread-2 (]: Began compiling node model.my_dbt_project.worldbank_api_stg
[0m03:25:42.742125 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_metrics"
[0m03:25:42.765954 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt_project.worldbank_api_stg"
[0m03:25:42.769235 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (compile): 2023-07-30 03:25:42.739128 => 2023-07-30 03:25:42.769129
[0m03:25:42.770029 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.worldbank_api_metrics
[0m03:25:42.770353 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (compile): 2023-07-30 03:25:42.743330 => 2023-07-30 03:25:42.770294
[0m03:25:42.798219 [debug] [Thread-2 (]: Began executing node model.my_dbt_project.worldbank_api_stg
[0m03:25:42.824589 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_stg"
[0m03:25:42.827602 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.worldbank_api_metrics"
[0m03:25:42.833849 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m03:25:42.834455 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:25:42.834800 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: BEGIN
[0m03:25:42.835736 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: BEGIN
[0m03:25:42.836426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:25:42.837001 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:25:42.846792 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:25:42.847649 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m03:25:42.848153 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m03:25:42.848852 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp"
  as (
    

with filtered_data as (

    select 
        worldbank_api_country_value as country,
        worldbank_api_date as year,
        worldbank_api_value as gdp,
        lag(worldbank_api_date,1) over (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb_date,
        lag(worldbank_api_value,1) over (
            PARTITION BY worldbank_api_country_value
		    ORDER BY worldbank_api_date ASC) as previous_year_gdb
    from worldbank_api_stg
    --where worldbank_api_date => 2000

),

calculated_gdb_metrics as (

    select
        country,
        year,
        gdp,
        previous_year_gdb_date,
        previous_year_gdb,
        1.0 * gdp / nullif(previous_year_gdb, 0) - 1 as gdp_growth,
        min(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) over () as min_gdp_growth_since_2000,
        max(1.0 * gdp / nullif(previous_year_gdb, 0) - 1) over () as max_gdp_growth_since_2000
    from filtered_data
    GROUP BY 1,2,3,4,5,6
),

final as (

    select 
        country,
        year,
        gdp,
        round(cast(gdp_growth as numeric),3) as gdp_growth,
        round(cast(min_gdp_growth_since_2000 as numeric),3) as min_gdp_growth_since_2000,
        round(cast(max_gdp_growth_since_2000 as numeric),3) as max_gdp_growth_since_2000
    from calculated_gdb_metrics
)

select *
from final

where gdp is not null
  );
  
[0m03:25:42.849450 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:25:42.850744 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */

  
    

  create  table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp"
  as (
    

with 

flattened_columns as (

    select
        worldbank_api_indicator->>'id' as worldbank_api_indicator_id,
        worldbank_api_indicator->>'value' as worldbank_api_indicator_value,
        worldbank_api_country->>'id' as worldbank_api_country_id,
        worldbank_api_country->>'value' as worldbank_api_country_value,
        worldbank_api_countryiso3code,
        worldbank_api_date,
        worldbank_api_value,
        worldbank_api_unit,
        worldbank_api_obs_status,
        worldbank_api_decimal
    from worldbank_api
),

final as (

    select
        *,
        
    
md5(cast(coalesce(cast(worldbank_api_indicator_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_indicator_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_country_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_countryiso3code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_value as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_obs_status as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(worldbank_api_decimal as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as generated_id
    from flattened_columns

)

select *
from final
  );
  
[0m03:25:42.975196 [debug] [Thread-1 (]: SQL status: SELECT 13365 in 0 seconds
[0m03:25:42.982720 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m03:25:42.983670 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics" rename to "worldbank_api_metrics__dbt_backup"
[0m03:25:42.985414 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:25:42.989065 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m03:25:42.989877 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
alter table "worldbank_api_db"."public"."worldbank_api_metrics__dbt_tmp" rename to "worldbank_api_metrics"
[0m03:25:42.991507 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:25:43.014370 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m03:25:43.015794 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m03:25:43.016930 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: COMMIT
[0m03:25:43.024135 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m03:25:43.029830 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.worldbank_api_metrics"
[0m03:25:43.030602 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_metrics"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_metrics__dbt_backup" cascade
[0m03:25:43.035813 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m03:25:43.037970 [debug] [Thread-1 (]: Timing info for model.my_dbt_project.worldbank_api_metrics (execute): 2023-07-30 03:25:42.770859 => 2023-07-30 03:25:43.037902
[0m03:25:43.038645 [debug] [Thread-1 (]: On model.my_dbt_project.worldbank_api_metrics: Close
[0m03:25:43.039823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ba722fd-9e68-47ad-a67f-3d55d7ef0dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7d789e50>]}
[0m03:25:43.040743 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.worldbank_api_metrics ................. [[32mSELECT 13365[0m in 0.31s]
[0m03:25:43.043442 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.worldbank_api_metrics
[0m03:25:43.169015 [debug] [Thread-2 (]: SQL status: SELECT 16758 in 0 seconds
[0m03:25:43.172388 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:25:43.172917 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg" rename to "worldbank_api_stg__dbt_backup"
[0m03:25:43.174397 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:25:43.178658 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:25:43.179363 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
alter table "worldbank_api_db"."public"."worldbank_api_stg__dbt_tmp" rename to "worldbank_api_stg"
[0m03:25:43.180527 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:25:43.182885 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m03:25:43.184163 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:25:43.185225 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: COMMIT
[0m03:25:43.188147 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m03:25:43.192122 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt_project.worldbank_api_stg"
[0m03:25:43.192710 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.worldbank_api_stg"} */
drop table if exists "worldbank_api_db"."public"."worldbank_api_stg__dbt_backup" cascade
[0m03:25:43.197754 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0 seconds
[0m03:25:43.199362 [debug] [Thread-2 (]: Timing info for model.my_dbt_project.worldbank_api_stg (execute): 2023-07-30 03:25:42.809742 => 2023-07-30 03:25:43.199297
[0m03:25:43.199991 [debug] [Thread-2 (]: On model.my_dbt_project.worldbank_api_stg: Close
[0m03:25:43.200909 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ba722fd-9e68-47ad-a67f-3d55d7ef0dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7d780dd0>]}
[0m03:25:43.201525 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.worldbank_api_stg ..................... [[32mSELECT 16758[0m in 0.47s]
[0m03:25:43.202517 [debug] [Thread-2 (]: Finished running node model.my_dbt_project.worldbank_api_stg
[0m03:25:43.205619 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:25:43.206250 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:43.206744 [debug] [MainThread]: On master: BEGIN
[0m03:25:43.207322 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:25:43.216138 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:25:43.217094 [debug] [MainThread]: On master: COMMIT
[0m03:25:43.217636 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:43.218171 [debug] [MainThread]: On master: COMMIT
[0m03:25:43.218867 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m03:25:43.219396 [debug] [MainThread]: On master: Close
[0m03:25:43.220325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:25:43.220782 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_metrics' was properly closed.
[0m03:25:43.221329 [debug] [MainThread]: Connection 'model.my_dbt_project.worldbank_api_stg' was properly closed.
[0m03:25:43.221867 [info ] [MainThread]: 
[0m03:25:43.222940 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m03:25:43.223898 [debug] [MainThread]: Command end result
[0m03:25:43.235487 [info ] [MainThread]: 
[0m03:25:43.236613 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:25:43.237931 [info ] [MainThread]: 
[0m03:25:43.239516 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:25:43.240974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7f814790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7d71c990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7d71cb90>]}
[0m03:25:43.241845 [debug] [MainThread]: Flushing usage events
